(window.webpackJsonp=window.webpackJsonp||[]).push([[235],{SwWz:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return j}));var n,c=t("wx14"),s=t("Ff2n"),i=t("q1tI"),b=t.n(i),o=t("7ljp"),r=t("j1un"),p=(b.a.createElement,n="Placement",function(e){return console.warn("Component "+n+" was not imported, exported, or provided by MDXProvider as global scope"),Object(o.b)("div",e)}),l={},m=Object(r.a)({layout:"docs",page_title:"group Stanza - Job Specification",sidebar_title:"group",description:'The "group" stanza defines a series of tasks that should be co-located on the\nsame Nomad client. Any task within a group will be placed on the same client.',__resourcePath:"docs/job-specification/group.mdx",__scans:{}});function j(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.b)(m,Object(c.a)({},l,t,{components:a,mdxType:"MDXLayout"}),Object(o.b)("h1",{className:"g-type-display-2"},Object(o.b)("a",Object(c.a)({parentName:"h1"},{className:"__permalink-h",href:"#group-stanza","aria-label":"group stanza permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h1"},{className:"__target-h",id:"group-stanza","aria-hidden":""})),Object(o.b)("inlineCode",{parentName:"h1"},"group")," Stanza"),Object(o.b)(p,{groups:["job","group"],mdxType:"Placement"}),Object(o.b)("p",null,"The ",Object(o.b)("inlineCode",{parentName:"p"},"group")," stanza defines a series of tasks that should be co-located on the\nsame Nomad client. Any ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/task",title:"Nomad task Job Specification"}),"task")," within a group will be placed on the same\nclient."),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),"job ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"docs"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  group ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"example"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token comment"}),"# ..."),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("h2",{className:"g-type-display-3"},Object(o.b)("a",Object(c.a)({parentName:"h2"},{className:"__permalink-h",href:"#group-parameters","aria-label":"group parameters permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h2"},{className:"__target-h",id:"group-parameters","aria-hidden":""})),Object(o.b)("inlineCode",{parentName:"h2"},"group")," Parameters"),Object(o.b)("ul",null,Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"constraint",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#constraint","aria-label":"constraint permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"constraint"))," ",Object(o.b)("code",null,"(",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/constraint",title:"Nomad constraint Job Specification"}),"Constraint"),": nil)")," -\nThis can be provided multiple times to define additional constraints.")),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"affinity",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#affinity","aria-label":"affinity permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"affinity"))," ",Object(o.b)("code",null,"(",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/affinity",title:"Nomad affinity Job Specification"}),"Affinity"),": nil)")," - This can be provided\nmultiple times to define preferred placement criteria.")),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"spread",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#spread","aria-label":"spread permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"spread"))," ",Object(o.b)("code",null,"(",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/spread",title:"Nomad spread Job Specification"}),"Spread"),": nil)")," - This can be provided\nmultiple times to define criteria for spreading allocations across a\nnode attribute or metadata. See the\n",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/spread"}),"Nomad spread reference")," for more details.")),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"count",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#count","aria-label":"count permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"count"))," ",Object(o.b)("inlineCode",{parentName:"p"},"(int)")," - Specifies the number of instances that should be running\nunder for this group. This value must be non-negative. This defaults to the\n",Object(o.b)("inlineCode",{parentName:"p"},"min")," value specified in the ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/scaling"}),Object(o.b)("inlineCode",{parentName:"a"},"scaling")),"\nblock, if present; otherwise, this defaults to ",Object(o.b)("inlineCode",{parentName:"p"},"1"),".")),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"ephemeral_disk",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#ephemeral_disk","aria-label":"ephemeral_disk permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"ephemeral_disk"))," ",Object(o.b)("code",null,"(",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/ephemeral_disk",title:"Nomad ephemeral_disk Job Specification"}),"EphemeralDisk"),": nil)")," - Specifies the\nephemeral disk requirements of the group. Ephemeral disks can be marked as\nsticky and support live data migrations.")),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"meta",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#meta","aria-label":"meta permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"meta"))," ",Object(o.b)("code",null,"(",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/meta",title:"Nomad meta Job Specification"}),"Meta"),": nil)")," - Specifies a key-value map that annotates\nwith user-defined metadata.")),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"migrate",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#migrate","aria-label":"migrate permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"migrate"))," ",Object(o.b)("code",null,"(",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/migrate",title:"Nomad migrate Job Specification"}),"Migrate"),": nil)")," - Specifies the group strategy for\nmigrating off of draining nodes. Only service jobs with a count greater than\n1 support migrate stanzas.")),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"network",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#network","aria-label":"network permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"network"))," ",Object(o.b)("code",null,"(",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/network",title:"Nomad network Job Specification"}),"Network"),": ","<","optional",">",")")," - Specifies the network\nrequirements and configuration, including static and dynamic port allocations,\nfor the group.")),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"reschedule",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#reschedule","aria-label":"reschedule permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"reschedule"))," ",Object(o.b)("code",null,"(",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/reschedule",title:"Nomad reschedule Job Specification"}),"Reschedule"),": nil)"),' - Allows to specify a\nrescheduling strategy. Nomad will then attempt to schedule the task on another\nnode if any of the group allocation statuses become "failed".')),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"restart",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#restart","aria-label":"restart permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"restart"))," ",Object(o.b)("code",null,"(",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/restart",title:"Nomad restart Job Specification"}),"Restart"),": nil)")," - Specifies the restart policy for\nall tasks in this group. If omitted, a default policy exists for each job\ntype, which can be found in the ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/restart",title:"Nomad restart Job Specification"}),"restart stanza documentation"),".")),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"service",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#service","aria-label":"service permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"service"))," ",Object(o.b)("code",null,"(",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/service",title:"Nomad service Job Specification"}),"Service"),": nil)")," - Specifies integrations with\n","[Consul][]"," for service discovery. Nomad automatically registers each service when an allocation\nis started and de-registers them when the allocation is destroyed.")),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"shutdown_delay",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#shutdown_delay","aria-label":"shutdown_delay permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"shutdown_delay"))," ",Object(o.b)("inlineCode",{parentName:"p"},'(string: "0s")')," - Specifies the duration to wait when\nstopping a group's tasks. The delay occurs between Consul deregistration\nand sending each task a shutdown signal. Ideally, services would fail\nhealthchecks once they receive a shutdown signal. Alternatively\n",Object(o.b)("inlineCode",{parentName:"p"},"shutdown_delay")," may be set to give in flight requests time to complete\nbefore shutting down. A group level ",Object(o.b)("inlineCode",{parentName:"p"},"shutdown_delay")," will run regardless\nif there are any defined group services. In addition, tasks may have their\nown ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/task#shutdown_delay"}),Object(o.b)("inlineCode",{parentName:"a"},"shutdown_delay")),"\nwhich waits between deregistering task services and stopping the task.")),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"stop_after_client_disconnect",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#stop_after_client_disconnect","aria-label":"stop_after_client_disconnect permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"stop_after_client_disconnect"))," ",Object(o.b)("inlineCode",{parentName:"p"},'(string: "")')," - Specifies a duration\nafter which a Nomad client that cannot communicate with the servers\nwill stop allocations based on this task group. By default, a client\nwill not stop an allocation until explicitly told to by a server. A\nclient that fails to heartbeat to a server within the\n",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/configuration/server#heartbeat_grace"}),Object(o.b)("inlineCode",{parentName:"a"},"heartbeat_grace")),' window and any allocations running on it will be\nmarked "lost" and Nomad will schedule replacement\nallocations. However, these replaced allocations will continue to\nrun on the non-responsive client; an operator may desire that these\nreplaced allocations are also stopped in this case \u2014 for example,\nallocations requiring exclusive access to an external resource. When\nspecified, the Nomad client will stop them after this duration. The\nNomad client process must be running for this to occur.')),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"task",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#task","aria-label":"task permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"task"))," ",Object(o.b)("code",null,"(",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/task",title:"Nomad task Job Specification"}),"Task"),": ","<","required",">",")")," - Specifies one or more tasks to run\nwithin this group. This can be specified multiple times, to add a task as part\nof the group.")),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"vault",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#vault","aria-label":"vault permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"vault"))," ",Object(o.b)("code",null,"(",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/vault",title:"Nomad vault Job Specification"}),"Vault"),": nil)")," - Specifies the set of Vault policies\nrequired by all tasks in this group. Overrides a ",Object(o.b)("inlineCode",{parentName:"p"},"vault")," block set at the\n",Object(o.b)("inlineCode",{parentName:"p"},"job")," level.")),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"volume",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#volume","aria-label":"volume permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"volume"))," ",Object(o.b)("code",null,"(",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/volume",title:"Nomad volume Job Specification"}),"Volume"),": nil)")," - Specifies the volumes that are\nrequired by tasks within the group."))),Object(o.b)("h2",{className:"g-type-display-3"},Object(o.b)("a",Object(c.a)({parentName:"h2"},{className:"__permalink-h",href:"#group-examples","aria-label":"group examples permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h2"},{className:"__target-h",id:"group-examples","aria-hidden":""})),Object(o.b)("inlineCode",{parentName:"h2"},"group")," Examples"),Object(o.b)("p",null,"The following examples only show the ",Object(o.b)("inlineCode",{parentName:"p"},"group")," stanzas. Remember that the\n",Object(o.b)("inlineCode",{parentName:"p"},"group")," stanza is only valid in the placements listed above."),Object(o.b)("h3",{className:"g-type-display-4"},Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__permalink-h",href:"#specifying-count","aria-label":"specifying count permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__target-h",id:"specifying-count","aria-hidden":""})),"Specifying Count"),Object(o.b)("p",null,"This example specifies that 5 instances of the tasks within this group should be\nrunning:"),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),"group ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"example"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"count")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token number"}),"5"),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("h3",{className:"g-type-display-4"},Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__permalink-h",href:"#tasks-with-constraint","aria-label":"tasks with constraint permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__target-h",id:"tasks-with-constraint","aria-hidden":""})),"Tasks with Constraint"),Object(o.b)("p",null,"This example shows two abbreviated tasks with a constraint on the group. This\nwill restrict the tasks to 64-bit operating systems."),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),"group ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"example"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"attribute")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"',Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token interpolation"}),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"{"),"attr",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"cpu",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"arch",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"value"),"     ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"amd64"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  task ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"cache"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token comment"}),"# ..."),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  task ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"server"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token comment"}),"# ..."),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("h3",{className:"g-type-display-4"},Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__permalink-h",href:"#metadata","aria-label":"metadata permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__target-h",id:"metadata","aria-hidden":""})),"Metadata"),Object(o.b)("p",null,"This example show arbitrary user-defined metadata on the group:"),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),"group ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"example"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"meta")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),'"my-key"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"my-value"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("h3",{className:"g-type-display-4"},Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__permalink-h",href:"#network-1","aria-label":"network permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__target-h",id:"network-1","aria-hidden":""})),"Network"),Object(o.b)("p",null,"This example shows network constraints as specified in the ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/network",title:"Nomad network Job Specification"}),"network")," stanza\nwhich uses the ",Object(o.b)("inlineCode",{parentName:"p"},"bridge")," networking mode, dynamically allocates two ports, and\nstatically allocates one port:"),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),"group ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"example"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"network")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"mode")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"bridge"'),"\n    port ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"http"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n    port ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"https"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n    port ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"lb"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"static")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"8889"'),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("h3",{className:"g-type-display-4"},Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__permalink-h",href:"#service-discovery","aria-label":"service discovery permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__target-h",id:"service-discovery","aria-hidden":""})),"Service Discovery"),Object(o.b)("p",null,"This example creates a service in Consul. To read more about service discovery\nin Nomad, please see the ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/integrations/consul-integration#service-discovery",title:"Nomad Service Discovery"}),"Nomad service discovery documentation"),"."),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),"group ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"example"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"network")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    port ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"api"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"service")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"name")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"example"'),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"port")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"api"'),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"tags")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"default"'),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"check")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"type"),"     ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"tcp"'),"\n      ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"interval")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"10s"'),"\n      ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"timeout"),"  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"2s"'),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  task ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"api"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{")," ... ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("h3",{className:"g-type-display-4"},Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__permalink-h",href:"#stop-after-client-disconnect","aria-label":"stop after client disconnect permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__target-h",id:"stop-after-client-disconnect","aria-hidden":""})),"Stop After Client Disconnect"),Object(o.b)("p",null,"This example shows how ",Object(o.b)("inlineCode",{parentName:"p"},"stop_after_client_disconnect")," interacts with\nother stanzas. For the ",Object(o.b)("inlineCode",{parentName:"p"},"first")," group, after the default 10 second\n",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/configuration/server#heartbeat_grace"}),Object(o.b)("inlineCode",{parentName:"a"},"heartbeat_grace"))," window expires and 90 more seconds passes, the\nserver will reschedule the allocation. The client will wait 90 seconds\nbefore sending a stop signal (",Object(o.b)("inlineCode",{parentName:"p"},"SIGTERM"),") to the ",Object(o.b)("inlineCode",{parentName:"p"},"first-task"),"\ntask. After 15 more seconds because of the task's ",Object(o.b)("inlineCode",{parentName:"p"},"kill_timeout"),", the\nclient will send ",Object(o.b)("inlineCode",{parentName:"p"},"SIGKILL"),". The ",Object(o.b)("inlineCode",{parentName:"p"},"second")," group does not have\n",Object(o.b)("inlineCode",{parentName:"p"},"stop_after_client_disconnect"),", so the server will reschedule the\nallocation after the 10 second ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/configuration/server#heartbeat_grace"}),Object(o.b)("inlineCode",{parentName:"a"},"heartbeat_grace"))," expires. It will\nnot be stopped on the client, regardless of how long the client is out\nof touch."),Object(o.b)("p",null,"Note that if the server's clocks are not closely synchronized with\neach other, the server may reschedule the group before the client has\nstopped the allocation. Operators should ensure that clock drift\nbetween servers is as small as possible."),Object(o.b)("p",null,"Note also that a group using this feature will be stopped on the\nclient if the Nomad server cluster fails, since the client will be\nunable to contact any server in that case. Groups opting in to this\nfeature are therefore exposed to an additional runtime dependency and\npotential point of failure."),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),"group ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"first"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"stop_after_client_disconnect")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"90s"'),"\n\n  task ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"first-task"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"kill_timeout")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"15s"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\ngroup ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"second"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n\n  task ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"second-task"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"kill_timeout")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"5s"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")))}j.isMDXComponent=!0},p2r3:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/job-specification/group",function(){return t("SwWz")}])}},[["p2r3",0,1,2,4,3,5,6]]]);