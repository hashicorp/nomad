(window.webpackJsonp=window.webpackJsonp||[]).push([[181],{T9cy:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return l}));var n=t("wx14"),c=t("Ff2n"),b=t("q1tI"),r=t.n(b),o=t("7ljp"),s=t("j1un"),i=(r.a.createElement,{}),p=Object(s.a)({layout:"docs",page_title:"Drivers: nomad-driver-containerd",sidebar_title:"Containerd",description:"The containerd driver is used for launching containers using containerd.",__resourcePath:"docs/drivers/external/containerd.mdx",__scans:{}});function l(e){var{components:a}=e,t=Object(c.a)(e,["components"]);return Object(o.b)(p,Object(n.a)({},i,t,{components:a,mdxType:"MDXLayout"}),Object(o.b)("h1",{className:"g-type-display-2"},Object(o.b)("a",Object(n.a)({parentName:"h1"},{className:"__permalink-h",href:"#containerd-task-driver","aria-label":"containerd task driver permalink"}),"\xbb"),Object(o.b)("a",Object(n.a)({parentName:"h1"},{className:"__target-h",id:"containerd-task-driver","aria-hidden":""})),"Containerd Task Driver"),Object(o.b)("p",null,"Name: ",Object(o.b)("inlineCode",{parentName:"p"},"containerd-driver")),Object(o.b)("p",null,"Homepage: ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Roblox/nomad-driver-containerd"}),"https://github.com/Roblox/nomad-driver-containerd")),Object(o.b)("p",null,"Containerd (",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://containerd.io"}),Object(o.b)("inlineCode",{parentName:"a"},"containerd.io")),") is a lightweight container daemon\nfor running and managing container lifecycle. Docker daemon also uses containerd."),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),"dockerd (docker daemon) --\x3e containerd --\x3e containerd-shim --\x3e runc\n")),Object(o.b)("p",null,Object(o.b)("inlineCode",{parentName:"p"},"nomad-driver-containerd")," enables Nomad clients to launch containers directly using containerd, without Docker!\nThe Docker daemon is therefore not required on the host system."),Object(o.b)("p",null,"See the project's ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Roblox/nomad-driver-containerd"}),Object(o.b)("inlineCode",{parentName:"a"},"homepage"))," for more details."),Object(o.b)("h2",{className:"g-type-display-3"},Object(o.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#client-requirements","aria-label":"client requirements permalink"}),"\xbb"),Object(o.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"client-requirements","aria-hidden":""})),"Client Requirements"),Object(o.b)("p",null,"The containerd task driver is not built into Nomad. It must be ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/Roblox/nomad-driver-containerd/releases/"}),Object(o.b)("inlineCode",{parentName:"a"},"downloaded")),"\nonto the client host in the configured plugin directory."),Object(o.b)("ul",null,Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),"Linux (Ubuntu >=16.04) with ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://containerd.io/downloads/"}),Object(o.b)("inlineCode",{parentName:"a"},"containerd"))," (>=1.3) installed."),Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/Roblox/nomad-driver-containerd/releases/"}),Object(o.b)("inlineCode",{parentName:"a"},"containerd-driver"))," binary in Nomad's ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"/docs/configuration#plugin_dir"}),"plugin_dir"),".")),Object(o.b)("h2",{className:"g-type-display-3"},Object(o.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#capabilities","aria-label":"capabilities permalink"}),"\xbb"),Object(o.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"capabilities","aria-hidden":""})),"Capabilities"),Object(o.b)("p",null,"The ",Object(o.b)("inlineCode",{parentName:"p"},"containerd-driver")," implements the following ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/internals/plugins/task-drivers#capabilities-capabilities-error"}),"capabilities"),"."),Object(o.b)("table",null,Object(o.b)("thead",{parentName:"table"},Object(o.b)("tr",{parentName:"thead"},Object(o.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Feature"),Object(o.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Implementation"))),Object(o.b)("tbody",{parentName:"table"},Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"send signals"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"true")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"exec"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"true")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"filesystem isolation"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"none")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"volume mounting"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"true")))),Object(o.b)("p",null,"For sending signals, one can use ",Object(o.b)("inlineCode",{parentName:"p"},"nomad alloc signal")," command.",Object(o.b)("br",null),"\nFor exec'ing into the container, one can use ",Object(o.b)("inlineCode",{parentName:"p"},"nomad alloc exec")," command."),Object(o.b)("h2",{className:"g-type-display-3"},Object(o.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#task-configuration","aria-label":"task configuration permalink"}),"\xbb"),Object(o.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"task-configuration","aria-hidden":""})),"Task Configuration"),Object(o.b)("p",null,"Since docker also relies on containerd for managing container lifecycle, the example job created by ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/commands/job/init"}),Object(o.b)("inlineCode",{parentName:"a"},"nomad init -short"))," can easily be adapted to use ",Object(o.b)("inlineCode",{parentName:"p"},"containerd-driver")," instead:"),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),"job ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"redis"')," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"datacenters")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"dc1"'),Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n\n  group ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"redis-group"')," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    task ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"redis-task"')," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"driver")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"containerd-driver"'),"\n\n      ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"image")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"docker.io/library/redis:alpine"'),"\n      ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n      ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"resources")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"cpu"),"    ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"500"),"\n        ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"memory")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"256"),"\n        ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"network")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n          ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"mbits")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"10"),"\n        ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n      ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n    ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("p",null,"The containerd task driver supports the following parameters:"),Object(o.b)("ul",null,Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(n.a)({parentName:"li"},{id:"image",className:"__target-lic","aria-hidden":""})),Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"#image","aria-label":"image permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"image"))," - (Required) OCI image (Docker is also OCI compatible) for your container.")),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"image")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"docker.io/library/redis:alpine"'),"\n",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("ul",null,Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(n.a)({parentName:"li"},{id:"command",className:"__target-lic","aria-hidden":""})),Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"#command","aria-label":"command permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"command"))," - (Optional) Command to override command defined in the image.")),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"command")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"some-command"'),"\n",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("ul",null,Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(n.a)({parentName:"li"},{id:"args",className:"__target-lic","aria-hidden":""})),Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"#args","aria-label":"args permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"args"))," - (Optional) Arguments to the command.")),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"args")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"arg1"'),",\n    ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"arg2"'),",\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("ul",null,Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(n.a)({parentName:"li"},{id:"privileged",className:"__target-lic","aria-hidden":""})),Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"#privileged","aria-label":"privileged permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"privileged"))," - (Optional) ",Object(o.b)("inlineCode",{parentName:"li"},"true")," or ",Object(o.b)("inlineCode",{parentName:"li"},"false")," (default) Run container in privileged mode.\nYour container will have all linux capabilities when running in privileged mode.")),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"privileged")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"true"),"\n",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("ul",null,Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(n.a)({parentName:"li"},{id:"readonly_rootfs",className:"__target-lic","aria-hidden":""})),Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"#readonly_rootfs","aria-label":"readonly_rootfs permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"readonly_rootfs"))," - (Optional) ",Object(o.b)("inlineCode",{parentName:"li"},"true")," or ",Object(o.b)("inlineCode",{parentName:"li"},"false")," (default) Container root filesystem will be read-only.")),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"readonly_rootfs")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"true"),"\n",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("ul",null,Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(n.a)({parentName:"li"},{id:"cap_add",className:"__target-lic","aria-hidden":""})),Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"#cap_add","aria-label":"cap_add permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"cap_add"))," - (Optional) Add individual capabilities.")),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"cap_add")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"CAP_SYS_ADMIN"'),",\n    ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"CAP_CHOWN"'),",\n    ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"CAP_SYS_CHROOT"'),"\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("ul",null,Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(n.a)({parentName:"li"},{id:"cap_drop",className:"__target-lic","aria-hidden":""})),Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"#cap_drop","aria-label":"cap_drop permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"cap_drop"))," - (Optional) Drop individual capabilities.")),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"cap_drop")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"CAP_SYS_ADMIN"'),",\n    ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"CAP_CHOWN"'),",\n    ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"CAP_SYS_CHROOT"'),"\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("ul",null,Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(n.a)({parentName:"li"},{id:"devices",className:"__target-lic","aria-hidden":""})),Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"#devices","aria-label":"devices permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"devices"))," - (Optional) A list of devices to be exposed to the container.")),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"devices")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/dev/loop0"'),",\n    ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/dev/loop1"'),"\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("ul",null,Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(n.a)({parentName:"li"},{id:"mounts",className:"__target-lic","aria-hidden":""})),Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"#mounts","aria-label":"mounts permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"mounts"))," - (Optional) A list of mounts to be mounted in the container.\nVolume, bind and tmpfs type mounts are supported. fstab style ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/containerd/containerd/blob/master/mount/mount_linux.go#L187-L211"}),Object(o.b)("inlineCode",{parentName:"a"},"mount options"))," are supported.",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(n.a)({parentName:"li"},{id:"type",className:"__target-lic","aria-hidden":""})),Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"#type","aria-label":"type permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"type"))," - (Optional) Supported values are ",Object(o.b)("inlineCode",{parentName:"li"},"volume"),", ",Object(o.b)("inlineCode",{parentName:"li"},"bind")," or ",Object(o.b)("inlineCode",{parentName:"li"},"tmpfs"),". ",Object(o.b)("strong",{parentName:"li"},"Default:")," ",Object(o.b)("inlineCode",{parentName:"li"},"volume"),"."),Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(n.a)({parentName:"li"},{id:"target",className:"__target-lic","aria-hidden":""})),Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"#target","aria-label":"target permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"target"))," - (Required) Target path in the container."),Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(n.a)({parentName:"li"},{id:"source",className:"__target-lic","aria-hidden":""})),Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"#source","aria-label":"source permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"source"))," - (Optional) Source path on the host."),Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(n.a)({parentName:"li"},{id:"options",className:"__target-lic","aria-hidden":""})),Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"#options","aria-label":"options permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"options"))," - (Optional) fstab style ",Object(o.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/containerd/containerd/blob/master/mount/mount_linux.go#L187-L211"}),Object(o.b)("inlineCode",{parentName:"a"},"mount options")),". ",Object(o.b)("strong",{parentName:"li"},"NOTE:")," For bind mounts, atleast ",Object(o.b)("inlineCode",{parentName:"li"},"rbind")," and ",Object(o.b)("inlineCode",{parentName:"li"},"ro")," are required.")))),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"mounts")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"type")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"bind"'),"\n      ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"target")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/tmp/t1"'),"\n      ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"source")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/tmp/s1"'),"\n      ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"options")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"rbind"'),", ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"ro"'),Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n    ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("h2",{className:"g-type-display-3"},Object(o.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#networking","aria-label":"networking permalink"}),"\xbb"),Object(o.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"networking","aria-hidden":""})),"Networking"),Object(o.b)("p",null,"Networking is ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"https://kubernetes.io/blog/2017/11/containerd-container-runtime-options-kubernetes/#containerd"}),Object(o.b)("inlineCode",{parentName:"a"},"out-of-scope"))," for containerd. An external CNI plugin might be needed to support networking."),Object(o.b)("h2",{className:"g-type-display-3"},Object(o.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#plugin_options","aria-label":"plugin options permalink"}),"\xbb"),Object(o.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h __compat",id:"plugin_options","aria-hidden":""})),Object(o.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"plugin-options","aria-hidden":""})),"Plugin Options"),Object(o.b)("ul",null,Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(n.a)({parentName:"li"},{id:"enabled",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"#enabled","aria-label":"enabled permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"enabled"))," - (Optional) The ",Object(o.b)("inlineCode",{parentName:"p"},"containerd")," driver may be disabled on hosts by setting this option to ",Object(o.b)("inlineCode",{parentName:"p"},"false")," (defaults to ",Object(o.b)("inlineCode",{parentName:"p"},"true"),").")),Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(n.a)({parentName:"li"},{id:"containerd_runtime",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"#containerd_runtime","aria-label":"containerd_runtime permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"containerd_runtime"))," - (Required) Runtime for ",Object(o.b)("inlineCode",{parentName:"p"},"containerd")," e.g. ",Object(o.b)("inlineCode",{parentName:"p"},"io.containerd.runc.v1")," or ",Object(o.b)("inlineCode",{parentName:"p"},"io.containerd.runc.v2"))),Object(o.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(n.a)({parentName:"li"},{id:"stats_interval",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"#stats_interval","aria-label":"stats_interval permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"stats_interval"))," - (Optional) This value defines how frequently you want to send ",Object(o.b)("inlineCode",{parentName:"p"},"TaskStats")," to nomad client. (defaults to ",Object(o.b)("inlineCode",{parentName:"p"},"1 second"),")."))),Object(o.b)("p",null,"An example of using these plugin options with the new ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/configuration/plugin"}),"plugin\nsyntax")," is shown below:"),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),"plugin ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"containerd-driver"')," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"enabled")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"true"),"\n    ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"containerd_runtime")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"io.containerd.runc.v2"'),"\n    ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"stats_interval")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"5s"'),"\n  ",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(o.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("p",null,"Please note the plugin name should match whatever name you have specified for the external driver in the ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/configuration#plugin_dir"}),"plugin_dir")," directory."))}l.isMDXComponent=!0},onPA:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/drivers/external/containerd",function(){return t("T9cy")}])}},[["onPA",0,1,2,4,3,5,6]]]);