(window.webpackJsonp=window.webpackJsonp||[]).push([[236],{"f+rR":function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/job-specification/job",function(){return t("ucdL")}])},ucdL:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return j}));var n,c=t("wx14"),b=t("Ff2n"),s=t("q1tI"),o=t.n(s),p=t("7ljp"),i=t("j1un"),r=(o.a.createElement,n="Placement",function(e){return console.warn("Component "+n+" was not imported, exported, or provided by MDXProvider as global scope"),Object(p.b)("div",e)}),l={},m=Object(i.a)({layout:"docs",page_title:"job Stanza - Job Specification",sidebar_title:"job",description:'The "job" stanza is the top-most configuration option in the job\nspecification. A job is a declarative specification of tasks that Nomad\nshould run.',__resourcePath:"docs/job-specification/job.mdx",__scans:{}});function j(e){var a=e.components,t=Object(b.a)(e,["components"]);return Object(p.b)(m,Object(c.a)({},l,t,{components:a,mdxType:"MDXLayout"}),Object(p.b)("h1",{className:"g-type-display-2"},Object(p.b)("a",Object(c.a)({parentName:"h1"},{className:"__permalink-h",href:"#job-stanza","aria-label":"job stanza permalink"}),"\xbb"),Object(p.b)("a",Object(c.a)({parentName:"h1"},{className:"__target-h",id:"job-stanza","aria-hidden":""})),Object(p.b)("inlineCode",{parentName:"h1"},"job")," Stanza"),Object(p.b)(r,{groups:["job"],mdxType:"Placement"}),Object(p.b)("p",null,"The ",Object(p.b)("inlineCode",{parentName:"p"},"job")," stanza is the top-most configuration option in the job specification.\nA job is a declarative specification of tasks that Nomad should run. Jobs have\none or more task groups, which are themselves collections of one or more tasks.\nJob names are unique per ",Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"https://learn.hashicorp.com/nomad/operating-nomad/federation"}),"region")," or ",Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"https://learn.hashicorp.com/nomad/governance-and-policy/namespaces"}),"namespace")," (if Nomad\nEnterprise is used)."),Object(p.b)("pre",{className:"language-hcl"},Object(p.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),"job ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"docs"')," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token comment"}),"# ..."),"\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"datacenters")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"us-east-1"'),Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n\n  group ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"example"')," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token comment"}),"# ..."),"\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"meta")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),'"my-key"')," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"my-value"'),"\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"parameterized")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token comment"}),"# ..."),"\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"periodic")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token comment"}),"# ..."),"\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"priority")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token number"}),"100"),"\n\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"region")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"north-america"'),"\n\n  task ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"docs"')," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token comment"}),"# ..."),"\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"update")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token comment"}),"# ..."),"\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(p.b)("h2",{className:"g-type-display-3"},Object(p.b)("a",Object(c.a)({parentName:"h2"},{className:"__permalink-h",href:"#job-parameters","aria-label":"job parameters permalink"}),"\xbb"),Object(p.b)("a",Object(c.a)({parentName:"h2"},{className:"__target-h",id:"job-parameters","aria-hidden":""})),Object(p.b)("inlineCode",{parentName:"h2"},"job")," Parameters"),Object(p.b)("ul",null,Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"all_at_once",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#all_at_once","aria-label":"all_at_once permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"all_at_once"))," ",Object(p.b)("inlineCode",{parentName:"p"},"(bool: false)")," - Controls whether the scheduler can make\npartial placements if optimistic scheduling resulted in an oversubscribed\nnode. This does not control whether all allocations for the job, where all\nwould be the desired count for each task group, must be placed atomically.\nThis should only be used for special circumstances.")),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"constraint",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#constraint","aria-label":"constraint permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"constraint"))," ",Object(p.b)("code",null,"(",Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/constraint",title:"Nomad constraint Job Specification"}),"Constraint"),": nil)")," -\nThis can be provided multiple times to define additional constraints. See the\n",Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/constraint",title:"Nomad constraint Job Specification"}),"Nomad constraint reference")," for more\ndetails.")),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"affinity",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#affinity","aria-label":"affinity permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"affinity"))," ",Object(p.b)("code",null,"(",Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/affinity",title:"Nomad affinity Job Specification"}),"Affinity"),": nil)")," -\nThis can be provided multiple times to define preferred placement criteria. See the\n",Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/affinity",title:"Nomad affinity Job Specification"}),"Nomad affinity reference")," for more\ndetails.")),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"spread",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#spread","aria-label":"spread permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"spread"))," ",Object(p.b)("code",null,"(",Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/spread",title:"Nomad spread Job Specification"}),"Spread"),": nil)")," - This can be provided multiple times\nto define criteria for spreading allocations across a node attribute or metadata.\nSee the ",Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/spread",title:"Nomad spread Job Specification"}),"Nomad spread reference")," for more details.")),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"datacenters",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#datacenters","aria-label":"datacenters permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"datacenters"))," ",Object(p.b)("inlineCode",{parentName:"p"},"(array<string>: <required>)")," - A list of datacenters in the region which are eligible\nfor task placement. This must be provided, and does not have a default.")),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"group",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#group","aria-label":"group permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"group"))," ",Object(p.b)("inlineCode",{parentName:"p"},"([Group][group]: <required>)")," - Specifies the start of a\ngroup of tasks. This can be provided multiple times to define additional\ngroups. Group names must be unique within the job file.")),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"meta",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#meta","aria-label":"meta permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"meta"))," ",Object(p.b)("code",null,"(",Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/meta",title:"Nomad meta Job Specification"}),"Meta"),": nil)")," - Specifies a key-value map that annotates\nwith user-defined metadata.")),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"name",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#name","aria-label":"name permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"name"))," ",Object(p.b)("inlineCode",{parentName:"p"},"(string: <optional>)")," - Specifies a name for the job, which otherwise\ndefaults to the job ID.")),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"migrate",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#migrate","aria-label":"migrate permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"migrate"))," ",Object(p.b)("code",null,"(",Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/migrate",title:"Nomad migrate Job Specification"}),"Migrate"),": nil)")," - Specifies the groups strategy for\nmigrating off of draining nodes. If omitted, a default migration strategy is\napplied. Only service jobs with a count greater than 1 support migrate stanzas.")),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"namespace",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#namespace","aria-label":"namespace permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"namespace"))," ",Object(p.b)("inlineCode",{parentName:"p"},'(string: "default")')," - The namespace in which to execute the job.\nValues other than default are not allowed in non-Enterprise versions of Nomad.")),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"parameterized",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#parameterized","aria-label":"parameterized permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"parameterized"))," ",Object(p.b)("code",null,"(",Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/parameterized",title:"Nomad parameterized Job Specification"}),"Parameterized"),": nil)")," - Specifies\nthe job as a parameterized job such that it can be dispatched against.")),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"periodic",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#periodic","aria-label":"periodic permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"periodic"))," ",Object(p.b)("code",null,"(",Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/periodic",title:"Nomad periodic Job Specification"}),"Periodic"),": nil)")," - Allows the job to be scheduled\nat fixed times, dates or intervals.")),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"priority",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#priority","aria-label":"priority permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"priority"))," ",Object(p.b)("inlineCode",{parentName:"p"},"(int: 50)")," - Specifies the job priority which is used to\nprioritize scheduling and access to resources. Must be between 1 and 100\ninclusively, with a larger value corresponding to a higher priority.")),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"region",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#region","aria-label":"region permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"region"))," ",Object(p.b)("inlineCode",{parentName:"p"},'(string: "global")')," - The region in which to execute the job.")),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"reschedule",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#reschedule","aria-label":"reschedule permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"reschedule"))," ",Object(p.b)("code",null,"(",Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/reschedule",title:"Nomad reschedule Job Specification"}),"Reschedule"),": nil)"),' - Allows to specify a\nrescheduling strategy. Nomad will then attempt to schedule the task on another\nnode if any of its allocation statuses become "failed".')),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"type",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#type","aria-label":"type permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"type"))," ",Object(p.b)("inlineCode",{parentName:"p"},'(string: "service")')," - Specifies the ",Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/schedulers",title:"Nomad Scheduler Types"}),"Nomad scheduler")," to\nuse. Nomad provides the ",Object(p.b)("inlineCode",{parentName:"p"},"service"),", ",Object(p.b)("inlineCode",{parentName:"p"},"system")," and ",Object(p.b)("inlineCode",{parentName:"p"},"batch")," schedulers.")),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"update",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#update","aria-label":"update permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"update"))," ",Object(p.b)("code",null,"(",Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/update",title:"Nomad update Job Specification"}),"Update"),": nil)")," - Specifies the task's update\nstrategy. When omitted, rolling updates are disabled.")),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"vault",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#vault","aria-label":"vault permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"vault"))," ",Object(p.b)("code",null,"(",Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/vault",title:"Nomad vault Job Specification"}),"Vault"),": nil)")," - Specifies the set of Vault policies\nrequired by all tasks in this job.")),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"vault_token",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#vault_token","aria-label":"vault_token permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"vault_token"))," ",Object(p.b)("inlineCode",{parentName:"p"},'(string: "")')," - Specifies the Vault token that proves the\nsubmitter of the job has access to the specified policies in the\n",Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/vault",title:"Nomad vault Job Specification"}),Object(p.b)("inlineCode",{parentName:"a"},"vault"))," stanza. This field is only used to transfer the token and is\nnot stored after job submission."),Object(p.b)("div",Object(c.a)({parentName:"li"},{className:"alert alert-danger g-type-body",role:"alert"}),Object(p.b)("p",{parentName:"div"},"It is ",Object(p.b)("strong",{parentName:"p"},"strongly discouraged")," to place the token as a configuration\nparameter like this, since the token could be checked into source control\naccidentally. Users should set the ",Object(p.b)("inlineCode",{parentName:"p"},"VAULT_TOKEN")," environment variable when\nrunning the job instead."))),Object(p.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(p.b)("a",Object(c.a)({parentName:"li"},{id:"consul_token",className:"__target-lic","aria-hidden":""})),Object(p.b)("p",{parentName:"li"},Object(p.b)("a",Object(c.a)({parentName:"p"},{href:"#consul_token","aria-label":"consul_token permalink",className:"__permalink-lic"}),Object(p.b)("inlineCode",{parentName:"a"},"consul_token"))," ",Object(p.b)("inlineCode",{parentName:"p"},'(string: "")')," - Specifies the Consul token that proves the\nsubmitter of the job has access to the Service Identity policies associated\nwith the job's Consul Connect enabled services. This field is only used to\ntransfer the token and is not stored after job submission."),Object(p.b)("div",Object(c.a)({parentName:"li"},{className:"alert alert-danger g-type-body",role:"alert"}),Object(p.b)("p",{parentName:"div"},"It is ",Object(p.b)("strong",{parentName:"p"},"strongly discouraged")," to place the token as a configuration\nparameter like this, since the token could be checked into source control\naccidentally. Users should set the ",Object(p.b)("inlineCode",{parentName:"p"},"CONSUL_HTTP_TOKEN")," environment variable when\nrunning the job instead.")))),Object(p.b)("h2",{className:"g-type-display-3"},Object(p.b)("a",Object(c.a)({parentName:"h2"},{className:"__permalink-h",href:"#job-examples","aria-label":"job examples permalink"}),"\xbb"),Object(p.b)("a",Object(c.a)({parentName:"h2"},{className:"__target-h",id:"job-examples","aria-hidden":""})),Object(p.b)("inlineCode",{parentName:"h2"},"job")," Examples"),Object(p.b)("p",null,"The following examples only show the ",Object(p.b)("inlineCode",{parentName:"p"},"job")," stanzas. Remember that the\n",Object(p.b)("inlineCode",{parentName:"p"},"job")," stanza is only valid in the placements listed above."),Object(p.b)("h3",{className:"g-type-display-4"},Object(p.b)("a",Object(c.a)({parentName:"h3"},{className:"__permalink-h",href:"#docker-container","aria-label":"docker container permalink"}),"\xbb"),Object(p.b)("a",Object(c.a)({parentName:"h3"},{className:"__target-h",id:"docker-container","aria-hidden":""})),"Docker Container"),Object(p.b)("p",null,'This example job starts a Docker container which runs as a service. Even though\nthe type is not specified as "service", that is the default job type.'),Object(p.b)("pre",{className:"language-hcl"},Object(p.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),"job ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"docs"')," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"datacenters")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"default"'),Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n\n  group ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"example"')," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    task ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"server"')," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"driver")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"docker"'),"\n      ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"image")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"hashicorp/http-echo"'),"\n        ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"args"),"  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"-text"'),", ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"hello"'),Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n      ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n      ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"resources")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"memory")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token number"}),"128"),"\n      ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n    ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(p.b)("h3",{className:"g-type-display-4"},Object(p.b)("a",Object(c.a)({parentName:"h3"},{className:"__permalink-h",href:"#batch-job","aria-label":"batch job permalink"}),"\xbb"),Object(p.b)("a",Object(c.a)({parentName:"h3"},{className:"__target-h",id:"batch-job","aria-hidden":""})),"Batch Job"),Object(p.b)("p",null,"This example job executes the ",Object(p.b)("inlineCode",{parentName:"p"},"uptime")," command on 10 Nomad clients in the fleet,\nrestricting the eligible nodes to Linux machines."),Object(p.b)("pre",{className:"language-hcl"},Object(p.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),"job ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"docs"')," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"datacenters")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"default"'),Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"type")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"batch"'),"\n\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"attribute")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"',Object(p.b)("span",Object(c.a)({parentName:"span"},{className:"token interpolation"}),Object(p.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(p.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"{"),"attr",Object(p.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"kernel",Object(p.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"name",Object(p.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),"\n    ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"value"),"     ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"linux"'),"\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  group ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"example"')," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"count")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token number"}),"10"),"\n    task ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"uptime"')," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"driver")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"exec"'),"\n      ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"command")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"uptime"'),"\n      ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n    ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(p.b)("h3",{className:"g-type-display-4"},Object(p.b)("a",Object(c.a)({parentName:"h3"},{className:"__permalink-h",href:"#consuming-secrets","aria-label":"consuming secrets permalink"}),"\xbb"),Object(p.b)("a",Object(c.a)({parentName:"h3"},{className:"__target-h",id:"consuming-secrets","aria-hidden":""})),"Consuming Secrets"),Object(p.b)("p",null,"This example shows a job which retrieves secrets from Vault and writes those\nsecrets to a file on disk, which the application then consumes. Nomad handles\nall interactions with Vault."),Object(p.b)("pre",{className:"language-hcl"},Object(p.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),"job ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"docs"')," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"datacenters")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"default"'),Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n\n  group ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"example"')," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    task ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"cat"')," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"driver")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"exec"'),"\n\n      ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"command")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"cat"'),"\n        ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"args"),"    ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"local/secrets.txt"'),Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n      ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n      ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"template")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"data"),"        ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"{{ secret \\"secret/data\\" }}"'),"\n        ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"destination")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"local/secrets.txt"'),"\n      ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n      ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"vault")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"policies")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"secret-readonly"'),Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n      ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n    ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(p.b)("p",null,"When submitting this job, you would run:"),Object(p.b)("pre",{className:"language-shell-session"},Object(p.b)("code",Object(c.a)({parentName:"pre"},{className:"language-shell-session"}),Object(p.b)("span",Object(c.a)({parentName:"code"},{className:"token command"}),Object(p.b)("span",Object(c.a)({parentName:"span"},{className:"token sh important"}),"$")," ",Object(p.b)("span",Object(c.a)({parentName:"span"},{className:"token bash language-bash"}),Object(p.b)("span",Object(c.a)({parentName:"span"},{className:"token assign-left variable"}),"VAULT_TOKEN"),Object(p.b)("span",Object(c.a)({parentName:"span"},{className:"token operator"}),"="),Object(p.b)("span",Object(c.a)({parentName:"span"},{className:"token string"}),'"..."')," nomad job run example.nomad")),"\n")))}j.isMDXComponent=!0}},[["f+rR",0,1,2,4,3,5,6]]]);