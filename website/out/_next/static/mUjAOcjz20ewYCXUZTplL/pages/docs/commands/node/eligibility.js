(window.webpackJsonp=window.webpackJsonp||[]).push([[119],{iiZE:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return p}));var i=t("wx14"),n=t("Ff2n"),l=t("q1tI"),c=t.n(l),b=t("7ljp"),r=t("j1un"),s=(c.a.createElement,{}),o=Object(r.a)({layout:"docs",page_title:"Commands: node eligibility",sidebar_title:"eligibility",description:"The node eligibility command is used to configure a node's scheduling eligibility.\n",__resourcePath:"docs/commands/node/eligibility.mdx",__scans:{}});function p(e){var a=e.components,t=Object(n.a)(e,["components"]);return Object(b.b)(o,Object(i.a)({},s,t,{components:a,mdxType:"MDXLayout"}),Object(b.b)("h1",{className:"g-type-display-2"},Object(b.b)("a",Object(i.a)({parentName:"h1"},{className:"__permalink-h",href:"#command-node-eligibility","aria-label":"command node eligibility permalink"}),"\xbb"),Object(b.b)("a",Object(i.a)({parentName:"h1"},{className:"__target-h",id:"command-node-eligibility","aria-hidden":""})),"Command: node eligibility"),Object(b.b)("p",null,"The ",Object(b.b)("inlineCode",{parentName:"p"},"node eligibility")," command is used to toggle scheduling eligibility for a\ngiven node. By default nodes are eligible for scheduling meaning they can\nreceive placements and run new allocations. Nodes that have their scheduling\nelegibility disabled are ineligibile for new placements."),Object(b.b)("p",null,"The ",Object(b.b)("a",Object(i.a)({parentName:"p"},{href:"/docs/commands/node/drain"}),Object(b.b)("inlineCode",{parentName:"a"},"node drain"))," command automatically disables eligibility. Disabling\na drain restore eligibility by default."),Object(b.b)("p",null,"Disable scheduling eligibility is useful when draining a set of nodes: first\ndisable eligibility on each node that will be drained. Then drain each node.\nIf you just drain each node allocations may get rescheduled multiple times as\nthey get placed on nodes about to be drained!"),Object(b.b)("p",null,"Disabling scheduling eligibility may also be useful when investigating poorly\nbehaved nodes. It allows operators to investigate the current state of a node\nwithout the risk of additional work being assigned to it."),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(i.a)({parentName:"h2"},{className:"__permalink-h",href:"#usage","aria-label":"usage permalink"}),"\xbb"),Object(b.b)("a",Object(i.a)({parentName:"h2"},{className:"__target-h",id:"usage","aria-hidden":""})),"Usage"),Object(b.b)("pre",{className:"language-plaintext"},Object(b.b)("code",Object(i.a)({parentName:"pre"},{className:"language-plaintext"}),"nomad node eligibility [options] <node>\n")),Object(b.b)("p",null,"A ",Object(b.b)("inlineCode",{parentName:"p"},"-self")," flag can be used to toggle eligibility of the local node. If this is\nnot supplied, a node ID or prefix must be provided. If there is an exact match,\nthe eligibility will be adjusted for that node. Otherwise, a list of matching\nnodes and information will be displayed."),Object(b.b)("p",null,"It is also required to pass one of ",Object(b.b)("inlineCode",{parentName:"p"},"-enable")," or ",Object(b.b)("inlineCode",{parentName:"p"},"-disable"),", depending on which\noperation is desired."),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(i.a)({parentName:"h2"},{className:"__permalink-h",href:"#general-options","aria-label":"general options permalink"}),"\xbb"),Object(b.b)("a",Object(i.a)({parentName:"h2"},{className:"__target-h",id:"general-options","aria-hidden":""})),"General Options"),Object(b.b)("ul",null,Object(b.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(i.a)({parentName:"li"},{id:"address",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(i.a)({parentName:"p"},{href:"#address","aria-label":"address permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-address=<addr>")),": The address of the Nomad server. Overrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_ADDR"),"\nenvironment variable if set. Defaults to ",Object(b.b)("inlineCode",{parentName:"p"},"http://127.0.0.1:4646"),".")),Object(b.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(i.a)({parentName:"li"},{id:"region",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(i.a)({parentName:"p"},{href:"#region","aria-label":"region permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-region=<region>")),": The region of the Nomad server to forward commands to.\nOverrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_REGION")," environment variable if set. Defaults to the\nAgent's local region.")),Object(b.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(i.a)({parentName:"li"},{id:"namespace",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(i.a)({parentName:"p"},{href:"#namespace","aria-label":"namespace permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-namespace=<namespace>")),": The target namespace for queries and actions bound\nto a namespace. Overrides the NOMAD_NAMESPACE environment variable if set.\nIf set to '*', job and alloc subcommands query all namespacecs authorized to\nuser. Defaults to the \"default\" namespace.")),Object(b.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(i.a)({parentName:"li"},{id:"no-color",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(i.a)({parentName:"p"},{href:"#no-color","aria-label":"no color permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-no-color")),": Disables colored command output. Alternatively,\n",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_CLI_NO_COLOR")," may be set.")),Object(b.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(i.a)({parentName:"li"},{id:"ca-cert",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(i.a)({parentName:"p"},{href:"#ca-cert","aria-label":"ca cert permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-ca-cert=<path>")),": Path to a PEM encoded CA cert file to use to verify the\nNomad server SSL certificate. Overrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_CACERT")," environment\nvariable if set.")),Object(b.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(i.a)({parentName:"li"},{id:"ca-path",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(i.a)({parentName:"p"},{href:"#ca-path","aria-label":"ca path permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-ca-path=<path>")),": Path to a directory of PEM encoded CA cert files to verify\nthe Nomad server SSL certificate. If both ",Object(b.b)("inlineCode",{parentName:"p"},"-ca-cert")," and ",Object(b.b)("inlineCode",{parentName:"p"},"-ca-path")," are\nspecified, ",Object(b.b)("inlineCode",{parentName:"p"},"-ca-cert")," is used. Overrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_CAPATH")," environment\nvariable if set.")),Object(b.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(i.a)({parentName:"li"},{id:"client-cert",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(i.a)({parentName:"p"},{href:"#client-cert","aria-label":"client cert permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-client-cert=<path>")),": Path to a PEM encoded client certificate for TLS\nauthentication to the Nomad server. Must also specify ",Object(b.b)("inlineCode",{parentName:"p"},"-client-key"),". Overrides\nthe ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_CLIENT_CERT")," environment variable if set.")),Object(b.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(i.a)({parentName:"li"},{id:"client-key",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(i.a)({parentName:"p"},{href:"#client-key","aria-label":"client key permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-client-key=<path>")),": Path to an unencrypted PEM encoded private key matching\nthe client certificate from ",Object(b.b)("inlineCode",{parentName:"p"},"-client-cert"),". Overrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_CLIENT_KEY"),"\nenvironment variable if set.")),Object(b.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(i.a)({parentName:"li"},{id:"tls-server-name",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(i.a)({parentName:"p"},{href:"#tls-server-name","aria-label":"tls server name permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-tls-server-name=<value>")),": The server name to use as the SNI host when connecting\nvia TLS. Overrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_TLS_SERVER_NAME")," environment variable if set.")),Object(b.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(i.a)({parentName:"li"},{id:"tls-skip-verify",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(i.a)({parentName:"p"},{href:"#tls-skip-verify","aria-label":"tls skip verify permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-tls-skip-verify")),": Do not verify TLS certificate. This is highly not\nrecommended. Verification will also be skipped if ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_SKIP_VERIFY")," is set.")),Object(b.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(i.a)({parentName:"li"},{id:"token",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(i.a)({parentName:"p"},{href:"#token","aria-label":"token permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-token")),": The SecretID of an ACL token to use to authenticate API requests with.\nOverrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_TOKEN")," environment variable if set."))),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(i.a)({parentName:"h2"},{className:"__permalink-h",href:"#eligibility-options","aria-label":"eligibility options permalink"}),"\xbb"),Object(b.b)("a",Object(i.a)({parentName:"h2"},{className:"__target-h",id:"eligibility-options","aria-hidden":""})),"Eligibility Options"),Object(b.b)("ul",null,Object(b.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(i.a)({parentName:"li"},{id:"enable",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(i.a)({parentName:"li"},{href:"#enable","aria-label":"enable permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-enable")),": Enable scheduling eligibility."),Object(b.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(i.a)({parentName:"li"},{id:"disable",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(i.a)({parentName:"li"},{href:"#disable","aria-label":"disable permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-disable")),": Disable scheduling eligibility."),Object(b.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(i.a)({parentName:"li"},{id:"self",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(i.a)({parentName:"li"},{href:"#self","aria-label":"self permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-self")),": Set eligibility for the local node."),Object(b.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(i.a)({parentName:"li"},{id:"yes",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(i.a)({parentName:"li"},{href:"#yes","aria-label":"yes permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-yes")),": Automatic yes to prompts.")),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(i.a)({parentName:"h2"},{className:"__permalink-h",href:"#examples","aria-label":"examples permalink"}),"\xbb"),Object(b.b)("a",Object(i.a)({parentName:"h2"},{className:"__target-h",id:"examples","aria-hidden":""})),"Examples"),Object(b.b)("p",null,'Enable scheduling eligibility on node with ID prefix "574545c5":'),Object(b.b)("pre",{className:"language-shell-session"},Object(b.b)("code",Object(i.a)({parentName:"pre"},{className:"language-shell-session"}),Object(b.b)("span",Object(i.a)({parentName:"code"},{className:"token command"}),Object(b.b)("span",Object(i.a)({parentName:"span"},{className:"token sh important"}),"$")," ",Object(b.b)("span",Object(i.a)({parentName:"span"},{className:"token bash language-bash"}),"nomad node eligibility -enable 574545c5")),"\n",Object(b.b)("span",Object(i.a)({parentName:"code"},{className:"token output"}),'Node "574545c5-c2d7-e352-d505-5e2cb9fe169f" scheduling eligibility set: eligible for scheduling\n'))),Object(b.b)("p",null,"Disable scheduling eligibility on the local node:"),Object(b.b)("pre",{className:"language-shell-session"},Object(b.b)("code",Object(i.a)({parentName:"pre"},{className:"language-shell-session"}),Object(b.b)("span",Object(i.a)({parentName:"code"},{className:"token command"}),Object(b.b)("span",Object(i.a)({parentName:"span"},{className:"token sh important"}),"$")," ",Object(b.b)("span",Object(i.a)({parentName:"span"},{className:"token bash language-bash"}),"nomad node eligibility -disable -self")),"\n",Object(b.b)("span",Object(i.a)({parentName:"code"},{className:"token output"}),'Node "574545c5-c2d7-e352-d505-5e2cb9fe169f" scheduling eligibility set: ineligible for scheduling\n'))))}p.isMDXComponent=!0},li5U:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/commands/node/eligibility",function(){return t("iiZE")}])}},[["li5U",0,1,2,4,3,5,6]]]);