(window.webpackJsonp=window.webpackJsonp||[]).push([[126],{"27lS":function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/commands/operator/keyring",function(){return t("g29P")}])},g29P:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return p}));var n=t("wx14"),r=t("Ff2n"),l=t("q1tI"),i=t.n(l),s=t("7ljp"),c=t("j1un"),o=(i.a.createElement,{}),b=Object(c.a)({layout:"docs",page_title:"Commands: operator keyring",sidebar_title:"keyring",__resourcePath:"docs/commands/operator/keyring.mdx",__scans:{}});function p(e){var a=e.components,t=Object(r.a)(e,["components"]);return Object(s.b)(b,Object(n.a)({},o,t,{components:a,mdxType:"MDXLayout"}),Object(s.b)("h1",{className:"g-type-display-2"},Object(s.b)("a",Object(n.a)({parentName:"h1"},{className:"__permalink-h",href:"#command-operator-keyring","aria-label":"command operator keyring permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h1"},{className:"__target-h",id:"command-operator-keyring","aria-hidden":""})),"Command: operator keyring"),Object(s.b)("p",null,"The ",Object(s.b)("inlineCode",{parentName:"p"},"operator keyring")," command is used to examine and modify the encryption keys\nused in Nomad server. It is capable of distributing new encryption keys to the\ncluster, retiring old encryption keys, and changing the keys used by the cluster\nto encrypt messages."),Object(s.b)("p",null,"Nomad allows multiple encryption keys to be in use simultaneously. This is\nintended to provide a transition state while the cluster converges. It is the\nresponsibility of the operator to ensure that only the required encryption keys\nare installed on the cluster. You can review the installed keys using the\n",Object(s.b)("inlineCode",{parentName:"p"},"-list")," argument, and remove unneeded keys with ",Object(s.b)("inlineCode",{parentName:"p"},"-remove"),"."),Object(s.b)("p",null,"All operations performed by this command can only be run against server nodes\nand will effect the entire cluster."),Object(s.b)("p",null,"All variations of the ",Object(s.b)("inlineCode",{parentName:"p"},"keyring")," command return 0 if all nodes reply and there\nare no errors. If any node fails to reply or reports failure, the exit code\nwill be 1."),Object(s.b)("h2",{className:"g-type-display-3"},Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#usage","aria-label":"usage permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"usage","aria-hidden":""})),"Usage"),Object(s.b)("pre",{className:"language-plaintext"},Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-plaintext"}),"nomad operator keyring [options]\n")),Object(s.b)("p",null,"Only one actionable argument may be specified per run, including ",Object(s.b)("inlineCode",{parentName:"p"},"-list"),",\n",Object(s.b)("inlineCode",{parentName:"p"},"-install"),", ",Object(s.b)("inlineCode",{parentName:"p"},"-remove"),", and ",Object(s.b)("inlineCode",{parentName:"p"},"-use"),"."),Object(s.b)("p",null,"The list of available flags are:"),Object(s.b)("ul",null,Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"list",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#list","aria-label":"list permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"-list"))," - List all keys currently in use within the cluster.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"install",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#install","aria-label":"install permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"-install"))," - Install a new encryption key. This will broadcast the new key to\nall members in the cluster.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"use",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#use","aria-label":"use permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"-use"))," - Change the primary encryption key, which is used to encrypt messages.\nThe key must already be installed before this operation can succeed.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"remove",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#remove","aria-label":"remove permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"-remove"))," - Remove the given key from the cluster. This operation may only be\nperformed on keys which are not currently the primary key."))),Object(s.b)("h2",{className:"g-type-display-3"},Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#output","aria-label":"output permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"output","aria-hidden":""})),"Output"),Object(s.b)("p",null,"The output of the ",Object(s.b)("inlineCode",{parentName:"p"},"nomad operator keyring -list")," command consolidates\ninformation from all the Nomad servers from all datacenters and regions to\nprovide a simple and easy to understand view of the cluster."),Object(s.b)("pre",{className:"language-shell-session"},Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell-session"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token command"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token sh important"}),"$")," ",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token bash language-bash"}),"nomad operator keyring -list")),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token output"}),"==> Gathering installed encryption keys...\nKey\nPGm64/neoebUBqYR/lZTbA==\n"))))}p.isMDXComponent=!0}},[["27lS",0,1,2,4,3,5,6]]]);