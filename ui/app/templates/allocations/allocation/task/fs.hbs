{{task-subnav task=task}}
<section class="section is-closer {{if isFile "full-width-section"}}">
  {{#if task.isRunning}}
    {{#if isFile}}
        {{#task-file allocation=task.allocation task=task file=path stat=stat class="fs-explorer"}}
          <nav class="breadcrumb" data-test-fs-breadcrumbs>
            <ul>
              <li class={{if breadcrumbs "" "is-active"}}>
                {{#link-to "allocations.allocation.task.fs-root" task.allocation task activeClass="is-active"}}
                  {{task.name}}
                {{/link-to}}
              </li>
              {{#each breadcrumbs as |breadcrumb|}}
                <li class={{if breadcrumb.isLast "is-active"}}>
                  {{#link-to "allocations.allocation.task.fs" task.allocation task breadcrumb.path activeClass="is-active"}}
                    {{breadcrumb.name}}
                  {{/link-to}}
                </li>
              {{/each}}
            </ul>
          </nav>
        {{/task-file}}
    {{else}}
      <div class="fs-explorer boxed-section">
        <div class="boxed-section-head">
          <nav class="breadcrumb" data-test-fs-breadcrumbs>
            <ul>
              <li class={{if breadcrumbs "" "is-active"}}>
                {{#link-to "allocations.allocation.task.fs-root" task.allocation task activeClass="is-active"}}
                  {{task.name}}
                {{/link-to}}
              </li>
              {{#each breadcrumbs as |breadcrumb|}}
                <li class={{if breadcrumb.isLast "is-active"}}>
                  {{#link-to "allocations.allocation.task.fs" task.allocation task breadcrumb.path activeClass="is-active"}}
                    {{breadcrumb.name}}
                  {{/link-to}}
                </li>
              {{/each}}
            </ul>
          </nav>
        </div>
        {{#list-table
          source=sortedDirectoryEntries
          sortProperty=sortProperty
          sortDescending=sortDescending
          class="boxed-section-body is-full-bleed is-compact" as |t|}}
          {{#if directoryEntries}}
            {{#t.head}}
              {{#t.sort-by prop="Name" class="is-two-thirds"}}Name{{/t.sort-by}}
              {{#t.sort-by prop="Size" class="has-text-right"}}File Size{{/t.sort-by}}
              {{#t.sort-by prop="ModTime" class="has-text-right"}}Last Modified{{/t.sort-by}}
            {{/t.head}}
            {{#t.body as |row|}}
              {{fs-directory-entry path=path task=task entry=row.model}}
            {{/t.body}}
          {{else}}
            <tbody>
              <tr data-test-entry>
                <td colspan="3">
                  {{x-icon "alert-circle-outline"}}
                  <span class="name" data-test-name>Directory is empty</span>
                </td>
              </tr>
            </tbody>
          {{/if}}
        {{/list-table}}
      </div>
    {{/if}}
  {{else}}
    <div data-test-not-running class="empty-message">
      <h3 data-test-not-running-headline class="empty-message-headline">Task is not Running</h3>
      <p data-test-not-running-body class="empty-message-body">
        Cannot access files of a task that is not running.
      </p>
    </div>
  {{/if}}
</section>