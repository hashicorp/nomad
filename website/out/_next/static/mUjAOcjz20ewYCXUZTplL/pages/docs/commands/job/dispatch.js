(window.webpackJsonp=window.webpackJsonp||[]).push([[93],{CqFX:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/commands/job/dispatch",function(){return t("GtWM")}])},GtWM:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return p}));var n=t("wx14"),i=t("Ff2n"),c=t("q1tI"),s=t.n(c),b=t("7ljp"),r=t("j1un"),l=(s.a.createElement,{}),o=Object(r.a)({layout:"docs",page_title:"Commands: job dispatch",sidebar_title:"dispatch",description:"The dispatch command is used to create an instance of a parameterized job.\n",__resourcePath:"docs/commands/job/dispatch.mdx",__scans:{}});function p(e){var a=e.components,t=Object(i.a)(e,["components"]);return Object(b.b)(o,Object(n.a)({},l,t,{components:a,mdxType:"MDXLayout"}),Object(b.b)("h1",{className:"g-type-display-2"},Object(b.b)("a",Object(n.a)({parentName:"h1"},{className:"__permalink-h",href:"#command-job-dispatch","aria-label":"command job dispatch permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h1"},{className:"__target-h",id:"command-job-dispatch","aria-hidden":""})),"Command: job dispatch"),Object(b.b)("p",null,"The ",Object(b.b)("inlineCode",{parentName:"p"},"job dispatch")," command is used to create new instances of a ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/job-specification/parameterized",title:"Nomad parameterized Job Specification"}),"parameterized\njob"),". The parameterized job captures a job's configuration and runtime\nrequirements in a generic way and ",Object(b.b)("inlineCode",{parentName:"p"},"dispatch")," is used to provide the input for\nthe job to run against. A parameterized job is similar to a function definition,\nand dispatch is used to invoke the function."),Object(b.b)("p",null,"Each time a job is dispatched, a unique job ID is generated. This allows a\ncaller to track the status of the job, much like a future or promise in some\nprogramming languages."),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#usage","aria-label":"usage permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"usage","aria-hidden":""})),"Usage"),Object(b.b)("pre",{className:"language-plaintext"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-plaintext"}),"nomad job dispatch [options] <parameterized job> [input source]\n")),Object(b.b)("p",null,'Dispatch creates an instance of a parameterized job. A data payload to the\ndispatched instance can be provided via stdin by using "-" for the input source\nor by specifying a path to a file. Metadata can be supplied by using the meta\nflag one or more times.'),Object(b.b)("p",null,"The payload has a ",Object(b.b)("strong",{parentName:"p"},"size limit of 16KiB"),"."),Object(b.b)("p",null,"Upon successful creation, the dispatched job ID will be printed and the\ntriggered evaluation will be monitored. This can be disabled by supplying the\ndetach flag."),Object(b.b)("p",null,"On successful job submission and scheduling, exit code 0 will be returned. If\nthere are job placement issues encountered (unsatisfiable constraints, resource\nexhaustion, etc), then the exit code will be 2. Any other errors, including\nclient connection issues or internal errors, are indicated by exit code 1."),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#general-options","aria-label":"general options permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"general-options","aria-hidden":""})),"General Options"),Object(b.b)("ul",null,Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"address",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#address","aria-label":"address permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-address=<addr>")),": The address of the Nomad server. Overrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_ADDR"),"\nenvironment variable if set. Defaults to ",Object(b.b)("inlineCode",{parentName:"p"},"http://127.0.0.1:4646"),".")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"region",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#region","aria-label":"region permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-region=<region>")),": The region of the Nomad server to forward commands to.\nOverrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_REGION")," environment variable if set. Defaults to the\nAgent's local region.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"namespace",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#namespace","aria-label":"namespace permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-namespace=<namespace>")),": The target namespace for queries and actions bound\nto a namespace. Overrides the NOMAD_NAMESPACE environment variable if set.\nIf set to '*', job and alloc subcommands query all namespacecs authorized to\nuser. Defaults to the \"default\" namespace.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"no-color",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#no-color","aria-label":"no color permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-no-color")),": Disables colored command output. Alternatively,\n",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_CLI_NO_COLOR")," may be set.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"ca-cert",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#ca-cert","aria-label":"ca cert permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-ca-cert=<path>")),": Path to a PEM encoded CA cert file to use to verify the\nNomad server SSL certificate. Overrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_CACERT")," environment\nvariable if set.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"ca-path",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#ca-path","aria-label":"ca path permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-ca-path=<path>")),": Path to a directory of PEM encoded CA cert files to verify\nthe Nomad server SSL certificate. If both ",Object(b.b)("inlineCode",{parentName:"p"},"-ca-cert")," and ",Object(b.b)("inlineCode",{parentName:"p"},"-ca-path")," are\nspecified, ",Object(b.b)("inlineCode",{parentName:"p"},"-ca-cert")," is used. Overrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_CAPATH")," environment\nvariable if set.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"client-cert",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#client-cert","aria-label":"client cert permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-client-cert=<path>")),": Path to a PEM encoded client certificate for TLS\nauthentication to the Nomad server. Must also specify ",Object(b.b)("inlineCode",{parentName:"p"},"-client-key"),". Overrides\nthe ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_CLIENT_CERT")," environment variable if set.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"client-key",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#client-key","aria-label":"client key permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-client-key=<path>")),": Path to an unencrypted PEM encoded private key matching\nthe client certificate from ",Object(b.b)("inlineCode",{parentName:"p"},"-client-cert"),". Overrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_CLIENT_KEY"),"\nenvironment variable if set.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"tls-server-name",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#tls-server-name","aria-label":"tls server name permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-tls-server-name=<value>")),": The server name to use as the SNI host when connecting\nvia TLS. Overrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_TLS_SERVER_NAME")," environment variable if set.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"tls-skip-verify",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#tls-skip-verify","aria-label":"tls skip verify permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-tls-skip-verify")),": Do not verify TLS certificate. This is highly not\nrecommended. Verification will also be skipped if ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_SKIP_VERIFY")," is set.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"token",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#token","aria-label":"token permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-token")),": The SecretID of an ACL token to use to authenticate API requests with.\nOverrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_TOKEN")," environment variable if set."))),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#dispatch-options","aria-label":"dispatch options permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"dispatch-options","aria-hidden":""})),"Dispatch Options"),Object(b.b)("ul",null,Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"meta",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#meta","aria-label":"meta permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-meta")),': Meta takes a key/value pair separated by "=". The metadata key will\nbe merged into the job\'s metadata. The job may define a default value for the\nkey which is overridden when dispatching. The flag can be provided more than\nonce to inject multiple metadata key/value pairs. Arbitrary keys are not\nallowed. The parameterized job must allow the key to be merged.')),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"detach",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#detach","aria-label":"detach permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-detach")),": Return immediately instead of monitoring. A new evaluation ID\nwill be output, which can be used to examine the evaluation using the\n",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/commands/eval-status"}),"eval status")," command")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"verbose",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#verbose","aria-label":"verbose permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-verbose")),": Show full information."))),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#examples","aria-label":"examples permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"examples","aria-hidden":""})),"Examples"),Object(b.b)("p",null,'Dispatch against a parameterized job with the ID "video-encode" and\npassing in a configuration payload via stdin:'),Object(b.b)("pre",{className:"language-shell-session"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell-session"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token command"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token sh important"}),"$")," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token bash language-bash"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token function"}),"cat")," ")),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token output"}),'<< EOF | nomad job dispatch video-encode -\n{\n  "s3-input": "https://video-bucket.s3-us-west-1.amazonaws.com/cb31dabb1",\n  "s3-output": "https://video-bucket.s3-us-west-1.amazonaws.com/a149adbe3",\n  "input-codec": "mp4",\n  "output-codec": "webm",\n  "quality": "1080p"\n}\nEOF\nDispatched Job ID = video-encode/dispatch-1485379325-cb38d00d\nEvaluation ID     = 31199841\n\n==> Monitoring evaluation "31199841"\n    Evaluation triggered by job "example/dispatch-1485379325-cb38d00d"\n    Allocation "8254b85f" created: node "82ff9c50", group "cache"\n    Evaluation status changed: "pending" -> "complete"\n==> Evaluation "31199841" finished with status "complete"\n'))),Object(b.b)("p",null,'Dispatch against a parameterized job with the ID "video-encode" and\npassing in a configuration payload via a file:'),Object(b.b)("pre",{className:"language-shell-session"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell-session"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token command"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token sh important"}),"$")," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token bash language-bash"}),"nomad job dispatch video-encode video-config.json")),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token output"}),'Dispatched Job ID = video-encode/dispatch-1485379325-cb38d00d\nEvaluation ID     = 31199841\n\n==> Monitoring evaluation "31199841"\n    Evaluation triggered by job "example/dispatch-1485379325-cb38d00d"\n    Allocation "8254b85f" created: node "82ff9c50", group "cache"\n    Evaluation status changed: "pending" -> "complete"\n==> Evaluation "31199841" finished with status "complete"\n'))),Object(b.b)("p",null,'Dispatch against a parameterized job with the ID "video-encode" using the detach\nflag:'),Object(b.b)("pre",{className:"language-shell-session"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell-session"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token command"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token sh important"}),"$")," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token bash language-bash"}),"nomad job dispatch -detach video-encode video-config.json")),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token output"}),"Dispatched Job ID = example/dispatch-1485380684-c37b3dba\nEvaluation ID     = d9034c4e\n"))))}p.isMDXComponent=!0}},[["CqFX",0,1,2,4,3,5,6]]]);