(window.webpackJsonp=window.webpackJsonp||[]).push([[194],{"2sus":function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/drivers/raw_exec",function(){return t("8XAC")}])},"8XAC":function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return p}));var n=t("wx14"),r=t("Ff2n"),c=t("q1tI"),i=t.n(c),b=t("7ljp"),l=t("j1un"),s=(i.a.createElement,{}),o=Object(l.a)({layout:"docs",page_title:"Drivers: Raw Exec",sidebar_title:"Raw Fork/Exec",description:"The Raw Exec task driver simply fork/execs and provides no isolation.",__resourcePath:"docs/drivers/raw_exec.mdx",__scans:{}});function p(e){var a=e.components,t=Object(r.a)(e,["components"]);return Object(b.b)(o,Object(n.a)({},s,t,{components:a,mdxType:"MDXLayout"}),Object(b.b)("h1",{className:"g-type-display-2"},Object(b.b)("a",Object(n.a)({parentName:"h1"},{className:"__permalink-h",href:"#raw-fork-exec-driver","aria-label":"raw fork exec driver permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h1"},{className:"__target-h",id:"raw-fork-exec-driver","aria-hidden":""})),"Raw Fork/Exec Driver"),Object(b.b)("p",null,"Name: ",Object(b.b)("inlineCode",{parentName:"p"},"raw_exec")),Object(b.b)("p",null,"The ",Object(b.b)("inlineCode",{parentName:"p"},"raw_exec")," driver is used to execute a command for a task without any\nisolation. Further, the task is started as the same user as the Nomad process.\nAs such, it should be used with extreme care and is disabled by default."),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#task-configuration","aria-label":"task configuration permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"task-configuration","aria-hidden":""})),"Task Configuration"),Object(b.b)("pre",{className:"language-hcl"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),"task ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"webservice"')," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"driver")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"raw_exec"'),"\n\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"command")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"my-binary"'),"\n    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"args"),"    ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"-flag"'),", ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"1"'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n  ",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(b.b)("p",null,"The ",Object(b.b)("inlineCode",{parentName:"p"},"raw_exec")," driver supports the following configuration in the job spec:"),Object(b.b)("ul",null,Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"command",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#command","aria-label":"command permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"command"))," - The command to execute. Must be provided. If executing a binary\nthat exists on the host, the path must be absolute. If executing a binary that\nis downloaded from an ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/job-specification/artifact"}),Object(b.b)("inlineCode",{parentName:"a"},"artifact")),", the\npath can be relative from the allocation's root directory.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"args",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#args","aria-label":"args permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"args"))," - (Optional) A list of arguments to the ",Object(b.b)("inlineCode",{parentName:"p"},"command"),". References\nto environment variables or any ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/runtime/interpolation"}),"interpretable Nomad\nvariables")," will be interpreted before\nlaunching the task."))),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#examples","aria-label":"examples permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"examples","aria-hidden":""})),"Examples"),Object(b.b)("p",null,"To run a binary present on the Node:"),Object(b.b)("pre",null,Object(b.b)("code",Object(n.a)({parentName:"pre"},{}),'task "example" {\n  driver = "raw_exec"\n\n  config {\n    # When running a binary that exists on the host, the path must be absolute/\n    command = "/bin/sleep"\n    args    = ["1"]\n  }\n}\n')),Object(b.b)("p",null,"To execute a binary downloaded from an ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/job-specification/artifact"}),Object(b.b)("inlineCode",{parentName:"a"},"artifact")),":"),Object(b.b)("pre",null,Object(b.b)("code",Object(n.a)({parentName:"pre"},{}),'task "example" {\n  driver = "raw_exec"\n\n  config {\n    command = "name-of-my-binary"\n  }\n\n  artifact {\n    source = "https://internal.file.server/name-of-my-binary"\n    options {\n      checksum = "sha256:abd123445ds4555555555"\n    }\n  }\n}\n')),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#capabilities","aria-label":"capabilities permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"capabilities","aria-hidden":""})),"Capabilities"),Object(b.b)("p",null,"The ",Object(b.b)("inlineCode",{parentName:"p"},"raw_exec")," driver implements the following ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/internals/plugins/task-drivers#capabilities-capabilities-error"}),"capabilities"),"."),Object(b.b)("table",null,Object(b.b)("thead",{parentName:"table"},Object(b.b)("tr",{parentName:"thead"},Object(b.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Feature"),Object(b.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Implementation"))),Object(b.b)("tbody",{parentName:"table"},Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(b.b)("inlineCode",{parentName:"td"},"nomad alloc signal")),Object(b.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"true")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(b.b)("inlineCode",{parentName:"td"},"nomad alloc exec")),Object(b.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"true")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"filesystem isolation"),Object(b.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"none")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"network isolation"),Object(b.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"host, group")),Object(b.b)("tr",{parentName:"tbody"},Object(b.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"volume mounting"),Object(b.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"none")))),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#client-requirements","aria-label":"client requirements permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"client-requirements","aria-hidden":""})),"Client Requirements"),Object(b.b)("p",null,"The ",Object(b.b)("inlineCode",{parentName:"p"},"raw_exec")," driver can run on all supported operating systems. For security\nreasons, it is disabled by default. To enable raw exec, the Nomad client\nconfiguration must explicitly enable the ",Object(b.b)("inlineCode",{parentName:"p"},"raw_exec")," driver in the plugin's options:"),Object(b.b)("pre",null,Object(b.b)("code",Object(n.a)({parentName:"pre"},{}),'plugin "raw_exec" {\n  config {\n    enabled = true\n  }\n}\n')),Object(b.b)("p",null,"Nomad versions before v0.9 use the following client configuration. This configuration is\nalso supported in Nomad v0.9.0, but is deprecated in favor of the plugin stanza:"),Object(b.b)("pre",null,Object(b.b)("code",Object(n.a)({parentName:"pre"},{}),'client {\n  options = {\n    "driver.raw_exec.enable" = "1"\n  }\n}\n')),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#plugin-options","aria-label":"plugin options permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"plugin-options","aria-hidden":""})),"Plugin Options"),Object(b.b)("ul",null,Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"enabled",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#enabled","aria-label":"enabled permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"enabled"))," - Specifies whether the driver should be enabled or disabled.\nDefaults to ",Object(b.b)("inlineCode",{parentName:"p"},"false"),".")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"no_cgroups",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#no_cgroups","aria-label":"no_cgroups permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"no_cgroups"))," - Specifies whether the driver should not use\ncgroups to manage the process group launched by the driver. By default,\ncgroups are used to manage the process tree to ensure full cleanup of all\nprocesses started by the task. The driver uses cgroups by default on\nLinux and when ",Object(b.b)("inlineCode",{parentName:"p"},"/sys/fs/cgroup/freezer/nomad")," is writable for the\nNomad process. Using a cgroup significantly reduces Nomad's CPU\nusage when collecting process metrics."))),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#client-options","aria-label":"client options permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"client-options","aria-hidden":""})),"Client Options"),Object(b.b)("div",{className:"alert alert-warning g-type-body",role:"alert"},Object(b.b)("p",{parentName:"div"},"Note: client configuration options will soon be deprecated. Please use\n",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#plugin-options"}),"plugin options")," instead. See the ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/configuration/plugin"}),"plugin stanza")," documentation for more information.")),Object(b.b)("ul",null,Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"driver-raw_exec-enable",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#driver-raw_exec-enable","aria-label":"driver raw_exec enable permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"driver.raw_exec.enable"))," - Specifies whether the driver should be enabled or\ndisabled. Defaults to ",Object(b.b)("inlineCode",{parentName:"p"},"false"),".")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"driver-raw_exec-no_cgroups",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#driver-raw_exec-no_cgroups","aria-label":"driver raw_exec no_cgroups permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"driver.raw_exec.no_cgroups"))," - Specifies whether the driver should not use\ncgroups to manage the process group launched by the driver. By default,\ncgroups are used to manage the process tree to ensure full cleanup of all\nprocesses started by the task. The driver only uses cgroups when Nomad is\nlaunched as root, on Linux and when cgroups are detected."))),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#client-attributes","aria-label":"client attributes permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"client-attributes","aria-hidden":""})),"Client Attributes"),Object(b.b)("p",null,"The ",Object(b.b)("inlineCode",{parentName:"p"},"raw_exec")," driver will set the following client attributes:"),Object(b.b)("ul",null,Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"driver-raw_exec",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(n.a)({parentName:"li"},{href:"#driver-raw_exec","aria-label":"driver raw_exec permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"driver.raw_exec")),' - This will be set to "1", indicating the driver is available.')),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#resource-isolation","aria-label":"resource isolation permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"resource-isolation","aria-hidden":""})),"Resource Isolation"),Object(b.b)("p",null,"The ",Object(b.b)("inlineCode",{parentName:"p"},"raw_exec")," driver provides no isolation."),Object(b.b)("p",null,"If the launched process creates a new process group, it is possible that Nomad\nwill leak processes on shutdown unless the application forwards signals\nproperly. Nomad will not leak any processes if cgroups are being used to manage\nthe process tree. Cgroups are used on Linux when Nomad is being run with\nappropriate privileges, the cgroup system is mounted and the operator hasn't\ndisabled cgroups for the driver."))}p.isMDXComponent=!0}},[["2sus",0,1,2,4,3,5,6]]]);