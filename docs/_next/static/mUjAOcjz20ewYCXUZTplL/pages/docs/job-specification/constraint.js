(window.webpackJsonp=window.webpackJsonp||[]).push([[227],{eK1R:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/job-specification/constraint",function(){return t("kjQQ")}])},kjQQ:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return j}));var n,c=t("wx14"),s=t("Ff2n"),b=t("q1tI"),p=t.n(b),o=t("7ljp"),r=t("j1un"),i=(p.a.createElement,n="Placement",function(e){return console.warn("Component "+n+" was not imported, exported, or provided by MDXProvider as global scope"),Object(o.b)("div",e)}),m={},l=Object(r.a)({layout:"docs",page_title:"constraint Stanza - Job Specification",sidebar_title:"constraint",description:'The "constraint" stanza allows restricting the set of eligible nodes.\nConstraints may filter on attributes or metadata. Additionally constraints may\nbe specified at the job, group, or task levels for ultimate flexibility.',__resourcePath:"docs/job-specification/constraint.mdx",__scans:{}});function j(e){var a=e.components,t=Object(s.a)(e,["components"]);return Object(o.b)(l,Object(c.a)({},m,t,{components:a,mdxType:"MDXLayout"}),Object(o.b)("h1",{className:"g-type-display-2"},Object(o.b)("a",Object(c.a)({parentName:"h1"},{className:"__permalink-h",href:"#constraint-stanza","aria-label":"constraint stanza permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h1"},{className:"__target-h",id:"constraint-stanza","aria-hidden":""})),Object(o.b)("inlineCode",{parentName:"h1"},"constraint")," Stanza"),Object(o.b)(i,{groups:[["job","constraint"],["job","group","constraint"],["job","group","task","constraint"]],mdxType:"Placement"}),Object(o.b)("p",null,"The ",Object(o.b)("inlineCode",{parentName:"p"},"constraint")," allows restricting the set of eligible nodes. Constraints may\nfilter on ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/runtime/interpolation",title:"Nomad interpolation"}),"attributes")," or ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/configuration/client#custom-metadata-network-speed-and-node-class",title:"Nomad Custom Metadata, Network Speed, and Node Class"}),"client metadata"),".\nAdditionally constraints may be specified at the ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/job",title:"Nomad job Job Specification"}),"job"),", ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/group",title:"Nomad group Job Specification"}),"group"),", or\n",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/task",title:"Nomad task Job Specification"}),"task")," levels for ultimate flexibility."),Object(o.b)("div",{className:"alert alert-warning g-type-body",role:"alert"},Object(o.b)("p",{parentName:"div"},"",Object(o.b)("strong",{parentName:"p"},"It is possible to define irreconcilable constraints in a job."),"\nFor example, because all ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/job-specification/group",title:"Nomad group Job Specification"}),"tasks within a group are scheduled on the same client node"),",\nspecifying different ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/runtime/interpolation#node-variables-",title:"Nomad interpolation-Node variables"}),Object(o.b)("inlineCode",{parentName:"a"},"${attr.unique.hostname}"))," constraints at\nthe task level will cause a job to be unplaceable.")),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),"job ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"docs"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token comment"}),"# All tasks in this job must run on linux."),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"attribute")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"',Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token interpolation"}),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"{"),"attr",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"kernel",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"name",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"value"),"     ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"linux"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  group ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"example"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token comment"}),"# All groups in this job should be scheduled on different hosts."),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"operator"),"  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"distinct_hosts"'),"\n      ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"value"),"     ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"true"'),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n    task ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"server"')," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token comment"}),'# All tasks must run where "my_custom_value" is greater than 3.'),"\n      ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"attribute")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"',Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token interpolation"}),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"{"),"meta",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"my_custom_value",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),"\n        ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"operator"),"  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'">"'),"\n        ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"value"),"     ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"3"'),"\n      ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("p",null,"Placing constraints at both the job level and at the group level is redundant\nsince constraints are applied hierarchically. The job constraints will affect\nall groups (and tasks) in the job."),Object(o.b)("h2",{className:"g-type-display-3"},Object(o.b)("a",Object(c.a)({parentName:"h2"},{className:"__permalink-h",href:"#constraint-parameters","aria-label":"constraint parameters permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h2"},{className:"__target-h",id:"constraint-parameters","aria-hidden":""})),Object(o.b)("inlineCode",{parentName:"h2"},"constraint")," Parameters"),Object(o.b)("ul",null,Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"attribute",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#attribute","aria-label":"attribute permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"attribute"))," ",Object(o.b)("inlineCode",{parentName:"p"},'(string: "")')," - Specifies the name or reference of the attribute\nto examine for the constraint. This can be any of the ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/runtime/interpolation#interpreted_node_vars"}),"Nomad interpolated\nvalues"),".")),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"operator",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#operator","aria-label":"operator permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"operator"))," ",Object(o.b)("inlineCode",{parentName:"p"},'(string: "=")')," - Specifies the comparison operator. The ordering is\ncompared lexically. Possible values include:"),Object(o.b)("pre",Object(c.a)({parentName:"li"},{className:"language-text"}),Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-text"}),"=\n!=\n>\n>=\n<\n<=\ndistinct_hosts\ndistinct_property\nregexp\nset_contains\nversion\nsemver\nis_set\nis_not_set\n")),Object(o.b)("p",{parentName:"li"},"For a detailed explanation of these values and their behavior, please see\nthe ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#operator-values"}),"operator values section"),".")),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"value",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#value","aria-label":"value permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},"value"))," ",Object(o.b)("inlineCode",{parentName:"p"},'(string: "")')," - Specifies the value to compare the attribute against\nusing the specified operation. This can be a literal value, another attribute,\nor any ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/runtime/interpolation#interpreted_node_vars"}),"Nomad interpolated\nvalues"),"."))),Object(o.b)("h3",{className:"g-type-display-4"},Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__permalink-h",href:"#operator-values","aria-label":"operator values permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__target-h",id:"operator-values","aria-hidden":""})),Object(o.b)("inlineCode",{parentName:"h3"},"operator")," Values"),Object(o.b)("p",null,'This section details the specific values for the "operator" parameter in the\nNomad job specification for constraints. The operator is always specified as a\nstring, but the string can take on different values which change the behavior of\nthe overall constraint evaluation.'),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"operator")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"..."'),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("ul",null,Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"distinct_hosts",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#distinct_hosts","aria-label":"distinct_hosts permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},'"distinct_hosts"'))," - Instructs the scheduler to not co-locate any groups on\nthe same machine. When specified as a job constraint, it applies to all groups\nin the job. When specified as a group constraint, the effect is constrained to\nthat group. This constraint can not be specified at the task level. Note that\nthe ",Object(o.b)("inlineCode",{parentName:"p"},"attribute")," parameter should be omitted when using this constraint."),Object(o.b)("pre",Object(c.a)({parentName:"li"},{className:"language-hcl"}),Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"operator"),"  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"distinct_hosts"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"value"),"     ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"true"'),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("p",{parentName:"li"},"The constraint may also be specified as follows for a more compact\nrepresentation:"),Object(o.b)("pre",Object(c.a)({parentName:"li"},{className:"language-hcl"}),Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"distinct_hosts")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token boolean"}),"true"),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"distinct_property",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#distinct_property","aria-label":"distinct_property permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},'"distinct_property"'))," - Instructs the scheduler to select nodes that have a\ndistinct value of the specified property. The ",Object(o.b)("inlineCode",{parentName:"p"},"value")," parameter specifies how\nmany allocations are allowed to share the value of a property. The ",Object(o.b)("inlineCode",{parentName:"p"},"value"),"\nmust be 1 or greater and if omitted, defaults to 1. When specified as a job\nconstraint, it applies to all groups in the job. When specified as a group\nconstraint, the effect is constrained to that group. This constraint can not\nbe specified at the task level."),Object(o.b)("pre",Object(c.a)({parentName:"li"},{className:"language-hcl"}),Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"operator"),"  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"distinct_property"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"attribute")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"',Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token interpolation"}),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"{"),"meta",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"rack",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"value"),"     ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"3"'),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("p",{parentName:"li"},"The constraint may also be specified as follows for a more compact\nrepresentation:"),Object(o.b)("pre",Object(c.a)({parentName:"li"},{className:"language-hcl"}),Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"distinct_property")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"',Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token interpolation"}),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"{"),"meta",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"rack",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"value"),"     ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"3"'),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"regexp",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#regexp","aria-label":"regexp permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},'"regexp"'))," - Specifies a regular expression constraint against the attribute.\nThe syntax of the regular expressions accepted is the same general syntax used\nby Perl, Python, and many other languages. More precisely, it is the syntax\naccepted by RE2 and described at in the ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"https://golang.org/s/re2syntax"}),"Google RE2\nsyntax"),"."),Object(o.b)("pre",Object(c.a)({parentName:"li"},{className:"language-hcl"}),Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"attribute")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"..."'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"operator"),"  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"regexp"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"value"),"     ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"[a-z0-9]"'),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"set_contains",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#set_contains","aria-label":"set_contains permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},'"set_contains"'))," - Specifies a contains constraint against the attribute. The\nattribute and the list being checked are split using commas. This will check\nthat the given attribute contains ",Object(o.b)("strong",{parentName:"p"},"all")," of the specified elements."),Object(o.b)("pre",Object(c.a)({parentName:"li"},{className:"language-hcl"}),Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"attribute")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"..."'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"operator"),"  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"set_contains"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"value"),"     ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"a,b,c"'),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"version",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#version","aria-label":"version permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},'"version"'))," - Specifies a version constraint against the attribute. This\nsupports a comma-separated list of constraints, including the pessimistic\noperator. ",Object(o.b)("inlineCode",{parentName:"p"},"version")," will not consider a prerelease (eg ",Object(o.b)("inlineCode",{parentName:"p"},"1.6.0-beta"),")\nsufficient to match a non-prerelease constraint (eg ",Object(o.b)("inlineCode",{parentName:"p"},">= 1.0"),"). Use the\n",Object(o.b)("inlineCode",{parentName:"p"},"semver")," constraint for strict ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"https://semver.org/spec/v2.0.0.html",title:"Semantic Versioning 2.0"}),"Semantic Versioning 2.0")," ordering.\nFor more examples please see the ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"https://github.com/hashicorp/go-version"}),"go-version\nrepository")," for more specific\nexamples."),Object(o.b)("pre",Object(c.a)({parentName:"li"},{className:"language-hcl"}),Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"attribute")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"..."'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"operator"),"  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"version"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"value"),"     ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'">= 0.1.0, < 0.2"'),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"semver",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#semver","aria-label":"semver permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},'"semver"'))," - Specifies a version constraint against the attribute. Only\n",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"https://semver.org/spec/v2.0.0.html",title:"Semantic Versioning 2.0"}),"Semantic Versioning 2.0")," compliant versions and comparison\noperators are supported, so there is no pessimistic operator. Unlike ",Object(o.b)("inlineCode",{parentName:"p"},"version"),",\nthis operator considers prereleases (eg ",Object(o.b)("inlineCode",{parentName:"p"},"1.6.0-beta"),") sufficient to satisfy\nnon-prerelease constraints (eg ",Object(o.b)("inlineCode",{parentName:"p"},">= 1.0"),"). ",Object(o.b)("em",{parentName:"p"},"Added in Nomad v0.10.2.")),Object(o.b)("pre",Object(c.a)({parentName:"li"},{className:"language-hcl"}),Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"attribute")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"..."'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"operator"),"  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"semver"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"value"),"     ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'">= 0.1.0, < 0.2"'),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"is_set",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#is_set","aria-label":"is_set permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},'"is_set"'))," - Specifies that a given attribute must be present. This can be\ncombined with the ",Object(o.b)("inlineCode",{parentName:"p"},'"!="')," operator to require that an attribute has been set\nbefore checking for equality. The default behavior for ",Object(o.b)("inlineCode",{parentName:"p"},'"!="')," is to include\nnodes that don't have that attribute set.")),Object(o.b)("li",Object(c.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(o.b)("a",Object(c.a)({parentName:"li"},{id:"is_not_set",className:"__target-lic","aria-hidden":""})),Object(o.b)("p",{parentName:"li"},Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"#is_not_set","aria-label":"is_not_set permalink",className:"__permalink-lic"}),Object(o.b)("inlineCode",{parentName:"a"},'"is_not_set"'))," - Specifies that a given attribute must not be present."))),Object(o.b)("h2",{className:"g-type-display-3"},Object(o.b)("a",Object(c.a)({parentName:"h2"},{className:"__permalink-h",href:"#constraint-examples","aria-label":"constraint examples permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h2"},{className:"__target-h",id:"constraint-examples","aria-hidden":""})),Object(o.b)("inlineCode",{parentName:"h2"},"constraint")," Examples"),Object(o.b)("p",null,"The following examples only show the ",Object(o.b)("inlineCode",{parentName:"p"},"constraint")," stanzas. Remember that the\n",Object(o.b)("inlineCode",{parentName:"p"},"constraint")," stanza is only valid in the placements listed above."),Object(o.b)("h3",{className:"g-type-display-4"},Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__permalink-h",href:"#kernel-data","aria-label":"kernel data permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__target-h",id:"kernel-data","aria-hidden":""})),"Kernel Data"),Object(o.b)("p",null,'This example restricts the task to running on nodes which have a kernel version\nhigher than "3.19".'),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"attribute")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"',Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token interpolation"}),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"{"),"attr",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"kernel",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"version",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"operator"),"  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"version"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"value"),"     ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"> 3.19"'),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("h3",{className:"g-type-display-4"},Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__permalink-h",href:"#distinct-property","aria-label":"distinct property permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__target-h",id:"distinct-property","aria-hidden":""})),"Distinct Property"),Object(o.b)("p",null,"A potential use case of the ",Object(o.b)("inlineCode",{parentName:"p"},"distinct_property")," constraint is to spread a\nservice with ",Object(o.b)("inlineCode",{parentName:"p"},"count > 1")," across racks to minimize correlated failure. Nodes can\nbe annotated with which rack they are on using ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/configuration/client#custom-metadata-network-speed-and-node-class",title:"Nomad Custom Metadata, Network Speed, and Node Class"}),"custom client\nmetadata"),' with values such as "rack-12-1", "rack-12-2", etc.\nThe following constraint would assure that an individual rack is not running\nmore than 2 instances of the task group.'),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"distinct_property")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"',Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token interpolation"}),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"{"),"meta",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"rack",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"value")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"2"'),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("h3",{className:"g-type-display-4"},Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__permalink-h",href:"#operating-systems","aria-label":"operating systems permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__target-h",id:"operating-systems","aria-hidden":""})),"Operating Systems"),Object(o.b)("p",null,"This example restricts the task to running on nodes that are running Ubuntu\n14.04"),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"attribute")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"',Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token interpolation"}),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"{"),"attr",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"os",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"name",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"value"),"     ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"ubuntu"'),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"attribute")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"',Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token interpolation"}),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"{"),"attr",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"os",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"version",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"value"),"     ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"14.04"'),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("h3",{className:"g-type-display-4"},Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__permalink-h",href:"#cloud-metadata","aria-label":"cloud metadata permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__target-h",id:"cloud-metadata","aria-hidden":""})),"Cloud Metadata"),Object(o.b)("p",null,"When possible, Nomad populates node attributes from the cloud environment. These\nvalues are accessible as filters in constraints. This example constrains this\ntask to only run on nodes that are memory-optimized on AWS."),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"attribute")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"',Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token interpolation"}),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"{"),"attr",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"platform",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"aws",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"instance-type",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"value"),"     ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"m4.xlarge"'),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(o.b)("h3",{className:"g-type-display-4"},Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__permalink-h",href:"#user-specified-metadata","aria-label":"user specified metadata permalink"}),"\xbb"),Object(o.b)("a",Object(c.a)({parentName:"h3"},{className:"__target-h",id:"user-specified-metadata","aria-hidden":""})),"User-Specified Metadata"),Object(o.b)("p",null,"This example restricts the task to running on nodes where the binaries for\nredis, cypress, and nginx are all cached locally. This particular example is\nutilizing ",Object(o.b)("a",Object(c.a)({parentName:"p"},{href:"/docs/configuration/client#custom-metadata-network-speed-and-node-class",title:"Nomad Custom Metadata, Network Speed, and Node Class"}),"custom client metadata"),"."),Object(o.b)("pre",{className:"language-hcl"},Object(o.b)("code",Object(c.a)({parentName:"pre"},{className:"language-hcl"}),Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"attribute"),"    ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"',Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token interpolation"}),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"{"),"meta",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"."),"cached_binaries",Object(o.b)("span",Object(c.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),"\n  ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token property"}),"set_contains")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token string"}),'"redis,cypress,nginx"'),"\n",Object(o.b)("span",Object(c.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")))}j.isMDXComponent=!0}},[["eK1R",0,1,2,4,3,5,6]]]);