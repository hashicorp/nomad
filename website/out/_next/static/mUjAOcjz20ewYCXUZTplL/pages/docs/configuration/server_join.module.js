(window.webpackJsonp=window.webpackJsonp||[]).push([[170],{ZndG:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/configuration/server_join",function(){return t("c86d")}])},c86d:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return d}));var n,r=t("wx14"),i=t("Ff2n"),c=t("q1tI"),l=t.n(c),b=t("7ljp"),s=t("j1un"),o=(l.a.createElement,n="Placement",function(e){return console.warn("Component "+n+" was not imported, exported, or provided by MDXProvider as global scope"),Object(b.b)("div",e)}),p={},m=Object(s.a)({layout:"docs",page_title:"server_join Stanza - Agent Configuration",sidebar_title:"server_join",description:'The "server_join" stanza specifies how the Nomad agent will discover and connect to Nomad servers.',__resourcePath:"docs/configuration/server_join.mdx",__scans:{}});function d(e){var{components:a}=e,t=Object(i.a)(e,["components"]);return Object(b.b)(m,Object(r.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(b.b)("h1",{className:"g-type-display-2"},Object(b.b)("a",Object(r.a)({parentName:"h1"},{className:"__permalink-h",href:"#server_join-stanza","aria-label":"server_join stanza permalink"}),"\xbb"),Object(b.b)("a",Object(r.a)({parentName:"h1"},{className:"__target-h",id:"server_join-stanza","aria-hidden":""})),Object(b.b)("inlineCode",{parentName:"h1"},"server_join")," Stanza"),Object(b.b)(o,{groups:[["server","server_join"],["client","server_join"]],mdxType:"Placement"}),Object(b.b)("p",null,"The ",Object(b.b)("inlineCode",{parentName:"p"},"server_join")," stanza specifies how the Nomad agent will discover and connect\nto Nomad servers."),Object(b.b)("pre",{className:"language-hcl"},Object(b.b)("code",Object(r.a)({parentName:"pre"},{className:"language-hcl"}),Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token keyword"}),"server_join")," ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token property"}),"retry_join")," ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"[")," ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token string"}),'"1.1.1.1"'),", ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token string"}),'"2.2.2.2"')," ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n  ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token property"}),"retry_max")," ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token number"}),"3"),"\n  ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token property"}),"retry_interval")," ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token string"}),'"15s"'),"\n",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(r.a)({parentName:"h2"},{className:"__permalink-h",href:"#server_join-parameters","aria-label":"server_join parameters permalink"}),"\xbb"),Object(b.b)("a",Object(r.a)({parentName:"h2"},{className:"__target-h",id:"server_join-parameters","aria-hidden":""})),Object(b.b)("inlineCode",{parentName:"h2"},"server_join")," Parameters"),Object(b.b)("ul",null,Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"retry_join",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(r.a)({parentName:"p"},{href:"#retry_join","aria-label":"retry_join permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"retry_join"))," ",Object(b.b)("inlineCode",{parentName:"p"},"(array<string>: [])")," - Specifies a list of server addresses to\njoin. This is similar to ",Object(b.b)("a",Object(r.a)({parentName:"p"},{href:"#start_join"}),Object(b.b)("inlineCode",{parentName:"a"},"start_join")),", but will continue to\nbe attempted even if the initial join attempt fails, up to\n",Object(b.b)("a",Object(r.a)({parentName:"p"},{href:"#retry_max"}),"retry_max"),". Further, ",Object(b.b)("inlineCode",{parentName:"p"},"retry_join")," is available to\nboth Nomad servers and clients, while ",Object(b.b)("inlineCode",{parentName:"p"},"start_join")," is only defined for Nomad\nservers. This is useful for cases where we know the address will become\navailable eventually. Use ",Object(b.b)("inlineCode",{parentName:"p"},"retry_join")," with an array as a replacement for\n",Object(b.b)("inlineCode",{parentName:"p"},"start_join"),", ",Object(b.b)("strong",{parentName:"p"},"do not use both options"),"."),Object(b.b)("p",{parentName:"li"},"Address format includes both using IP addresses as well as an interface to the\n",Object(b.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/hashicorp/go-discover"}),"go-discover")," library for doing\nautomated cluster joining using cloud metadata. See the ",Object(b.b)("a",Object(r.a)({parentName:"p"},{href:"#cloud-auto-join"}),"Cloud Auto-join"),"\nsection below for more information."),Object(b.b)("pre",{parentName:"li"},Object(b.b)("code",Object(r.a)({parentName:"pre"},{}),'server_join {\nretry_join = [ "1.1.1.1", "2.2.2.2" ]\n}\n')),Object(b.b)("p",{parentName:"li"},"Using the ",Object(b.b)("inlineCode",{parentName:"p"},"go-discover")," interface, this can be defined both in a client or\nserver configuration as well as provided as a command-line argument."),Object(b.b)("pre",{parentName:"li"},Object(b.b)("code",Object(r.a)({parentName:"pre"},{}),'server_join {\nretry_join = [ "provider=aws tag_key=..." ]\n}\n')),Object(b.b)("p",{parentName:"li"},"See the ",Object(b.b)("a",Object(r.a)({parentName:"p"},{href:"#server-address-format"}),"server address format")," for more information about expected\nserver address formats.")),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"retry_interval",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(r.a)({parentName:"p"},{href:"#retry_interval","aria-label":"retry_interval permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"retry_interval"))," ",Object(b.b)("inlineCode",{parentName:"p"},'(string: "30s")')," - Specifies the time to wait between retry\njoin attempts.")),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"retry_max",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(r.a)({parentName:"p"},{href:"#retry_max","aria-label":"retry_max permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"retry_max"))," ",Object(b.b)("inlineCode",{parentName:"p"},"(int: 0)")," - Specifies the maximum number of join attempts to be\nmade before exiting with a return code of 1. By default, this is set to 0\nwhich is interpreted as infinite retries.")),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"start_join",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(r.a)({parentName:"p"},{href:"#start_join","aria-label":"start_join permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"start_join"))," ",Object(b.b)("inlineCode",{parentName:"p"},"(array<string>: [])")," - Specifies a list of server addresses to\njoin on startup. If Nomad is unable to join with any of the specified\naddresses, agent startup will fail. See the\n",Object(b.b)("a",Object(r.a)({parentName:"p"},{href:"#server-address-format"}),"server address format")," section for more information\non the format of the string. This field is defined only for Nomad servers and\nwill result in a configuration parse error if included in a client\nconfiguration."))),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(r.a)({parentName:"h2"},{className:"__permalink-h",href:"#server-address-format","aria-label":"server address format permalink"}),"\xbb"),Object(b.b)("a",Object(r.a)({parentName:"h2"},{className:"__target-h",id:"server-address-format","aria-hidden":""})),"Server Address Format"),Object(b.b)("p",null,"This section describes the acceptable syntax and format for describing the\nlocation of a Nomad server. There are many ways to reference a Nomad server,\nincluding directly by IP address and resolving through DNS."),Object(b.b)("h3",{className:"g-type-display-4"},Object(b.b)("a",Object(r.a)({parentName:"h3"},{className:"__permalink-h",href:"#directly-via-ip-address","aria-label":"directly via ip address permalink"}),"\xbb"),Object(b.b)("a",Object(r.a)({parentName:"h3"},{className:"__target-h",id:"directly-via-ip-address","aria-hidden":""})),"Directly via IP Address"),Object(b.b)("p",null,"It is possible to address another Nomad server using its IP address. This is\ndone in the ",Object(b.b)("inlineCode",{parentName:"p"},"ip:port")," format, such as:"),Object(b.b)("pre",null,Object(b.b)("code",Object(r.a)({parentName:"pre"},{}),"1.2.3.4:5678\n")),Object(b.b)("p",null,"If the port option is omitted, it defaults to the Serf port, which is 4648\nunless configured otherwise:"),Object(b.b)("pre",null,Object(b.b)("code",Object(r.a)({parentName:"pre"},{}),"1.2.3.4 => 1.2.3.4:4648\n")),Object(b.b)("h3",{className:"g-type-display-4"},Object(b.b)("a",Object(r.a)({parentName:"h3"},{className:"__permalink-h",href:"#via-domains-or-dns","aria-label":"via domains or dns permalink"}),"\xbb"),Object(b.b)("a",Object(r.a)({parentName:"h3"},{className:"__target-h",id:"via-domains-or-dns","aria-hidden":""})),"Via Domains or DNS"),Object(b.b)("p",null,"It is possible to address another Nomad server using its DNS address. This is\ndone in the ",Object(b.b)("inlineCode",{parentName:"p"},"address:port")," format, such as:"),Object(b.b)("pre",null,Object(b.b)("code",Object(r.a)({parentName:"pre"},{}),"nomad-01.company.local:5678\n")),Object(b.b)("p",null,"If the port option is omitted, it defaults to the Serf port, which is 4648\nunless configured otherwise:"),Object(b.b)("pre",null,Object(b.b)("code",Object(r.a)({parentName:"pre"},{}),"nomad-01.company.local => nomad-01.company.local:4648\n")),Object(b.b)("h3",{className:"g-type-display-4"},Object(b.b)("a",Object(r.a)({parentName:"h3"},{className:"__permalink-h",href:"#via-the-go-discover-interface","aria-label":"via the go discover interface permalink"}),"\xbb"),Object(b.b)("a",Object(r.a)({parentName:"h3"},{className:"__target-h",id:"via-the-go-discover-interface","aria-hidden":""})),"Via the go-discover interface"),Object(b.b)("p",null,"As of Nomad 0.8.4, ",Object(b.b)("inlineCode",{parentName:"p"},"retry_join")," accepts a unified interface using the\n",Object(b.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/hashicorp/go-discover"}),"go-discover")," library for doing\nautomated cluster joining using cloud metadata. See ",Object(b.b)("a",Object(r.a)({parentName:"p"},{href:"#cloud_auto_join"}),"Cloud\nAuto-join")," for more information."),Object(b.b)("pre",null,Object(b.b)("code",Object(r.a)({parentName:"pre"},{}),'"provider=aws tag_key=..." => 1.2.3.4:4648\n')),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(r.a)({parentName:"h2"},{className:"__permalink-h",href:"#cloud-auto-join","aria-label":"cloud auto join permalink"}),"\xbb"),Object(b.b)("a",Object(r.a)({parentName:"h2"},{className:"__target-h",id:"cloud-auto-join","aria-hidden":""})),"Cloud Auto-join"),Object(b.b)("p",null,"The following sections describe the Cloud Auto-join ",Object(b.b)("inlineCode",{parentName:"p"},"retry_join")," options that are specific\nto a subset of supported cloud providers. For information on all providers, see further\ndocumentation in ",Object(b.b)("a",Object(r.a)({parentName:"p"},{href:"https://github.com/hashicorp/go-discover"}),"go-discover"),"."),Object(b.b)("h3",{className:"g-type-display-4"},Object(b.b)("a",Object(r.a)({parentName:"h3"},{className:"__permalink-h",href:"#amazon-ec2","aria-label":"amazon ec2 permalink"}),"\xbb"),Object(b.b)("a",Object(r.a)({parentName:"h3"},{className:"__target-h",id:"amazon-ec2","aria-hidden":""})),"Amazon EC2"),Object(b.b)("p",null,"This returns the first private IP address of all servers in the given\nregion which have the given ",Object(b.b)("inlineCode",{parentName:"p"},"tag_key")," and ",Object(b.b)("inlineCode",{parentName:"p"},"tag_value"),"."),Object(b.b)("pre",{className:"language-json"},Object(b.b)("code",Object(r.a)({parentName:"pre"},{className:"language-json"}),Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token property"}),'"retry_join"'),Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token string"}),'"provider=aws tag_key=... tag_value=..."'),Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(b.b)("ul",null,Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"provider",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#provider","aria-label":"provider permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"provider")),' (required) - the name of the provider ("aws" in this case).'),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"tag_key",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#tag_key","aria-label":"tag_key permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"tag_key"))," (required) - the key of the tag to auto-join on."),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"tag_value",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#tag_value","aria-label":"tag_value permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"tag_value"))," (required) - the value of the tag to auto-join on."),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"region",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#region","aria-label":"region permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"region"))," (optional) - the AWS region to authenticate in."),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"addr_type",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#addr_type","aria-label":"addr_type permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"addr_type"))," (optional) - the type of address to discover: ",Object(b.b)("inlineCode",{parentName:"li"},"private_v4"),", ",Object(b.b)("inlineCode",{parentName:"li"},"public_v4"),", ",Object(b.b)("inlineCode",{parentName:"li"},"public_v6"),". Default is ",Object(b.b)("inlineCode",{parentName:"li"},"private_v4"),". (>= 1.0)"),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"access_key_id",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#access_key_id","aria-label":"access_key_id permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"access_key_id"))," (optional) - the AWS access key for authentication (see below for more information about authenticating)."),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"secret_access_key",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#secret_access_key","aria-label":"secret_access_key permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"secret_access_key"))," (optional) - the AWS secret access key for authentication (see below for more information about authenticating).")),Object(b.b)("h4",{className:"g-type-display-5"},Object(b.b)("a",Object(r.a)({parentName:"h4"},{className:"__permalink-h",href:"#authentication-precedence","aria-label":"authentication precedence permalink"}),"\xbb"),Object(b.b)("a",Object(r.a)({parentName:"h4"},{className:"__target-h",id:"authentication-precedence","aria-hidden":""})),"Authentication ","&"," Precedence"),Object(b.b)("ul",null,Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("p",{parentName:"li"},"Static credentials ",Object(b.b)("inlineCode",{parentName:"p"},"access_key_id=... secret_access_key=..."))),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("p",{parentName:"li"},"Environment variables (",Object(b.b)("inlineCode",{parentName:"p"},"AWS_ACCESS_KEY_ID")," and ",Object(b.b)("inlineCode",{parentName:"p"},"AWS_SECRET_ACCESS_KEY"),")")),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("p",{parentName:"li"},"Shared credentials file (",Object(b.b)("inlineCode",{parentName:"p"},"~/.aws/credentials")," or the path specified by ",Object(b.b)("inlineCode",{parentName:"p"},"AWS_SHARED_CREDENTIALS_FILE"),")")),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("p",{parentName:"li"},"ECS task role metadata (container-specific).")),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("p",{parentName:"li"},"EC2 instance role metadata."),Object(b.b)("p",{parentName:"li"},"The only required IAM permission is ",Object(b.b)("inlineCode",{parentName:"p"},"ec2:DescribeInstances"),", and it is\nrecommended that you make a dedicated key used only for auto-joining. If the\nregion is omitted it will be discovered through the local instance's ",Object(b.b)("a",Object(r.a)({parentName:"p"},{href:"http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instance-identity-documents.html"}),"EC2\nmetadata\nendpoint"),"."))),Object(b.b)("h3",{className:"g-type-display-4"},Object(b.b)("a",Object(r.a)({parentName:"h3"},{className:"__permalink-h",href:"#microsoft-azure","aria-label":"microsoft azure permalink"}),"\xbb"),Object(b.b)("a",Object(r.a)({parentName:"h3"},{className:"__target-h",id:"microsoft-azure","aria-hidden":""})),"Microsoft Azure"),Object(b.b)("p",null,"This returns the first private IP address of all servers in the given region\nwhich have the given ",Object(b.b)("inlineCode",{parentName:"p"},"tag_key")," and ",Object(b.b)("inlineCode",{parentName:"p"},"tag_value")," in the tenant and subscription, or in\nthe given ",Object(b.b)("inlineCode",{parentName:"p"},"resource_group")," of a ",Object(b.b)("inlineCode",{parentName:"p"},"vm_scale_set")," for Virtual Machine Scale Sets."),Object(b.b)("pre",{className:"language-json"},Object(b.b)("code",Object(r.a)({parentName:"pre"},{className:"language-json"}),Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token property"}),'"retry_join"'),Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token string"}),'"provider=azure tag_name=... tag_value=... tenant_id=... client_id=... subscription_id=... secret_access_key=..."'),"\n  ",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(b.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(b.b)("ul",null,Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"provider-1",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#provider-1","aria-label":"provider permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"provider")),' (required) - the name of the provider ("azure" in this case).'),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"tenant_id",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#tenant_id","aria-label":"tenant_id permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"tenant_id"))," (required) - the tenant to join machines in."),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"client_id",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#client_id","aria-label":"client_id permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"client_id"))," (required) - the client to authenticate with."),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"secret_access_key-1",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#secret_access_key-1","aria-label":"secret_access_key permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"secret_access_key"))," (required) - the secret client key.")),Object(b.b)("p",null,"Use these configuration parameters when using tags:"),Object(b.b)("ul",null,Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"tag_name",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#tag_name","aria-label":"tag_name permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"tag_name"))," - the name of the tag to auto-join on."),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"tag_value-1",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#tag_value-1","aria-label":"tag_value permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"tag_value"))," - the value of the tag to auto-join on.")),Object(b.b)("p",null,"Use these configuration parameters when using Virtual Machine Scale Sets (Consul 1.0.3 and later):"),Object(b.b)("ul",null,Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"resource_group",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(r.a)({parentName:"p"},{href:"#resource_group","aria-label":"resource_group permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"resource_group"))," - the name of the resource group to filter on.")),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"vm_scale_set",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(r.a)({parentName:"p"},{href:"#vm_scale_set","aria-label":"vm_scale_set permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"vm_scale_set"))," - the name of the virtual machine scale set to filter on."),Object(b.b)("p",{parentName:"li"},"When using tags the only permission needed is the ",Object(b.b)("inlineCode",{parentName:"p"},"ListAll")," method for ",Object(b.b)("inlineCode",{parentName:"p"},"NetworkInterfaces"),". When using\nVirtual Machine Scale Sets the only role action needed is ",Object(b.b)("inlineCode",{parentName:"p"},"Microsoft.Compute/virtualMachineScaleSets/*/read"),"."))),Object(b.b)("h3",{className:"g-type-display-4"},Object(b.b)("a",Object(r.a)({parentName:"h3"},{className:"__permalink-h",href:"#google-compute-engine","aria-label":"google compute engine permalink"}),"\xbb"),Object(b.b)("a",Object(r.a)({parentName:"h3"},{className:"__target-h",id:"google-compute-engine","aria-hidden":""})),"Google Compute Engine"),Object(b.b)("p",null,"This returns the first private IP address of all servers in the given\nproject which have the given ",Object(b.b)("inlineCode",{parentName:"p"},"tag_value"),"."),Object(b.b)("pre",null,Object(b.b)("code",Object(r.a)({parentName:"pre"},{}),'\n```json\n{\n"retry_join": ["provider=gce project_name=... tag_value=..."]\n}\n')),Object(b.b)("ul",null,Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"provider-2",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#provider-2","aria-label":"provider permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"provider")),' (required) - the name of the provider ("gce" in this case).'),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"tag_value-2",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#tag_value-2","aria-label":"tag_value permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"tag_value"))," (required) - the value of the tag to auto-join on."),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"project_name",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#project_name","aria-label":"project_name permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"project_name"))," (optional) - the name of the project to auto-join on. Discovered if not set."),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"zone_pattern",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#zone_pattern","aria-label":"zone_pattern permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"zone_pattern"))," (optional) - the list of zones can be restricted through an RE2 compatible regular expression. If omitted, servers in all zones are returned."),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(r.a)({parentName:"li"},{id:"credentials_file",className:"__target-lic","aria-hidden":""})),Object(b.b)("a",Object(r.a)({parentName:"li"},{href:"#credentials_file","aria-label":"credentials_file permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"credentials_file"))," (optional) - the credentials file for authentication. See below for more information.")),Object(b.b)("h4",{className:"g-type-display-5"},Object(b.b)("a",Object(r.a)({parentName:"h4"},{className:"__permalink-h",href:"#authentication-precedence-1","aria-label":"authentication precedence permalink"}),"\xbb"),Object(b.b)("a",Object(r.a)({parentName:"h4"},{className:"__target-h",id:"authentication-precedence-1","aria-hidden":""})),"Authentication ","&"," Precedence"),Object(b.b)("ul",null,Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),"Use credentials from ",Object(b.b)("inlineCode",{parentName:"li"},"credentials_file"),", if provided."),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),"Use JSON file from ",Object(b.b)("inlineCode",{parentName:"li"},"GOOGLE_APPLICATION_CREDENTIALS")," environment variable."),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),"Use JSON file in a location known to the gcloud command-line tool."),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),"On Windows, this is ",Object(b.b)("inlineCode",{parentName:"li"},"%APPDATA%/gcloud/application_default_credentials.json"),"."),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),"On other systems, ",Object(b.b)("inlineCode",{parentName:"li"},"$HOME/.config/gcloud/application_default_credentials.json"),"."),Object(b.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),"On Google Compute Engine, use credentials from the metadata\nserver. In this final case any provided scopes are ignored.")),Object(b.b)("p",null,"Discovery requires a ",Object(b.b)("a",Object(r.a)({parentName:"p"},{href:"https://cloud.google.com/compute/docs/access/service-accounts"}),"GCE Service\nAccount"),".\nCredentials are searched using the following paths, in order of precedence."))}d.isMDXComponent=!0}},[["ZndG",0,1,2,4,3,5,6]]]);