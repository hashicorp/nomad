---
layout: api
page_title: ACL Binding Rules - HTTP API
description: The /acl/binding-rules endpoints are used to configure and manage ACL binding rules.
---

# ACL Binding Rules HTTP API

The `/acl/binding-rules` and `/acl/binding-rule` endpoints are used to manage ACL Binding Rules.

## Create Binding Rule

This endpoint creates an ACL Binding Rule. The request is always forwarded to the
authoritative region.

| Method | Path                | Produces           |
| ------ | ------------------- | ------------------ |
| `POST` | `/acl/binding-rule` | `application/json` |

The table below shows this endpoint's support for
[blocking queries](/api-docs#blocking-queries) and
[required ACLs](/api-docs#acls).

| Blocking Queries | ACL Required |
| ---------------- | ------------ |
| `NO`             | `management` |

### Parameters

- `Description` `(string: "")` - Human-readable, operator set description that
  can provide additional context about the binding role. This is an operational
  field.

- `AuthMethod` `(string: <required>)` - Name of the auth method for which this
  rule applies to. This is a required field and the method must exist within state
  before the cluster administrator can create the rule.

- `Selector` `(string: "")` - A boolean expression that matches against verified
  identity attributes returned from the auth method during login.  This is
  optional and when not set, provides a catch-all rule.

- `BindType` `(string: <required>)` - Adjusts how this binding rule is applied
  at login time. Valid values are `role` and `policy`.

- `BindName` `(string: <required>)` - Target of the binding. Can be lightly
  templated using HIL ${foo} syntax from available field names. How it is used
  depends on the BindType. 

### Sample Payload

```json
{
  "Description": "example-acl-binding-rule",
  "AuthMethod": "auth0",
  "Selector": "engineering in list.roles",
  "BindType": "role",
  "BindName": "eng-ro",
}
```

### Sample Request

```shell-session
$ curl \
    --request POST \
    --header "X-Nomad-Token: <NOMAD_TOKEN_SECRET_ID>" \
    --data @payload.json \
    https://localhost:4646/v1/acl/binding-rule
```

### Sample Response

```json
{
  "AuthMethod": "auth0",
  "BindName": "eng-ro",
  "BindType": "role",
  "CreateIndex": 16,
  "CreateTime": "2022-12-16T10:29:07.248465Z",
  "Description": "example-acl-binding-rule",
  "ID": "5da76548-1a60-b8fb-f9be-c7736a5bca09",
  "ModifyIndex": 16,
  "ModifyTime": "2022-12-16T10:29:07.248465Z",
  "Selector": "engineering in list.roles"
}
```

## Update Binding Rule

This endpoint updates an existing ACL Binding Rule. The request is always
forwarded to the authoritative region.

| Method | Path                           | Produces           |
| ------ | ------------------------------ | ------------------ |
| `POST` | `/acl/binding-rule/:rule_id` | `application/json` |

The table below shows this endpoint's support for [blocking
queries](/api-docs#blocking-queries) and [required ACLs](/api-docs#acls).

| Blocking Queries | ACL Required |
| ---------------- | ------------ |
| `NO`             | `management` |

### Parameters

- `Description` `(string: "")` - Human-readable, operator set description that
  can provide additional context about the binding role. This is an operational
  field.

- `Selector` `(string: "")` - A boolean expression that matches against verified
  identity attributes returned from the auth method during login.  This is
  optional and when not set, provides a catch-all rule.

- `BindType` `(string: "")` - Adjusts how this binding rule is applied at login
  time. Valid values are `role` and `policy`.

- `BindName` `(string: "")` - Target of the binding. Can be lightly templated
  using HIL ${foo} syntax from available field names. How it is used depends on
  the BindType. 

### Sample Payload

```json
{
  "Name": "example-acl-binding-rule",
  "Type": "OIDC",
  "Tokenlocality": "global",
  "Maxtokenttl": "1h0m0s",
  "Default": true,
  "Config": {
    "OIDCDiscoveryURL": "https://my-corp-app-name.auth0.com/",
    "OIDCClientID": "V1RPi2MYptMV1RPi2MYptMV1RPi2MYpt",
    "OIDCClientSecret": "example-client-secret",
    "BoundAudiences": [
      "V1RPi2MYptMV1RPi2MYptMV1RPi2MYpt"
    ],
    "AllowedRedirectURIs": [
      "http://localhost:4646/oidc/callback"
    ],
    "ClaimMappings": {
      "http://example.com/first_name": "first_name",
      "http://example.com/last_name": "last_name"
    },
    "ListClaimMappings": {
      "http://nomad.com/groups": "groups"
    }
  }
}
```

### Sample Request

```shell-session
$ curl \
    --request POST \
    --header "X-Nomad-Token: <NOMAD_TOKEN_SECRET_ID>" \
    --data @payload.json \
    https://localhost:4646/v1/acl/binding-rule/example-acl-binding-rule
```

### Sample Response

```json
{
    "MaxTokenTTL": "1h0m0s",
    "Name": "example-acl-binding-rule",
    "Type": "OIDC",
    "TokenLocality": "global",
    "Default": true,
    "Config": {
        "OIDCDiscoveryURL": "https://my-corp-app-name.auth0.com/",
        "OIDCClientID": "V1RPi2MYptMV1RPi2MYptMV1RPi2MYpt",
        "OIDCClientSecret": "example-client-secret",
        "BoundAudiences": [
          "V1RPi2MYptMV1RPi2MYptMV1RPi2MYpt"
        ],
        "AllowedRedirectURIs": [
          "http://localhost:4646/oidc/callback"
        ],
        "ClaimMappings": {
          "http://example.com/first_name": "first_name",
          "http://example.com/last_name": "last_name"
        },
        "ListClaimMappings": {
          "http://nomad.com/groups": "groups"
        }
    }
    "CreateTime": "2022-12-08T11:04:43.46206Z",
    "ModifyTime": "2022-12-08T11:04:43.46206Z",
    "CreateIndex": 12,
    "ModifyIndex": 32
}
```

## List Binding Rules

This endpoint lists all ACL Binding Rules. This lists the Binding Rules that have
been replicated to the region, and may lag behind the authoritative region.

| Method | Path                | Produces           |
| ------ | ------------------- | ------------------ |
| `GET`  | `/acl/binding-rules` | `application/json` |

The table below shows this endpoint's support for
[blocking queries](/api-docs#blocking-queries),
[consistency modes](/api-docs#consistency-modes) and
[required ACLs](/api-docs#acls).

| Blocking Queries | Consistency Modes | ACL Required                                                                                                                             |
| ---------------- | ----------------- | ---- |
| `YES`            | `all`             | None |

### Sample Request

```shell-session
$ curl \
    --header "X-Nomad-Token: <NOMAD_TOKEN_SECRET_ID>" \
    https://localhost:4646/v1/acl/binding-rules
```

### Sample Response

```json
[
    {
        "CreateIndex": 12,
        "Default": true,
        "ModifyIndex": 32,
        "Name": "example-acl-binding-rule",
        "Type": "OIDC"
    }
]
```

## Read Binding Rule by Name

This endpoint reads an ACL Binding Rule with the given name. This queries the
Binding Rule that has been replicated to the region, and may lag behind the
authoritative region.

| Method | Path                            | Produces           |
| ------ | ------------------------------- | ------------------ |
| `GET`  | `/acl/binding-rule/:rule_name` | `application/json` |

The table below shows this endpoint's support for
[blocking queries](/api-docs#blocking-queries),
[consistency modes](/api-docs#consistency-modes) and
[required ACLs](/api-docs#acls).

| Blocking Queries | Consistency Modes | ACL Required       |
| ---------------- | ----------------- | ------------------ |
| `YES`            | `all`             | `management` token |

### Parameters

- `:rule_name` `(string: <required>)` - Specifies the name of the ACL Auth
  Method. This is specified as part of the path.

### Sample Request

```shell-session
$ curl \
    --header "X-Nomad-Token: <NOMAD_TOKEN_SECRET_ID>" \
    https://localhost:4646/v1/acl/binding-rule/example-acl-binding-rule
```

### Sample Response

```json
{
    "MaxTokenTTL": "1h0m0s",
    "Name": "example-acl-binding-rule",
    "Type": "OIDC",
    "TokenLocality": "global",
    "Default": true,
    "Config": {
      "OIDCDiscoveryURL": "https://my-corp-app-name.auth0.com/",
      "OIDCClientID": "V1RPi2MYptMV1RPi2MYptMV1RPi2MYpt",
      "OIDCClientSecret": "example-client-secret",
      "BoundAudiences": [
        "V1RPi2MYptMV1RPi2MYptMV1RPi2MYpt"
      ],
      "AllowedRedirectURIs": [
        "http://localhost:4646/oidc/callback"
      ],
      "ClaimMappings": {
        "http://example.com/first_name": "first_name",
        "http://example.com/last_name": "last_name"
      },
      "ListClaimMappings": {
        "http://nomad.com/groups": "groups"
      }
    },
    "CreateTime": "2022-12-08T11:04:43.46206Z",
    "ModifyTime": "2022-12-08T11:04:43.46206Z",
    "CreateIndex": 12,
    "ModifyIndex": 32
}
```

## Delete Binding Rule

This endpoint deletes the ACL Binding Rule as identified by its name. This
request is always forwarded to the authoritative region.

| Method   | Path                            | Produces       |
| -------- | ------------------------------- | -------------- |
| `DELETE` | `/acl/binding-rule/:rule_name` | `(empty body)` |

The table below shows this endpoint's support for
[blocking queries](/api-docs#blocking-queries) and
[required ACLs](/api-docs#acls).

| Blocking Queries | ACL Required |
| ---------------- | ------------ |
| `NO`             | `management` |

### Parameters

- `rule_name` `(string: <required>)` - Specifies the name of Binding Rule to
  delete and is specified as part of the path.

### Sample Request

```shell-session
$ curl \
    --request DELETE \
    --header "X-Nomad-Token: <NOMAD_TOKEN_SECRET_ID>" \
    https://localhost:4646/v1/acl/binding-rule/example-acl-binding-rule
```
