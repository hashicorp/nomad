---
layout: docs
page_title: Support for IPv6
description: |-
  Nomad support for IPv6
---

All of this depends on the host machine(s) supporting IPv6 in the first place.

* AWS VPC needs some special config to set EC2 up for success
* The OS inside the instance needs to support it
  * Fedora cloud by default does not (iirc), but ubuntu does, and amazon linux (fedora based) does, etc etc etc
* For on-prem (like my linux laptop), the DHCP server (my wifi router) needs to supply IPv6

# ✅ Nomad \<-\> Nomad

Connections between one Nomad agent and another (intra-cluster RPC calls).

* Server \<-\> Server
  * Server agent config: `server{ server_join{ retry_join = [“ip:v6:add:rs”] }}`
* Server \<-\> Client
  * Client agent config: `client{ servers = [“ip:v6:add:rs”] }`
* Client \<-\> Client ?
  * I did not test our best-effort [ephemeral\_disk.migrate](https://developer.hashicorp.com/nomad/docs/job-specification/ephemeral_disk#migrate) feature
* [Advertise](https://developer.hashicorp.com/nomad/docs/configuration#advertise) addresses determine how server/clients will register with the cluster:

`advertise {`
  `# https://pkg.go.dev/github.com/hashicorp/go-sockaddr/template`
  `http = "{{ GetPublicInterfaces | include \"type\" \"IPv6\" | limit 1 | attr \"address\" }}"`
  `rpc  = ^ ditto`
  `serf = ^ ditto`
`}`
(there may be better ways to accomplish that, but it works.)

# ✅ Nomad \<-\> Other

Connections between Nomad and some other system (HTTP calls).

* Nomad CLI and web UI
  * `NOMAD_ADDR=’http://[ip:v6:ad:dr]:4646’`
* Service integration
  * Nomad can reach Consul to register services
  * Nomad can reach Vault to fetch secrets
* Workload identity
  * Consul can reach Nomad at `‘[ip:v6:ad:dr]:4646/.well-known/jwks.json’`
    `nomad setup consul -y -jwks-url="$NOMAD_ADDR/.well-known/jwks.json"`
  * Ditto Vault
    `nomad setup consul -y -jwks-url="$NOMAD_ADDR/.well-known/jwks.json"`
  * And presumably other 3rd parties, as the listener on the Nomad side is identical.

# ✅ Workloads

Connections to and from tasks run by Nomad (arbitrary network calls).

* Anything on the host network can use its IPv6 connectivity directly
* Services can be registered with an IPv6 address
  * With either Nomad service discovery, or Consul
    `service{ provider = “nomad|consul” }` (consul is the default)
  * Using the [preferred\_address\_family](https://developer.hashicorp.com/nomad/docs/configuration/client#preferred_address_family) client config
* Nomad’s [“bridge” network mode](https://developer.hashicorp.com/nomad/docs/job-specification/network#network-modes) can be configured for IPv6
  * Using the [bridge\_network\_subnet\_ipv6](https://github.com/hashicorp/nomad/pull/23882/files#diff-e8490f68e1cda7aaf7a59848e979b52d693d508da7f42967bfd7971b104dac88R181) client config (coming in Nomad 1.9)
* The [docker driver](https://developer.hashicorp.com/nomad/docs/drivers/docker) has some ipv6 options ([see also](https://developer.hashicorp.com/nomad/docs/job-specification/service#ipv6-docker-containers))
  * If docker itself is ipv6-enabled

## ❓ Consul Connect

I have not tested this.
