(window.webpackJsonp=window.webpackJsonp||[]).push([[165],{"2SNK":function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return d}));var n,r=t("wx14"),c=t("Ff2n"),o=t("q1tI"),i=t.n(o),s=t("7ljp"),b=t("j1un"),l=(i.a.createElement,n="Placement",function(e){return console.warn("Component "+n+" was not imported, exported, or provided by MDXProvider as global scope"),Object(s.b)("div",e)}),p={},m=Object(b.a)({layout:"docs",page_title:"autopilot Stanza - Agent Configuration",sidebar_title:"autopilot",description:'The "autopilot" stanza configures the Nomad agent to configure Autopilot behavior.',__resourcePath:"docs/configuration/autopilot.mdx",__scans:{}});function d(e){var a=e.components,t=Object(c.a)(e,["components"]);return Object(s.b)(m,Object(r.a)({},p,t,{components:a,mdxType:"MDXLayout"}),Object(s.b)("h1",{className:"g-type-display-2"},Object(s.b)("a",Object(r.a)({parentName:"h1"},{className:"__permalink-h",href:"#autopilot-stanza","aria-label":"autopilot stanza permalink"}),"\xbb"),Object(s.b)("a",Object(r.a)({parentName:"h1"},{className:"__target-h",id:"autopilot-stanza","aria-hidden":""})),Object(s.b)("inlineCode",{parentName:"h1"},"autopilot")," Stanza"),Object(s.b)(l,{groups:["autopilot"],mdxType:"Placement"}),Object(s.b)("p",null,"The ",Object(s.b)("inlineCode",{parentName:"p"},"autopilot")," stanza configures the Nomad agent to configure Autopilot behavior.\nFor more information about Autopilot, see the ",Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"https://learn.hashicorp.com/nomad/operating-nomad/autopilot"}),"Autopilot Guide"),"."),Object(s.b)("pre",{className:"language-hcl"},Object(s.b)("code",Object(r.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token keyword"}),"autopilot")," ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token property"}),"cleanup_dead_servers")," ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token boolean"}),"true"),"\n    ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token property"}),"last_contact_threshold")," ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token string"}),'"200ms"'),"\n    ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token property"}),"max_trailing_logs")," ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token number"}),"250"),"\n    ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token property"}),"server_stabilization_time")," ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token string"}),'"10s"'),"\n    ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token property"}),"enable_redundancy_zones")," ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token boolean"}),"false"),"\n    ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token property"}),"disable_upgrade_migration")," ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token boolean"}),"false"),"\n    ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token property"}),"enable_custom_upgrades")," ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token boolean"}),"false"),"\n",Object(s.b)("span",Object(r.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(s.b)("h2",{className:"g-type-display-3"},Object(s.b)("a",Object(r.a)({parentName:"h2"},{className:"__permalink-h",href:"#autopilot-parameters","aria-label":"autopilot parameters permalink"}),"\xbb"),Object(s.b)("a",Object(r.a)({parentName:"h2"},{className:"__target-h",id:"autopilot-parameters","aria-hidden":""})),Object(s.b)("inlineCode",{parentName:"h2"},"autopilot")," Parameters"),Object(s.b)("ul",null,Object(s.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(r.a)({parentName:"li"},{id:"cleanup_dead_servers",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"#cleanup_dead_servers","aria-label":"cleanup_dead_servers permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"cleanup_dead_servers"))," ",Object(s.b)("inlineCode",{parentName:"p"},"(bool: true)")," - Specifies automatic removal of dead\nserver nodes periodically and whenever a new server is added to the cluster.")),Object(s.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(r.a)({parentName:"li"},{id:"last_contact_threshold",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"#last_contact_threshold","aria-label":"last_contact_threshold permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"last_contact_threshold"))," ",Object(s.b)("inlineCode",{parentName:"p"},'(string: "200ms")')," - Specifies the maximum amount of\ntime a server can go without contact from the leader before being considered\nunhealthy. Must be a duration value such as ",Object(s.b)("inlineCode",{parentName:"p"},"10s"),".")),Object(s.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(r.a)({parentName:"li"},{id:"max_trailing_logs",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"#max_trailing_logs","aria-label":"max_trailing_logs permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"max_trailing_logs"))," ",Object(s.b)("inlineCode",{parentName:"p"},"(int: 250)")," specifies the maximum number of log entries\nthat a server can trail the leader by before being considered unhealthy.")),Object(s.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(r.a)({parentName:"li"},{id:"server_stabilization_time",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"#server_stabilization_time","aria-label":"server_stabilization_time permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"server_stabilization_time"))," ",Object(s.b)("inlineCode",{parentName:"p"},'(string: "10s")')," - Specifies the minimum amount of\ntime a server must be stable in the 'healthy' state before being added to the\ncluster. Only takes effect if all servers are running Raft protocol version 3\nor higher. Must be a duration value such as ",Object(s.b)("inlineCode",{parentName:"p"},"30s"),".")),Object(s.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(r.a)({parentName:"li"},{id:"enable_redundancy_zones",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"#enable_redundancy_zones","aria-label":"enable_redundancy_zones permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"enable_redundancy_zones"))," ",Object(s.b)("inlineCode",{parentName:"p"},"(bool: false)")," - (Enterprise-only) Controls whether\nAutopilot separates servers into zones for redundancy, in conjunction with the\n",Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"/docs/configuration/server#redundancy_zone"}),"redundancy_zone")," parameter.\nOnly one server in each zone can be a voting member at one time.")),Object(s.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(r.a)({parentName:"li"},{id:"disable_upgrade_migration",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"#disable_upgrade_migration","aria-label":"disable_upgrade_migration permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"disable_upgrade_migration"))," ",Object(s.b)("inlineCode",{parentName:"p"},"(bool: false)")," - (Enterprise-only) Disables Autopilot's\nupgrade migration strategy in Nomad Enterprise of waiting until enough\nnewer-versioned servers have been added to the cluster before promoting any of\nthem to voters.")),Object(s.b)("li",Object(r.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(r.a)({parentName:"li"},{id:"enable_custom_upgrades",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"#enable_custom_upgrades","aria-label":"enable_custom_upgrades permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"enable_custom_upgrades"))," ",Object(s.b)("inlineCode",{parentName:"p"},"(bool: false)")," - (Enterprise-only) Specifies whether to\nenable using custom upgrade versions when performing migrations, in conjunction with\nthe ",Object(s.b)("a",Object(r.a)({parentName:"p"},{href:"/docs/configuration/server#upgrade_version"}),"upgrade_version")," parameter."))))}d.isMDXComponent=!0},P4i7:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/configuration/autopilot",function(){return t("2SNK")}])}},[["P4i7",0,1,2,4,3,5,6]]]);