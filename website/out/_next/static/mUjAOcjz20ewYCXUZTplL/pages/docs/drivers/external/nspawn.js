(window.webpackJsonp=window.webpackJsonp||[]).push([[187],{Z0cO:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/drivers/external/nspawn",function(){return t("iiOf")}])},iiOf:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return l}));var n=t("wx14"),c=t("Ff2n"),b=t("q1tI"),s=t.n(b),r=t("7ljp"),p=t("j1un"),i=(s.a.createElement,{}),o=Object(p.a)({layout:"docs",page_title:"Drivers: Systemd-Nspawn",sidebar_title:"Systemd-Nspawn",description:"The Nspawn task driver is used to run application containers using Systemd-Nspawn.",__resourcePath:"docs/drivers/external/nspawn.mdx",__scans:{}});function l(e){var a=e.components,t=Object(c.a)(e,["components"]);return Object(r.b)(o,Object(n.a)({},i,t,{components:a,mdxType:"MDXLayout"}),Object(r.b)("h1",{className:"g-type-display-2"},Object(r.b)("a",Object(n.a)({parentName:"h1"},{className:"__permalink-h",href:"#nspawn-driver","aria-label":"nspawn driver permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h1"},{className:"__target-h",id:"nspawn-driver","aria-hidden":""})),"Nspawn Driver"),Object(r.b)("p",null,"Name: ",Object(r.b)("inlineCode",{parentName:"p"},"nspawn")),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"nspawn")," driver provides an interface for using Systemd-Nspawn for running application\ncontainers. You can download the external Systemd-Nspawn driver ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/JanMa/nomad-driver-nspawn/releases"}),"here"),". For more detailed instructions on how to set up and use this driver, please refer to the ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/JanMa/nomad-driver-nspawn"}),"guide"),"."),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#task-configuration","aria-label":"task configuration permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"task-configuration","aria-hidden":""})),"Task Configuration"),Object(r.b)("pre",{className:"language-hcl"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),"task ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"debian"')," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"driver")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"nspawn"'),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"image")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/var/lib/machines/Debian"'),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"resolv_conf")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"copy-host"'),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"nspawn")," driver supports the following configuration in the job spec:"),Object(r.b)("ul",null,Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html#-b"}),Object(r.b)("inlineCode",{parentName:"a"},"boot"))," -\n(Optional) ",Object(r.b)("inlineCode",{parentName:"p"},"true")," (default) or ",Object(r.b)("inlineCode",{parentName:"p"},"false"),". Search for an init program and invoke\nit as PID 1. Arguments specified in ",Object(r.b)("inlineCode",{parentName:"p"},"command")," will be used as arguments for\nthe init program.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html#-x"}),Object(r.b)("inlineCode",{parentName:"a"},"ephemeral"))," -\n(Optional) ",Object(r.b)("inlineCode",{parentName:"p"},"true")," or ",Object(r.b)("inlineCode",{parentName:"p"},"false")," (default). Make an ephemeral copy of the image\nbefore staring the container.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html#-a"}),Object(r.b)("inlineCode",{parentName:"a"},"process_two"))," -\n(Optional) ",Object(r.b)("inlineCode",{parentName:"p"},"true")," or ",Object(r.b)("inlineCode",{parentName:"p"},"false")," (default). Start the command specified with\n",Object(r.b)("inlineCode",{parentName:"p"},"command")," as PID 2, using a minimal stub init as PID 1.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html#--read-only"}),Object(r.b)("inlineCode",{parentName:"a"},"read_only"))," -\n(Optional) ",Object(r.b)("inlineCode",{parentName:"p"},"true")," or ",Object(r.b)("inlineCode",{parentName:"p"},"false")," (default). Mount the used image as read only.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html#-U"}),Object(r.b)("inlineCode",{parentName:"a"},"user_namespacing"))," -\n(Optional) ",Object(r.b)("inlineCode",{parentName:"p"},"true")," (default) or ",Object(r.b)("inlineCode",{parentName:"p"},"false"),". Enable user namespacing features\ninside the container.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"command",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#command","aria-label":"command permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"command"))," - (Optional) A list of strings to pass as the used command to the\ncontainer."),Object(r.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"command")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"[")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/bin/bash"'),", ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"-c"'),", ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"dhclient && nginx && tail -f /var/log/nginx/access.log"')," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html#--console=MODE"}),Object(r.b)("inlineCode",{parentName:"a"},"console"))," -\n(Optional) Configures how to set up standard input, output and error output\nfor the container.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"image",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#image","aria-label":"image permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"image"))," - The image to be used in the container. This can either be the path\nto a\n",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html#-D"}),"directory"),",\nthe path to a file system\n",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html#-i"}),"image"),"\nor block device or the name of an image registered with\n",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.freedesktop.org/software/systemd/man/systemd-machined.service.html"}),Object(r.b)("inlineCode",{parentName:"a"},"systemd-machined")),".\nA path can be specified as a relative path from the configured Nomad plugin\ndirectory. ",Object(r.b)("strong",{parentName:"p"},"This option is mandatory"),".")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"image_download",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#image_download","aria-label":"image_download permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"image_download"))," - (Optional) Download the used image according to the\nsettings defined in this block. Structure is documented below.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html#--pivot-root="}),Object(r.b)("inlineCode",{parentName:"a"},"pivot_root"))," -\n(Optional) Pivot the specified directory to the be containers root directory.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html#--resolv-conf="}),Object(r.b)("inlineCode",{parentName:"a"},"resolv_conf"))," -\n(Optional) Configure how ",Object(r.b)("inlineCode",{parentName:"p"},"/etc/resolv.conf")," is handled inside the container.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html#-u"}),Object(r.b)("inlineCode",{parentName:"a"},"user"))," -\n(Optional) Change to the specified user in the containers user database.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html#--volatile"}),Object(r.b)("inlineCode",{parentName:"a"},"volatile"))," -\n(Optional) Boot the container in volatile mode.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html#--chdir="}),Object(r.b)("inlineCode",{parentName:"a"},"working_directory"))," -\n(Optional) Set the working directory inside the container.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html#--bind="}),Object(r.b)("inlineCode",{parentName:"a"},"bind"))," -\n(Optional) Files or directories to bind mount inside the container."),Object(r.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"bind")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"/var/lib/postgresql"')," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/postgres"'),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.freedesktop.org/software/systemd/man/systemd-nspawn.html#--bind="}),Object(r.b)("inlineCode",{parentName:"a"},"bind_read_only"))," -\n(Optional) Files or directories to bind mount read only inside the container."),Object(r.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"bind_read_only")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"/etc/passwd"')," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/etc/passwd"'),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n"))),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"environment",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#environment","aria-label":"environment permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"environment"))," - (Optional) Environment variables to pass to the init process\nin the container."),Object(r.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"environment")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"FOO")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"bar"'),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"port_map",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#port_map","aria-label":"port_map permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"port_map"))," - (Optional) A key-value map of port labels. Works the same way as\nin the ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/drivers/docker#using-the-port-map"}),"docker\ndriver"),".\n",Object(r.b)("strong",{parentName:"p"},"Note:")," ",Object(r.b)("inlineCode",{parentName:"p"},"systemd-nspawn")," will not expose ports to the loopback interface of\nyour host."),Object(r.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"port_map")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"http")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"80"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")))),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"image_download")," block supports the following arguments:"),Object(r.b)("ul",null,Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"url",className:"__target-lic","aria-hidden":""})),Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#url","aria-label":"url permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"url"))," - The URL of the image to download. The URL must be of type ",Object(r.b)("inlineCode",{parentName:"li"},"http://")," or\n",Object(r.b)("inlineCode",{parentName:"li"},"https://"),". ",Object(r.b)("strong",{parentName:"li"},"This option is mandatory"),"."),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://www.freedesktop.org/software/systemd/man/machinectl.html#pull-tar%20URL%20%5BNAME%5D"}),Object(r.b)("inlineCode",{parentName:"a"},"verify"))," -\n(Optional) ",Object(r.b)("inlineCode",{parentName:"li"},"no")," (default), ",Object(r.b)("inlineCode",{parentName:"li"},"signature")," or ",Object(r.b)("inlineCode",{parentName:"li"},"checksum"),". Whether to verify the\nimage before making it available."),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"force",className:"__target-lic","aria-hidden":""})),Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#force","aria-label":"force permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"force"))," - (Optional) ",Object(r.b)("inlineCode",{parentName:"li"},"true")," or ",Object(r.b)("inlineCode",{parentName:"li"},"false")," (default) If a local copy already\nexists, delete it first and replace it by the newly downloaded image."),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"type",className:"__target-lic","aria-hidden":""})),Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#type","aria-label":"type permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"type"))," - (Optional) ",Object(r.b)("inlineCode",{parentName:"li"},"tar")," (default) or ",Object(r.b)("inlineCode",{parentName:"li"},"raw"),". The type of image to download.")),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#networking","aria-label":"networking permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"networking","aria-hidden":""})),"Networking"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"nspawn")," driver has support for host networking and also bridge mode\nnetworking. It can therefore be used with Nomad's ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/integrations/consul-connect"}),"Consul Connect\nintegration"),"."),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#client-requirements","aria-label":"client requirements permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"client-requirements","aria-hidden":""})),"Client Requirements"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"nspawn")," driver requires the following:"),Object(r.b)("ul",null,Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),"64-bit Linux host"),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),"The ",Object(r.b)("inlineCode",{parentName:"li"},"linux_amd64")," Nomad binary"),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),"The Nspawn driver binary placed in the ",Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"/docs/configuration#plugin_dir"}),"plugin_dir")," directory."),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"systemd-nspawn",className:"__target-lic","aria-hidden":""})),Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#systemd-nspawn","aria-label":"systemd nspawn permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"systemd-nspawn"))," to be installed"),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),"Nomad running with root privileges")),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#plugin-options","aria-label":"plugin options permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"plugin-options","aria-hidden":""})),"Plugin Options"),Object(r.b)("ul",null,Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"enabled",className:"__target-lic","aria-hidden":""})),Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#enabled","aria-label":"enabled permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"enabled"))," - The ",Object(r.b)("inlineCode",{parentName:"li"},"nspawn")," driver may be disabled on hosts by setting this option to ",Object(r.b)("inlineCode",{parentName:"li"},"false")," (defaults to ",Object(r.b)("inlineCode",{parentName:"li"},"true"),")."),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"volumes",className:"__target-lic","aria-hidden":""})),Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#volumes","aria-label":"volumes permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"volumes"))," - Enable support for Volumes in the driver (defaults to ",Object(r.b)("inlineCode",{parentName:"li"},"true"),").")),Object(r.b)("p",null,"An example of using these plugin options with the new ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/configuration/plugin"}),"plugin\nsyntax")," is shown below:"),Object(r.b)("pre",{className:"language-hcl"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),"plugin ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"nspawn"')," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"enabled")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"true"),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"volumes")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"true"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#client-attributes","aria-label":"client attributes permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"client-attributes","aria-hidden":""})),"Client Attributes"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"nspawn")," driver will set the following client attributes:"),Object(r.b)("ul",null,Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"driver-nspawn",className:"__target-lic","aria-hidden":""})),Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#driver-nspawn","aria-label":"driver nspawn permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"driver.nspawn"))," - Set to ",Object(r.b)("inlineCode",{parentName:"li"},"true")," if Systemd-Nspawn is found and enabled on the\nhost node and Nomad is running with root privileges."),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"driver-nspawn-version",className:"__target-lic","aria-hidden":""})),Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#driver-nspawn-version","aria-label":"driver nspawn version permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"driver.nspawn.version"))," - Version of ",Object(r.b)("inlineCode",{parentName:"li"},"systemd-nspawn")," e.g.: ",Object(r.b)("inlineCode",{parentName:"li"},"244"),".")))}l.isMDXComponent=!0}},[["Z0cO",0,1,2,4,3,5,6]]]);