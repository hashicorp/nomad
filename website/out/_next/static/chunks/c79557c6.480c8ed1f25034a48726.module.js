(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{e0Wp:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return l}));var n=t("wx14"),c=t("Ff2n"),o=t("q1tI"),b=t.n(o),s=t("7ljp"),r=t("j1un"),i=(b.a.createElement,{}),p=Object(r.a)({layout:"docs",page_title:"Drivers: Docker",sidebar_title:"Docker",description:"The Docker task driver is used to run Docker based tasks.",__resourcePath:"docs/drivers/docker.mdx",__scans:{}});function l(e){var{components:a}=e,t=Object(c.a)(e,["components"]);return Object(s.b)(p,Object(n.a)({},i,t,{components:a,mdxType:"MDXLayout"}),Object(s.b)("h1",{className:"g-type-display-2"},Object(s.b)("a",Object(n.a)({parentName:"h1"},{className:"__permalink-h",href:"#docker-driver","aria-label":"docker driver permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h1"},{className:"__target-h",id:"docker-driver","aria-hidden":""})),"Docker Driver"),Object(s.b)("p",null,"Name: ",Object(s.b)("inlineCode",{parentName:"p"},"docker")),Object(s.b)("p",null,"The ",Object(s.b)("inlineCode",{parentName:"p"},"docker")," driver provides a first-class Docker workflow on Nomad. The Docker\ndriver handles downloading containers, mapping ports, and starting, watching,\nand cleaning up after containers."),Object(s.b)("h2",{className:"g-type-display-3"},Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#task-configuration","aria-label":"task configuration permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"task-configuration","aria-hidden":""})),"Task Configuration"),Object(s.b)("pre",{className:"language-hcl"},Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),"task ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"webservice"')," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"driver")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"docker"'),"\n\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"image")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"redis:3.2"'),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"labels")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"group")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"webservice-cache"'),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(s.b)("p",null,"The ",Object(s.b)("inlineCode",{parentName:"p"},"docker")," driver supports the following configuration in the job spec. Only\n",Object(s.b)("inlineCode",{parentName:"p"},"image")," is required."),Object(s.b)("ul",null,Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"image",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#image","aria-label":"image permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"image"))," - The Docker image to run. The image may include a tag or custom URL\nand should include ",Object(s.b)("inlineCode",{parentName:"p"},"https://")," if required. By default it will be fetched from\nDocker Hub. If the tag is omitted or equal to ",Object(s.b)("inlineCode",{parentName:"p"},"latest")," the driver will always\ntry to pull the image. If the image to be pulled exists in a registry that\nrequires authentication credentials must be provided to Nomad. Please see the\n",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#authentication"}),"Authentication section"),"."),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"image")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"https://hub.docker.internal/redis:3.2"'),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"image_pull_timeout",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#image_pull_timeout","aria-label":"image_pull_timeout permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"image_pull_timeout"))," - (Optional) A time duration that controls how long Nomad\nwill wait before cancelling an in-progress pull of the Docker image as specified\nin ",Object(s.b)("inlineCode",{parentName:"p"},"image"),". Defaults to ",Object(s.b)("inlineCode",{parentName:"p"},'"5m"'),".")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"args",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#args","aria-label":"args permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"args"))," - (Optional) A list of arguments to the optional ",Object(s.b)("inlineCode",{parentName:"p"},"command"),". If no\n",Object(s.b)("inlineCode",{parentName:"p"},"command")," is specified, the arguments are passed directly to the container.\nReferences to environment variables or any ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/runtime/interpolation"}),"interpretable Nomad\nvariables")," will be interpreted before\nlaunching the task. For example:"),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"args")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"-bind"'),", ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"',Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{"),"NOMAD_PORT_http",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),",\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"',Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{"),"nomad",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"."),"datacenter",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),",\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"',Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{"),"MY_ENV",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),",\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"',Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{"),"meta",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"."),"foo",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),",\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"auth",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#auth","aria-label":"auth permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"auth"))," - (Optional) Provide authentication for a private registry (see below).")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"auth_soft_fail",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#auth_soft_fail","aria-label":"auth_soft_fail permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"auth_soft_fail"))," ",Object(s.b)("inlineCode",{parentName:"p"},"(bool: false)")," - Don't fail the task on an auth failure.\nAttempt to continue without auth.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"command",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#command","aria-label":"command permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"command"))," - (Optional) The command to run when starting the container."),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"command")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"my-command"'),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"dns_search_domains",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#dns_search_domains","aria-label":"dns_search_domains permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"dns_search_domains"))," - (Optional) A list of DNS search domains for the container\nto use.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"dns_options",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#dns_options","aria-label":"dns_options permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"dns_options"))," - (Optional) A list of DNS options for the container to use.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"dns_servers",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#dns_servers","aria-label":"dns_servers permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"dns_servers"))," - (Optional) A list of DNS servers for the container to use\n(e.g. ",'["8.8.8.8", "8.8.4.4"]',"). Requires Docker v1.10 or greater.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"entrypoint",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#entrypoint","aria-label":"entrypoint permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"entrypoint"))," - (Optional) A string list overriding the image's entrypoint.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"extra_hosts",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#extra_hosts","aria-label":"extra_hosts permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"extra_hosts"))," - (Optional) A list of hosts, given as host:IP, to be added to\n",Object(s.b)("inlineCode",{parentName:"p"},"/etc/hosts"),".")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"force_pull",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#force_pull","aria-label":"force_pull permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"force_pull"))," - (Optional) ",Object(s.b)("inlineCode",{parentName:"p"},"true")," or ",Object(s.b)("inlineCode",{parentName:"p"},"false")," (default). Always pull most recent image\ninstead of using existing local image. Should be set to ",Object(s.b)("inlineCode",{parentName:"p"},"true")," if repository tags\nare mutable. If image's tag is ",Object(s.b)("inlineCode",{parentName:"p"},"latest")," or omitted, the image will always be pulled\nregardless of this setting.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"hostname",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#hostname","aria-label":"hostname permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"hostname"))," - (Optional) The hostname to assign to the container. When\nlaunching more than one of a task (using ",Object(s.b)("inlineCode",{parentName:"p"},"count"),") with this option set, every\ncontainer the task starts will have the same hostname.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"interactive",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#interactive","aria-label":"interactive permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"interactive"))," - (Optional) ",Object(s.b)("inlineCode",{parentName:"p"},"true")," or ",Object(s.b)("inlineCode",{parentName:"p"},"false")," (default). Keep STDIN open on\nthe container.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"sysctl",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#sysctl","aria-label":"sysctl permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"sysctl"))," - (Optional) A key-value map of sysctl configurations to set to the\ncontainers on start."),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"sysctl")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"net.core.somaxconn")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"16384"'),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"ulimit",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#ulimit","aria-label":"ulimit permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"ulimit"))," - (Optional) A key-value map of ulimit configurations to set to the\ncontainers on start."),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"ulimit")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"nproc")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"4242"'),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"nofile")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"2048:4096"'),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"privileged",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#privileged","aria-label":"privileged permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"privileged"))," - (Optional) ",Object(s.b)("inlineCode",{parentName:"p"},"true")," or ",Object(s.b)("inlineCode",{parentName:"p"},"false")," (default). Privileged mode gives\nthe container access to devices on the host. Note that this also requires the\nnomad agent and docker daemon to be configured to allow privileged\ncontainers.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"ipc_mode",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#ipc_mode","aria-label":"ipc_mode permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"ipc_mode"))," - (Optional) The IPC mode to be used for the container. The default\nis ",Object(s.b)("inlineCode",{parentName:"p"},"none")," for a private IPC namespace. Other values are ",Object(s.b)("inlineCode",{parentName:"p"},"host")," for sharing\nthe host IPC namespace or the name or id of an existing container. Note that\nit is not possible to refer to Docker containers started by Nomad since their\nnames are not known in advance. Note that setting this option also requires the\nNomad agent to be configured to allow privileged containers.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"ipv4_address",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#ipv4_address","aria-label":"ipv4_address permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"ipv4_address"))," - (Optional) The IPv4 address to be used for the container when\nusing user defined networks. Requires Docker 1.13 or greater.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"ipv6_address",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#ipv6_address","aria-label":"ipv6_address permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"ipv6_address"))," - (Optional) The IPv6 address to be used for the container when\nusing user defined networks. Requires Docker 1.13 or greater.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"labels",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#labels","aria-label":"labels permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"labels"))," - (Optional) A key-value map of labels to set to the containers on\nstart."),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"labels")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"foo")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"bar"'),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"zip")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"zap"'),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"load",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#load","aria-label":"load permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"load"))," - (Optional) Load an image from a ",Object(s.b)("inlineCode",{parentName:"p"},"tar")," archive file instead of from a\nremote repository. Equivalent to the ",Object(s.b)("inlineCode",{parentName:"p"},"docker load -i <filename>")," command."),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"artifact")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"source")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"http://path.to/redis.tar"'),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"load")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"redis.tar"'),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"image")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"redis"'),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"logging",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#logging","aria-label":"logging permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"logging"))," - (Optional) A key-value map of Docker logging options.\nDefaults to ",Object(s.b)("inlineCode",{parentName:"p"},"json-file")," with log rotation (",Object(s.b)("inlineCode",{parentName:"p"},"max-file=2")," and ",Object(s.b)("inlineCode",{parentName:"p"},"max-size=2m"),")."),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"logging")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"type")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"fluentd"'),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"fluentd-address")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"localhost:24224"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"tag")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"your_tag"'),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"mac_address",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#mac_address","aria-label":"mac_address permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"mac_address")),' - (Optional) The MAC address for the container to use (e.g.\n"02:68:b3:29:da:98").')),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"memory_hard_limit",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#memory_hard_limit","aria-label":"memory_hard_limit permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"memory_hard_limit"))," - (Optional) The maximum allowable amount of memory used\n(megabytes) by the container. If set, the ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/job-specification/resources#memory"}),Object(s.b)("inlineCode",{parentName:"a"},"memory")),"\nparameter of the task resource configuration becomes a soft limit passed to the\ndocker driver as ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.docker.com/config/containers/resource_constraints/#limit-a-containers-access-to-memory"}),Object(s.b)("inlineCode",{parentName:"a"},"--memory_reservation")),",\nand ",Object(s.b)("inlineCode",{parentName:"p"},"memory_hard_limit")," is passed as the ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.docker.com/config/containers/resource_constraints/#limit-a-containers-access-to-memory"}),Object(s.b)("inlineCode",{parentName:"a"},"--memory")),"\nhard limit. When the host is under memory pressure, the behavior of soft limit\nactivation is governed by the ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://www.kernel.org/doc/Documentation/cgroup-v1/memory.txt"}),"Kernel"),".")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"network_aliases",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#network_aliases","aria-label":"network_aliases permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"network_aliases"))," - (Optional) A list of network-scoped aliases, provide a way for a\ncontainer to be discovered by an alternate name by any other container within\nthe scope of a particular network. Network-scoped alias is supported only for\ncontainers in user defined networks"),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"network_mode")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"user-network"'),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"network_aliases")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"',Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{"),"NOMAD_TASK_NAME",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),",\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"',Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{"),"NOMAD_TASK_NAME",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}")),"-",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{"),"NOMAD_ALLOC_INDEX",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"network_mode",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#network_mode","aria-label":"network_mode permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"network_mode"))," - (Optional) The network mode to be used for the container. In\norder to support userspace networking plugins in Docker 1.9 this accepts any\nvalue. The default is ",Object(s.b)("inlineCode",{parentName:"p"},"bridge")," for all operating systems but Windows, which\ndefaults to ",Object(s.b)("inlineCode",{parentName:"p"},"nat"),". Other networking modes may not work without additional\nconfiguration on the host (which is outside the scope of Nomad). Valid values\npre-docker 1.9 are ",Object(s.b)("inlineCode",{parentName:"p"},"default"),", ",Object(s.b)("inlineCode",{parentName:"p"},"bridge"),", ",Object(s.b)("inlineCode",{parentName:"p"},"host"),", ",Object(s.b)("inlineCode",{parentName:"p"},"none"),", or ",Object(s.b)("inlineCode",{parentName:"p"},"container:name"),".")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"pid_mode",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#pid_mode","aria-label":"pid_mode permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"pid_mode"))," - (Optional) ",Object(s.b)("inlineCode",{parentName:"p"},"host")," or not set (default). Set to ",Object(s.b)("inlineCode",{parentName:"p"},"host")," to share\nthe PID namespace with the host. Note that this also requires the Nomad agent\nto be configured to allow privileged containers.\nSee below for more details.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"ports",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#ports","aria-label":"ports permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"ports"))," - (Optional) A list of port labels to map into the container (see below).")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"port_map",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#port_map","aria-label":"port_map permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"port_map"))," - (Optional) ",Object(s.b)("em",{parentName:"p"},"Deprecated")," A key-value map of port labels (see below).")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"security_opt",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#security_opt","aria-label":"security_opt permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"security_opt"))," - (Optional) A list of string flags to pass directly to\n",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.docker.com/engine/reference/run/#security-configuration"}),Object(s.b)("inlineCode",{parentName:"a"},"--security-opt")),".\nFor example:"),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"security_opt")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"credentialspec=file://gmsaUser.json"'),",\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"shm_size",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#shm_size","aria-label":"shm_size permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"shm_size"))," - (Optional) The size (bytes) of /dev/shm for the container.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"storage_opt",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#storage_opt","aria-label":"storage_opt permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"storage_opt"))," - (Optional) A key-value map of storage options set to the containers on start.\nThis overrides the ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.docker.com/engine/reference/commandline/dockerd/#options-per-storage-driver"}),"host dockerd configuration"),".\nFor example:"),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"storage_opt")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"size")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"40G"'),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"ssl",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#ssl","aria-label":"ssl permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"SSL"))," - (Optional) If this is set to true, Nomad uses SSL to talk to the\nrepository. The default value is ",Object(s.b)("inlineCode",{parentName:"p"},"true"),". ",Object(s.b)("strong",{parentName:"p"},"Deprecated as of 0.5.3"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"tty",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#tty","aria-label":"tty permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"tty"))," - (Optional) ",Object(s.b)("inlineCode",{parentName:"p"},"true")," or ",Object(s.b)("inlineCode",{parentName:"p"},"false")," (default). Allocate a pseudo-TTY for the\ncontainer.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"uts_mode",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#uts_mode","aria-label":"uts_mode permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"uts_mode"))," - (Optional) ",Object(s.b)("inlineCode",{parentName:"p"},"host")," or not set (default). Set to ",Object(s.b)("inlineCode",{parentName:"p"},"host")," to share\nthe UTS namespace with the host. Note that this also requires the Nomad agent\nto be configured to allow privileged containers.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"userns_mode",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#userns_mode","aria-label":"userns_mode permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"userns_mode"))," - (Optional) ",Object(s.b)("inlineCode",{parentName:"p"},"host")," or not set (default). Set to ",Object(s.b)("inlineCode",{parentName:"p"},"host")," to use\nthe host's user namespace when user namespace remapping is enabled on the\ndocker daemon.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"volumes",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#volumes","aria-label":"volumes permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"volumes"))," - (Optional) A list of ",Object(s.b)("inlineCode",{parentName:"p"},"host_path:container_path")," strings to bind\nhost paths to container paths. Mounting host paths outside of the allocation\ndirectory can be disabled on clients by setting the ",Object(s.b)("inlineCode",{parentName:"p"},"docker.volumes.enabled"),"\noption set to false. This will limit volumes to directories that exist inside\nthe allocation directory. We recommend using ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#mounts"}),Object(s.b)("inlineCode",{parentName:"a"},"mounts"))," if you wish\nto have more control over volume definitions."),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"volumes")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"# Use absolute paths to mount arbitrary paths on the host"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/path/on/host:/path/in/container"'),",\n\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"# Use relative paths to rebind paths already in the allocation dir"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"relative/to/task:/also/in/container"'),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"volume_driver",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#volume_driver","aria-label":"volume_driver permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"volume_driver"))," - (Optional) The name of the volume driver used to mount\nvolumes. Must be used along with ",Object(s.b)("inlineCode",{parentName:"p"},"volumes"),". If ",Object(s.b)("inlineCode",{parentName:"p"},"volume_driver")," is omitted,\nthen relative paths will be mounted from inside the allocation dir. If a\n",Object(s.b)("inlineCode",{parentName:"p"},'"local"')," or other driver is used, then they may be named volumes instead.\nIf ",Object(s.b)("inlineCode",{parentName:"p"},"docker.volumes.enabled")," is false then volume drivers and paths outside the\nallocation directory are disallowed."),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"volumes")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"# Use named volume created outside nomad."),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"name-of-the-volume:/path/in/container"'),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"# Name of the Docker Volume Driver used by the container"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"volume_driver")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"pxd"'),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"work_dir",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#work_dir","aria-label":"work_dir permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"work_dir"))," - (Optional) The working directory inside the container.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"mounts",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#mounts","aria-label":"mounts permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"mounts"))," - (Optional) A list of\n",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.docker.com/engine/reference/commandline/service_create/#add-bind-mounts-or-volumes"}),"mounts"),"\nto be mounted into the container. Volume, bind, and tmpfs type mounts are supported."),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"mounts")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"# sample volume mount"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"type")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"volume"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"target")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/path/in/container"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"source")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"name-of-volume"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"readonly")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"false"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"volume_options")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"no_copy")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"false"),"\n        ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"labels")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n          ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"foo")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"bar"'),"\n        ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n        ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"driver_config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n          ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"name")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"pxd"'),"\n          ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"options")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n            ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"foo")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"bar"'),"\n          ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n        ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),",\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"# sample bind mount"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"type")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"bind"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"target")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/path/in/container"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"source")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/path/in/host"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"readonly")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"false"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"bind_options")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"propagation")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"rshared"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),",\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"# sample tmpfs mount"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"type")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"tmpfs"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"target")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/path/in/container"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"readonly")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"false"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"tmpfs_options")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"size")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"100000")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"# size in bytes"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"devices",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#devices","aria-label":"devices permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"devices"))," - (Optional) A list of\n",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.docker.com/engine/reference/commandline/run/#add-host-device-to-container-device"}),"devices"),"\nto be exposed the container. ",Object(s.b)("inlineCode",{parentName:"p"},"host_path")," is the only required field. By default, the container will be able to\n",Object(s.b)("inlineCode",{parentName:"p"},"read"),", ",Object(s.b)("inlineCode",{parentName:"p"},"write")," and ",Object(s.b)("inlineCode",{parentName:"p"},"mknod")," these devices. Use the optional ",Object(s.b)("inlineCode",{parentName:"p"},"cgroup_permissions")," field to restrict permissions."),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"devices")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"host_path")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/dev/sda1"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"container_path")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/dev/xvdc"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"cgroup_permissions")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"r"'),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),",\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"host_path")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/dev/sda2"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"container_path")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/dev/xvdd"'),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"cap_add",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#cap_add","aria-label":"cap_add permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"cap_add"))," - (Optional) A list of Linux capabilities as strings to pass directly to\n",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-capabilities"}),Object(s.b)("inlineCode",{parentName:"a"},"--cap-add")),".\nEffective capabilities (computed from ",Object(s.b)("inlineCode",{parentName:"p"},"cap_add")," and ",Object(s.b)("inlineCode",{parentName:"p"},"cap_drop"),") have to match the configured whitelist.\nThe whitelist can be customized using the ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#plugin_caps"}),Object(s.b)("inlineCode",{parentName:"a"},"allow_caps"))," plugin option key in the client node's configuration.\nFor example:"),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"cap_add")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"SYS_TIME"'),",\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"cap_drop",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#cap_drop","aria-label":"cap_drop permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"cap_drop"))," - (Optional) A list of Linux capabilities as strings to pass directly to\n",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-capabilities"}),Object(s.b)("inlineCode",{parentName:"a"},"--cap-drop")),".\nEffective capabilities (computed from ",Object(s.b)("inlineCode",{parentName:"p"},"cap_add")," and ",Object(s.b)("inlineCode",{parentName:"p"},"cap_drop"),") have to match the configured whitelist.\nThe whitelist can be customized using the ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#plugin_caps"}),Object(s.b)("inlineCode",{parentName:"a"},"allow_caps"))," plugin option key in the client node's configuration.\nFor example:"),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"cap_drop")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"MKNOD"'),",\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"cpu_hard_limit",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#cpu_hard_limit","aria-label":"cpu_hard_limit permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"cpu_hard_limit"))," - (Optional) ",Object(s.b)("inlineCode",{parentName:"p"},"true")," or ",Object(s.b)("inlineCode",{parentName:"p"},"false")," (default). Use hard CPU\nlimiting instead of soft limiting. By default this is ",Object(s.b)("inlineCode",{parentName:"p"},"false")," which means\nsoft limiting is used and containers are able to burst above their CPU limit\nwhen there is idle capacity.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"cpu_cfs_period",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#cpu_cfs_period","aria-label":"cpu_cfs_period permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"cpu_cfs_period"))," - (Optional) An integer value that specifies the duration in microseconds of the period\nduring which the CPU usage quota is measured. The default is 100000 (0.1 second) and the maximum allowed\nvalue is 1000000 (1 second). See ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/resource_management_guide/sec-cpu#sect-cfs"}),"here"),"\nfor more details.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"advertise_ipv6_address",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#advertise_ipv6_address","aria-label":"advertise_ipv6_address permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"advertise_ipv6_address"))," - (Optional) ",Object(s.b)("inlineCode",{parentName:"p"},"true")," or ",Object(s.b)("inlineCode",{parentName:"p"},"false")," (default). Use the container's\nIPv6 address (GlobalIPv6Address in Docker) when registering services and checks.\nSee ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/job-specification/service#ipv6-docker-containers"}),"IPv6 Docker containers")," for details.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"readonly_rootfs",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#readonly_rootfs","aria-label":"readonly_rootfs permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"readonly_rootfs"))," - (Optional) ",Object(s.b)("inlineCode",{parentName:"p"},"true")," or ",Object(s.b)("inlineCode",{parentName:"p"},"false")," (default). Mount\nthe container's filesystem as read only.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"runtime",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#runtime","aria-label":"runtime permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"runtime"))," - (Optional) A string representing a configured runtime to pass to docker.\nThis is equivalent to the ",Object(s.b)("inlineCode",{parentName:"p"},"--runtime")," argument in the docker CLI\nFor example, to use gVisor:"),Object(s.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"# gVisor runtime is runsc"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"runtime")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"runsc"'),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"pids_limit",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#pids_limit","aria-label":"pids_limit permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"pids_limit"))," - (Optional) An integer value that specifies the pid limit for\nthe container. Defaults to unlimited."))),Object(s.b)("p",null,"Additionally, the docker driver supports customization of the container's user through the task's ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/job-specification/task#user"}),Object(s.b)("inlineCode",{parentName:"a"},"user")," option"),"."),Object(s.b)("h3",{className:"g-type-display-4"},Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__permalink-h",href:"#container-name","aria-label":"container name permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__target-h",id:"container-name","aria-hidden":""})),"Container Name"),Object(s.b)("p",null,"Nomad creates a container after pulling an image. Containers are named\n",Object(s.b)("inlineCode",{parentName:"p"},"{taskName}-{allocId}"),". This is necessary in order to place more than one\ncontainer from the same task on a host (e.g. with count > 1). This also means\nthat each container's name is unique across the cluster."),Object(s.b)("p",null,"This is not configurable."),Object(s.b)("h3",{className:"g-type-display-4"},Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__permalink-h",href:"#authentication","aria-label":"authentication permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__target-h",id:"authentication","aria-hidden":""})),"Authentication"),Object(s.b)("p",null,"If you want to pull from a private repo (for example on dockerhub or quay.io),\nyou will need to specify credentials in your job via:"),Object(s.b)("ul",null,Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("p",{parentName:"li"},"the ",Object(s.b)("inlineCode",{parentName:"p"},"auth")," option in the task config.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("p",{parentName:"li"},"by storing explicit repository credentials or by specifying Docker\n",Object(s.b)("inlineCode",{parentName:"p"},"credHelpers")," in a file and setting the auth ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#plugin_auth_file"}),"config"),"\nvalue on the client in the plugin options.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("p",{parentName:"li"},"by specifying an auth ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#plugin_auth_helper"}),"helper")," on the client in the\nplugin options."))),Object(s.b)("p",null,"The ",Object(s.b)("inlineCode",{parentName:"p"},"auth")," object supports the following keys:"),Object(s.b)("ul",null,Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"username",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#username","aria-label":"username permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"username"))," - (Optional) The account username.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"password",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#password","aria-label":"password permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"password"))," - (Optional) The account password.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"email",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#email","aria-label":"email permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"email"))," - (Optional) The account email.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"server_address",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#server_address","aria-label":"server_address permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"server_address"))," - (Optional) The server domain/IP without the protocol.\nDocker Hub is used by default."))),Object(s.b)("p",null,"Example task-config:"),Object(s.b)("pre",{className:"language-hcl"},Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),"task ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"example"')," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"driver")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"docker"'),"\n\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"image")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"secret/service"'),"\n\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"auth")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"username")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"dockerhub_user"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"password")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"dockerhub_password"'),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(s.b)("p",null,'Example docker-config, using two helper scripts in \\$PATH,\n"docker-credential-ecr" and "docker-credential-vault":'),Object(s.b)("pre",{className:"language-json"},Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-json"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"auths"'),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"internal.repo"'),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"auth"'),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"\"`echo -n '<username>:<password>' | base64 -w0`\""),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"credHelpers"'),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"<XYZ>.dkr.ecr.<region>.amazonaws.com"'),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"ecr-login"'),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),","),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"credsStore"'),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token operator"}),":")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"secretservice"'),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(s.b)("p",null,'Example agent configuration, using a helper script "docker-credential-ecr" in\n\\$PATH'),Object(s.b)("pre",{className:"language-hcl"},Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"client")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"enabled")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"true"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\nplugin ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"docker"')," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"auth")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),'# Nomad will prepend "docker-credential-" to the helper value and call'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"# that script name."),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"helper")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"ecr"'),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(s.b)("div",{className:"alert alert-danger g-type-body",role:"alert"},Object(s.b)("p",{parentName:"div"},"",Object(s.b)("strong",{parentName:"p"},"Be Careful!")," At this time these credentials are stored in Nomad in plain\ntext. Secrets management will be added in a later release.")),Object(s.b)("h2",{className:"g-type-display-3"},Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#networking","aria-label":"networking permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"networking","aria-hidden":""})),"Networking"),Object(s.b)("p",null,"Docker supports a variety of networking configurations, including using host\ninterfaces, SDNs, etc. Nomad uses ",Object(s.b)("inlineCode",{parentName:"p"},"bridged")," networking by default, like Docker."),Object(s.b)("p",null,"You can specify other networking options, including custom networking plugins\nin Docker 1.9. ",Object(s.b)("strong",{parentName:"p"},"You may need to perform additional configuration on the host\nin order to make these work.")," This additional configuration is outside the\nscope of Nomad."),Object(s.b)("h3",{className:"g-type-display-4"},Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__permalink-h",href:"#allocating-ports","aria-label":"allocating ports permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__target-h",id:"allocating-ports","aria-hidden":""})),"Allocating Ports"),Object(s.b)("p",null,"You can allocate ports to your task using the port syntax described on the\n",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/job-specification/network"}),"networking page"),". Here is a recap:"),Object(s.b)("pre",{className:"language-hcl"},Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"group")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"network")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    port ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"http"')," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n    port ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"https {}\n  }\n  task "'),"example",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'" {\n    driver = "'),"docker",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"\n    config {\n      ports = ["'),"http",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'", "'),'https"',Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(s.b)("h3",{className:"g-type-display-4"},Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__permalink-h",href:"#forwarding-and-exposing-ports","aria-label":"forwarding and exposing ports permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__target-h",id:"forwarding-and-exposing-ports","aria-hidden":""})),"Forwarding and Exposing Ports"),Object(s.b)("p",null,"A Docker container typically specifies which port a service will listen on by\nspecifying the ",Object(s.b)("inlineCode",{parentName:"p"},"EXPOSE")," directive in the ",Object(s.b)("inlineCode",{parentName:"p"},"Dockerfile"),"."),Object(s.b)("p",null,"Because dynamic ports will not match the ports exposed in your Dockerfile,\nNomad will automatically expose any ports specified in the ",Object(s.b)("inlineCode",{parentName:"p"},"ports")," field."),Object(s.b)("p",null,"These ports will be identified via environment variables. For example:"),Object(s.b)("pre",{className:"language-hcl"},Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"group")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"network")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    port ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"http"')," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  task ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"api"')," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"driver")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"docker"'),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"ports")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"http"'),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(s.b)("p",null,"If Nomad allocates port ",Object(s.b)("inlineCode",{parentName:"p"},"23332")," to your api task for ",Object(s.b)("inlineCode",{parentName:"p"},"http"),", ",Object(s.b)("inlineCode",{parentName:"p"},"23332")," will be\nautomatically exposed and forwarded to your container, and the driver will set\nan environment variable ",Object(s.b)("inlineCode",{parentName:"p"},"NOMAD_PORT_http")," with the value ",Object(s.b)("inlineCode",{parentName:"p"},"23332")," that you can\nread inside your container."),Object(s.b)("p",null,"This provides an easy way to use the ",Object(s.b)("inlineCode",{parentName:"p"},"host")," networking option for better\nperformance."),Object(s.b)("h3",{className:"g-type-display-4"},Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__permalink-h",href:"#using-the-port-map","aria-label":"using the port map permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__target-h",id:"using-the-port-map","aria-hidden":""})),"Using the Port Map"),Object(s.b)("p",null,"If you prefer to use the traditional port-mapping method, you can specify the\nthe ",Object(s.b)("inlineCode",{parentName:"p"},"to")," field in the port configuration. It looks like this:"),Object(s.b)("pre",{className:"language-hcl"},Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),"group ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"example"')," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"network")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    port ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"redis"')," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"to")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"6379")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  task ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"example"')," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"driver")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"docker"'),"\n\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"image")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"redis"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"ports")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"redis"'),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(s.b)("p",null,"If Nomad allocates port ",Object(s.b)("inlineCode",{parentName:"p"},"23332")," to your allocation, the Docker driver will\nautomatically setup the port mapping from ",Object(s.b)("inlineCode",{parentName:"p"},"23332")," on the host to ",Object(s.b)("inlineCode",{parentName:"p"},"6379")," in your\ncontainer, so it will just work!"),Object(s.b)("p",null,"Note that by default this only works with ",Object(s.b)("inlineCode",{parentName:"p"},"bridged")," networking mode. It may\nalso work with custom networking plugins which implement the same API for\nexpose and port forwarding."),Object(s.b)("h4",{className:"g-type-display-5"},Object(s.b)("a",Object(n.a)({parentName:"h4"},{className:"__permalink-h",href:"#deprecated-port_map-syntax","aria-label":"deprecated port_map syntax permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h4"},{className:"__target-h",id:"deprecated-port_map-syntax","aria-hidden":""})),"Deprecated ",Object(s.b)("inlineCode",{parentName:"h4"},"port_map")," Syntax"),Object(s.b)("p",null,"Up until Nomad 0.12, ports could be specified in a task's resource stanza and set using the docker\n",Object(s.b)("inlineCode",{parentName:"p"},"port_map")," field. As more features have been added to the group network resource allocation, task based\nnetwork resources are deprecated. With it the ",Object(s.b)("inlineCode",{parentName:"p"},"port_map")," field is also deprecated and can only be used\nwith task network resources."),Object(s.b)("p",null,"Users should migrate their jobs to define ports in the group network stanza and specified which ports\na task maps with the ",Object(s.b)("inlineCode",{parentName:"p"},"ports")," field."),Object(s.b)("h3",{className:"g-type-display-4"},Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__permalink-h",href:"#advertising-container-ips","aria-label":"advertising container ips permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__target-h",id:"advertising-container-ips","aria-hidden":""})),"Advertising Container IPs"),Object(s.b)("p",null,Object(s.b)("em",{parentName:"p"},"New in Nomad 0.6.")),Object(s.b)("p",null,"When using network plugins like ",Object(s.b)("inlineCode",{parentName:"p"},"weave")," that assign containers a routable IP\naddress, that address will automatically be used in any ",Object(s.b)("inlineCode",{parentName:"p"},"service"),"\nadvertisements for the task. You may override what address is advertised by\nusing the ",Object(s.b)("inlineCode",{parentName:"p"},"address_mode")," parameter on a ",Object(s.b)("inlineCode",{parentName:"p"},"service"),". See\n",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/job-specification/service"}),"service")," for details."),Object(s.b)("h3",{className:"g-type-display-4"},Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__permalink-h",href:"#networking-protocols","aria-label":"networking protocols permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__target-h",id:"networking-protocols","aria-hidden":""})),"Networking Protocols"),Object(s.b)("p",null,"The Docker driver configures ports on both the ",Object(s.b)("inlineCode",{parentName:"p"},"tcp")," and ",Object(s.b)("inlineCode",{parentName:"p"},"udp")," protocols."),Object(s.b)("p",null,"This is not configurable."),Object(s.b)("h3",{className:"g-type-display-4"},Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__permalink-h",href:"#other-networking-modes","aria-label":"other networking modes permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__target-h",id:"other-networking-modes","aria-hidden":""})),"Other Networking Modes"),Object(s.b)("p",null,"Some networking modes like ",Object(s.b)("inlineCode",{parentName:"p"},"container")," or ",Object(s.b)("inlineCode",{parentName:"p"},"none")," will require coordination\noutside of Nomad. First-class support for these options may be improved later\nthrough Nomad plugins or dynamic job configuration."),Object(s.b)("h2",{className:"g-type-display-3"},Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#capabilities","aria-label":"capabilities permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"capabilities","aria-hidden":""})),"Capabilities"),Object(s.b)("p",null,"The ",Object(s.b)("inlineCode",{parentName:"p"},"docker")," driver implements the following ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/internals/plugins/task-drivers#capabilities-capabilities-error"}),"capabilities"),"."),Object(s.b)("table",null,Object(s.b)("thead",{parentName:"table"},Object(s.b)("tr",{parentName:"thead"},Object(s.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Feature"),Object(s.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Implementation"))),Object(s.b)("tbody",{parentName:"table"},Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(s.b)("inlineCode",{parentName:"td"},"nomad alloc signal")),Object(s.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"true")),Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(n.a)({parentName:"tr"},{align:null}),Object(s.b)("inlineCode",{parentName:"td"},"nomad alloc exec")),Object(s.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"true")),Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"filesystem isolation"),Object(s.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"image")),Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"network isolation"),Object(s.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"host, group, task")),Object(s.b)("tr",{parentName:"tbody"},Object(s.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"volume mounting"),Object(s.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"all")))),Object(s.b)("h2",{className:"g-type-display-3"},Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#client-requirements","aria-label":"client requirements permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"client-requirements","aria-hidden":""})),"Client Requirements"),Object(s.b)("p",null,"Nomad requires Docker to be installed and running on the host alongside the\nNomad agent. Nomad was developed against Docker ",Object(s.b)("inlineCode",{parentName:"p"},"1.8.2")," and ",Object(s.b)("inlineCode",{parentName:"p"},"1.9"),"."),Object(s.b)("p",null,"By default Nomad communicates with the Docker daemon using the daemon's Unix\nsocket. Nomad will need to be able to read/write to this socket. If you do not\nrun Nomad as root, make sure you add the Nomad user to the Docker group so\nNomad can communicate with the Docker daemon."),Object(s.b)("p",null,"For example, on Ubuntu you can use the ",Object(s.b)("inlineCode",{parentName:"p"},"usermod")," command to add the ",Object(s.b)("inlineCode",{parentName:"p"},"nomad"),"\nuser to the ",Object(s.b)("inlineCode",{parentName:"p"},"docker")," group so you can run Nomad without root:"),Object(s.b)("pre",{className:"language-shell-session"},Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell-session"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token command"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token sh important"}),"$")," ",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token bash language-bash"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token function"}),"sudo")," ",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token function"}),"usermod")," -G docker -a nomad")),"\n")),Object(s.b)("p",null,"For the best performance and security features you should use recent versions\nof the Linux Kernel and Docker daemon."),Object(s.b)("p",null,"If you would like to change any of the options related to the ",Object(s.b)("inlineCode",{parentName:"p"},"docker")," driver on\na Nomad client, you can modify them with the ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/configuration/plugin"}),"plugin stanza")," syntax. Below is an example of a configuration (many of the values are the default). See the next section for more information on the options."),Object(s.b)("pre",{className:"language-hcl"},Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),"plugin ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"docker"')," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"endpoint")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"unix:///var/run/docker.sock"'),"\n\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"auth")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"config")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/etc/docker-auth.json"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"helper")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"docker-credential-aws"'),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"tls")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"cert")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/etc/nomad/nomad.pub"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"key"),"  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/etc/nomad/nomad.pem"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"ca"),"   ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/etc/nomad/nomad.cert"'),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"gc")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"image"),"       ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"true"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"image_delay")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"3m"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"container"),"   ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"true"),"\n\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"dangling_containers")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"enabled"),"        ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"true"),"\n        ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"dry_run"),"        ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"false"),"\n        ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"period"),"         ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"5m"'),"\n        ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"creation_grace")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"5m"'),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"volumes")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"enabled"),"      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"true"),"\n      ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"selinuxlabel")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"z"'),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"allow_privileged")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token boolean"}),"false"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"allow_caps"),"       ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"CHOWN"'),", ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"NET_RAW"'),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),'# allow_caps can also be set to "ALL"'),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),'# allow_caps = ["ALL"]'),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(s.b)("h2",{className:"g-type-display-3"},Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#plugin-options","aria-label":"plugin options permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"plugin-options","aria-hidden":""})),"Plugin Options"),Object(s.b)("ul",null,Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"endpoint",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#endpoint","aria-label":"endpoint permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"endpoint"))," - If using a non-standard socket, HTTP or another location, or if\nTLS is being used, docker.endpoint must be set. If unset, Nomad will attempt\nto instantiate a Docker client using the ",Object(s.b)("inlineCode",{parentName:"p"},"DOCKER_HOST")," environment variable and\nthen fall back to the default listen address for the given operating system.\nDefaults to ",Object(s.b)("inlineCode",{parentName:"p"},"unix:///var/run/docker.sock")," on Unix platforms and\n",Object(s.b)("inlineCode",{parentName:"p"},"npipe:////./pipe/docker_engine")," for Windows.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"allow_privileged",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#allow_privileged","aria-label":"allow_privileged permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"allow_privileged"))," - Defaults to ",Object(s.b)("inlineCode",{parentName:"p"},"false"),". Changing this to true will allow\ncontainers to use privileged mode, which gives the containers full access to\nthe host's devices. Note that you must set a similar setting on the Docker\ndaemon for this to work.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"pull_activity_timeout",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#pull_activity_timeout","aria-label":"pull_activity_timeout permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"pull_activity_timeout"))," - Defaults to ",Object(s.b)("inlineCode",{parentName:"p"},"2m"),". If Nomad receives no communication\nfrom the Docker engine during an image pull within this timeframe, Nomad will\ntimeout the request that initiated the pull command. (Minimum of ",Object(s.b)("inlineCode",{parentName:"p"},"1m"),")")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"allow_caps",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#allow_caps","aria-label":"allow_caps permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"allow_caps")),Object(s.b)("a",{id:"plugin_caps"})," - A list of allowed Linux capabilities.\nDefaults to\n",Object(s.b)("inlineCode",{parentName:"p"},"CHOWN,DAC_OVERRIDE,FSETID,FOWNER,MKNOD,NET_RAW,SETGID,SETUID,SETFCAP,SETPCAP,\nNET_BIND_SERVICE,SYS_CHROOT,KILL,AUDIT_WRITE"),' which is the list of\ncapabilities allowed by docker by default, as defined here. Allows the\noperator to control which capabilities can be obtained by tasks using cap_add\nand cap_drop options. Supports the value "ALL" as a shortcut for whitelisting\nall capabilities.')),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"allow_runtimes",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#allow_runtimes","aria-label":"allow_runtimes permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"allow_runtimes"))," - defaults to ",Object(s.b)("inlineCode",{parentName:"p"},'["runc", "nvidia"]')," - A list of the allowed\ndocker runtimes a task may use.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"auth-1",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#auth-1","aria-label":"auth permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"auth"))," stanza:"),Object(s.b)("ul",{parentName:"li"},Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"config",className:"__target-lic","aria-hidden":""})),Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"#config","aria-label":"config permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"config")),Object(s.b)("a",{id:"plugin_auth_file"})," - Allows an operator to specify a\nJSON file which is in the dockercfg format containing authentication\ninformation for a private registry, from either (in order) ",Object(s.b)("inlineCode",{parentName:"li"},"auths"),",\n",Object(s.b)("inlineCode",{parentName:"li"},"credHelpers")," or ",Object(s.b)("inlineCode",{parentName:"li"},"credsStore"),"."),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"helper",className:"__target-lic","aria-hidden":""})),Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"#helper","aria-label":"helper permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"helper")),Object(s.b)("a",{id:"plugin_auth_helper"})," - Allows an operator to specify a\n",Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"https://docs.docker.com/engine/reference/commandline/login/#credential-helper-protocol"}),"credsStore"),"\nlike script on ",Object(s.b)("inlineCode",{parentName:"li"},"$PATH")," to lookup authentication information from external\nsources. The script's name must begin with ",Object(s.b)("inlineCode",{parentName:"li"},"docker-credential-")," and this\noption should include only the basename of the script, not the path."))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"tls",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#tls","aria-label":"tls permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"tls"))," stanza:"),Object(s.b)("ul",{parentName:"li"},Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"cert",className:"__target-lic","aria-hidden":""})),Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"#cert","aria-label":"cert permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"cert"))," - Path to the server's certificate file (",Object(s.b)("inlineCode",{parentName:"li"},".pem"),"). Specify this\nalong with ",Object(s.b)("inlineCode",{parentName:"li"},"key")," and ",Object(s.b)("inlineCode",{parentName:"li"},"ca")," to use a TLS client to connect to the docker\ndaemon. ",Object(s.b)("inlineCode",{parentName:"li"},"endpoint")," must also be specified or this setting will be ignored."),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"key",className:"__target-lic","aria-hidden":""})),Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"#key","aria-label":"key permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"key"))," - Path to the client's private key (",Object(s.b)("inlineCode",{parentName:"li"},".pem"),"). Specify this along with\n",Object(s.b)("inlineCode",{parentName:"li"},"cert")," and ",Object(s.b)("inlineCode",{parentName:"li"},"ca")," to use a TLS client to connect to the docker daemon.\n",Object(s.b)("inlineCode",{parentName:"li"},"endpoint")," must also be specified or this setting will be ignored."),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"ca",className:"__target-lic","aria-hidden":""})),Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"#ca","aria-label":"ca permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"ca"))," - Path to the server's CA file (",Object(s.b)("inlineCode",{parentName:"li"},".pem"),"). Specify this along with\n",Object(s.b)("inlineCode",{parentName:"li"},"cert")," and ",Object(s.b)("inlineCode",{parentName:"li"},"key")," to use a TLS client to connect to the docker daemon.\n",Object(s.b)("inlineCode",{parentName:"li"},"endpoint")," must also be specified or this setting will be ignored."))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"disable_log_collection",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#disable_log_collection","aria-label":"disable_log_collection permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"disable_log_collection"))," - Defaults to ",Object(s.b)("inlineCode",{parentName:"p"},"false"),". Setting this to true will\ndisable Nomad logs collection of Docker tasks. If you don't rely on nomad log\ncapabilities and exclusively use host based log aggregation, you may consider\nthis option to disable nomad log collection overhead.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"gc",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#gc","aria-label":"gc permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"gc"))," stanza:"),Object(s.b)("ul",{parentName:"li"},Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"image-1",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#image-1","aria-label":"image permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"image"))," - Defaults to ",Object(s.b)("inlineCode",{parentName:"p"},"true"),". Changing this to ",Object(s.b)("inlineCode",{parentName:"p"},"false")," will prevent Nomad\nfrom removing images from stopped tasks.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"image_delay",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#image_delay","aria-label":"image_delay permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"image_delay"))," - A time duration, as ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://golang.org/pkg/time/#ParseDuration"}),"defined\nhere"),", that defaults to ",Object(s.b)("inlineCode",{parentName:"p"},"3m"),".\nThe delay controls how long Nomad will wait between an image being unused\nand deleting it. If a tasks is received that uses the same image within\nthe delay, the image will be reused.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"container",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#container","aria-label":"container permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"container"))," - Defaults to ",Object(s.b)("inlineCode",{parentName:"p"},"true"),". This option can be used to disable Nomad\nfrom removing a container when the task exits. Under a name conflict,\nNomad may still remove the dead container.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"dangling_containers",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#dangling_containers","aria-label":"dangling_containers permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"dangling_containers"))," stanza for controlling dangling container detection\nand cleanup:"),Object(s.b)("ul",{parentName:"li"},Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"enabled",className:"__target-lic","aria-hidden":""})),Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"#enabled","aria-label":"enabled permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"enabled"))," - Defaults to ",Object(s.b)("inlineCode",{parentName:"li"},"true"),". Enables dangling container handling."),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"dry_run",className:"__target-lic","aria-hidden":""})),Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"#dry_run","aria-label":"dry_run permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"dry_run"))," - Defaults to ",Object(s.b)("inlineCode",{parentName:"li"},"false"),". Only log dangling containers without\ncleaning them up."),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"period",className:"__target-lic","aria-hidden":""})),Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"#period","aria-label":"period permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"period"))," - Defaults to ",Object(s.b)("inlineCode",{parentName:"li"},'"5m"'),". A time duration that controls interval\nbetween Nomad scans for dangling containers."),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"creation_grace",className:"__target-lic","aria-hidden":""})),Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"#creation_grace","aria-label":"creation_grace permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"creation_grace"))," - Defaults to ",Object(s.b)("inlineCode",{parentName:"li"},'"5m"'),". Grace period after a container is\ncreated during which the GC ignores it. Only used to prevent the GC from\nremoving newly created containers before they are registered with the\nGC. Should not need adjusting higher but may be adjusted lower to GC\nmore aggressively."))))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"volumes-1",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#volumes-1","aria-label":"volumes permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"volumes"))," stanza:"),Object(s.b)("ul",{parentName:"li"},Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"enabled-1",className:"__target-lic","aria-hidden":""})),Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"#enabled-1","aria-label":"enabled permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"enabled"))," - Defaults to ",Object(s.b)("inlineCode",{parentName:"li"},"false"),". Allows tasks to bind host paths\n(",Object(s.b)("inlineCode",{parentName:"li"},"volumes"),") inside their container and use volume drivers\n(",Object(s.b)("inlineCode",{parentName:"li"},"volume_driver"),"). Binding relative paths is always allowed and will be\nresolved relative to the allocation's directory."),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"selinuxlabel",className:"__target-lic","aria-hidden":""})),Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"#selinuxlabel","aria-label":"selinuxlabel permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"selinuxlabel"))," - Allows the operator to set a SELinux label to the\nallocation and task local bind-mounts to containers. If used with\n",Object(s.b)("inlineCode",{parentName:"li"},"docker.volumes.enabled")," set to false, the labels will still be applied to\nthe standard binds in the container."))),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"infra_image",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#infra_image","aria-label":"infra_image permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"infra_image")),' - This is the Docker image to use when creating the parent\ncontainer necessary when sharing network namespaces between tasks. Defaults\nto "gcr.io/google_containers/pause-amd64:3.0".')),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"infra_image_pull_timeout",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#infra_image_pull_timeout","aria-label":"infra_image_pull_timeout permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"infra_image_pull_timeout"))," - A time duration that controls how long Nomad will\nwait before cancelling an in-progress pull of the Docker image as specified in\n",Object(s.b)("inlineCode",{parentName:"p"},"infra_image"),". Defaults to ",Object(s.b)("inlineCode",{parentName:"p"},'"5m"'),"."))),Object(s.b)("h2",{className:"g-type-display-3"},Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#client-configuration","aria-label":"client configuration permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"client-configuration","aria-hidden":""})),"Client Configuration"),Object(s.b)("div",{className:"alert alert-warning g-type-body",role:"alert"},Object(s.b)("p",{parentName:"div"},"Note: client configuration options will soon be deprecated. Please use\n",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#plugin-options"}),"plugin options")," instead. See the ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/configuration/plugin"}),"plugin stanza"),"\ndocumentation for more information.")),Object(s.b)("p",null,"The ",Object(s.b)("inlineCode",{parentName:"p"},"docker")," driver has the following ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/configuration/client#options"}),"client configuration\noptions"),":"),Object(s.b)("ul",null,Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"docker-endpoint",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#docker-endpoint","aria-label":"docker endpoint permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"docker.endpoint"))," - If using a non-standard socket, HTTP or another location,\nor if TLS is being used, ",Object(s.b)("inlineCode",{parentName:"p"},"docker.endpoint")," must be set. If unset, Nomad will\nattempt to instantiate a Docker client using the ",Object(s.b)("inlineCode",{parentName:"p"},"DOCKER_HOST")," environment\nvariable and then fall back to the default listen address for the given\noperating system. Defaults to ",Object(s.b)("inlineCode",{parentName:"p"},"unix:///var/run/docker.sock")," on Unix platforms\nand ",Object(s.b)("inlineCode",{parentName:"p"},"npipe:////./pipe/docker_engine")," for Windows.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"docker-auth-config",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#docker-auth-config","aria-label":"docker auth config permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"docker.auth.config"))," ",Object(s.b)("a",{id:"auth_file"}),"- Allows an operator to specify a\nJSON file which is in the dockercfg format containing authentication\ninformation for a private registry, from either (in order) ",Object(s.b)("inlineCode",{parentName:"p"},"auths"),",\n",Object(s.b)("inlineCode",{parentName:"p"},"credHelpers")," or ",Object(s.b)("inlineCode",{parentName:"p"},"credsStore"),".")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"docker-auth-helper",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#docker-auth-helper","aria-label":"docker auth helper permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"docker.auth.helper"))," ",Object(s.b)("a",{id:"auth_helper"}),"- Allows an operator to specify a\n",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.docker.com/engine/reference/commandline/login/#credential-helper-protocol"}),"credsStore"),"\n-like script on \\$PATH to lookup authentication information from external\nsources. The script's name must begin with ",Object(s.b)("inlineCode",{parentName:"p"},"docker-credential-")," and this\noption should include only the basename of the script, not the path.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"docker-tls-cert",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#docker-tls-cert","aria-label":"docker tls cert permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"docker.tls.cert"))," - Path to the server's certificate file (",Object(s.b)("inlineCode",{parentName:"p"},".pem"),"). Specify\nthis along with ",Object(s.b)("inlineCode",{parentName:"p"},"docker.tls.key")," and ",Object(s.b)("inlineCode",{parentName:"p"},"docker.tls.ca")," to use a TLS client to\nconnect to the docker daemon. ",Object(s.b)("inlineCode",{parentName:"p"},"docker.endpoint")," must also be specified or this\nsetting will be ignored.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"docker-tls-key",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#docker-tls-key","aria-label":"docker tls key permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"docker.tls.key"))," - Path to the client's private key (",Object(s.b)("inlineCode",{parentName:"p"},".pem"),"). Specify this\nalong with ",Object(s.b)("inlineCode",{parentName:"p"},"docker.tls.cert")," and ",Object(s.b)("inlineCode",{parentName:"p"},"docker.tls.ca")," to use a TLS client to\nconnect to the docker daemon. ",Object(s.b)("inlineCode",{parentName:"p"},"docker.endpoint")," must also be specified or this\nsetting will be ignored.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"docker-tls-ca",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#docker-tls-ca","aria-label":"docker tls ca permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"docker.tls.ca"))," - Path to the server's CA file (",Object(s.b)("inlineCode",{parentName:"p"},".pem"),"). Specify this along\nwith ",Object(s.b)("inlineCode",{parentName:"p"},"docker.tls.cert")," and ",Object(s.b)("inlineCode",{parentName:"p"},"docker.tls.key")," to use a TLS client to connect to\nthe docker daemon. ",Object(s.b)("inlineCode",{parentName:"p"},"docker.endpoint")," must also be specified or this setting\nwill be ignored.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"docker-cleanup-image",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#docker-cleanup-image","aria-label":"docker cleanup image permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"docker.cleanup.image"))," Defaults to ",Object(s.b)("inlineCode",{parentName:"p"},"true"),". Changing this to ",Object(s.b)("inlineCode",{parentName:"p"},"false")," will\nprevent Nomad from removing images from stopped tasks.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"docker-cleanup-image-delay",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#docker-cleanup-image-delay","aria-label":"docker cleanup image delay permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"docker.cleanup.image.delay"))," A time duration, as ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://golang.org/pkg/time/#ParseDuration"}),"defined\nhere"),", that defaults to ",Object(s.b)("inlineCode",{parentName:"p"},"3m"),". The\ndelay controls how long Nomad will wait between an image being unused and\ndeleting it. If a tasks is received that uses the same image within the delay,\nthe image will be reused.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"docker-volumes-enabled",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#docker-volumes-enabled","aria-label":"docker volumes enabled permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"docker.volumes.enabled")),": Defaults to ",Object(s.b)("inlineCode",{parentName:"p"},"false"),". Allows tasks to bind host paths\n(",Object(s.b)("inlineCode",{parentName:"p"},"volumes"),") inside their container and use volume drivers (",Object(s.b)("inlineCode",{parentName:"p"},"volume_driver"),").\nBinding relative paths is always allowed and will be resolved relative to the\nallocation's directory.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"docker-volumes-selinuxlabel",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#docker-volumes-selinuxlabel","aria-label":"docker volumes selinuxlabel permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"docker.volumes.selinuxlabel")),": Allows the operator to set a SELinux label to\nthe allocation and task local bind-mounts to containers. If used with\n",Object(s.b)("inlineCode",{parentName:"p"},"docker.volumes.enabled")," set to false, the labels will still be applied to the\nstandard binds in the container.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"docker-privileged-enabled",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#docker-privileged-enabled","aria-label":"docker privileged enabled permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"docker.privileged.enabled"))," Defaults to ",Object(s.b)("inlineCode",{parentName:"p"},"false"),". Changing this to ",Object(s.b)("inlineCode",{parentName:"p"},"true")," will\nallow containers to use ",Object(s.b)("inlineCode",{parentName:"p"},"privileged")," mode, which gives the containers full\naccess to the host's devices. Note that you must set a similar setting on the\nDocker daemon for this to work.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"docker-caps-whitelist",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#docker-caps-whitelist","aria-label":"docker caps whitelist permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"docker.caps.whitelist")),": A list of allowed Linux capabilities. Defaults to\n",Object(s.b)("inlineCode",{parentName:"p"},'"CHOWN,DAC_OVERRIDE,FSETID,FOWNER,MKNOD,NET_RAW,SETGID,SETUID,SETFCAP, SETPCAP,NET_BIND_SERVICE,SYS_CHROOT,KILL,AUDIT_WRITE"'),", which is the list of\ncapabilities allowed by docker by default, as ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.docker.com/engine/reference/run/#runtime-privilege-and-linux-capabilities"}),"defined\nhere"),".\nAllows the operator to control which capabilities can be obtained by tasks\nusing ",Object(s.b)("inlineCode",{parentName:"p"},"cap_add")," and ",Object(s.b)("inlineCode",{parentName:"p"},"cap_drop")," options. Supports the value ",Object(s.b)("inlineCode",{parentName:"p"},'"ALL"')," as a\nshortcut for whitelisting all capabilities.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"docker-cleanup-container",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#docker-cleanup-container","aria-label":"docker cleanup container permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"docker.cleanup.container")),": Defaults to ",Object(s.b)("inlineCode",{parentName:"p"},"true"),". This option can be used to\ndisable Nomad from removing a container when the task exits. Under a name\nconflict, Nomad may still remove the dead container.")),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"docker-nvidia_runtime",className:"__target-lic","aria-hidden":""})),Object(s.b)("p",{parentName:"li"},Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"#docker-nvidia_runtime","aria-label":"docker nvidia_runtime permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"docker.nvidia_runtime")),": Defaults to ",Object(s.b)("inlineCode",{parentName:"p"},"nvidia"),". This option allows operators to select the runtime that should be used in order to expose Nvidia GPUs to the container."))),Object(s.b)("p",null,"Note: When testing or using the ",Object(s.b)("inlineCode",{parentName:"p"},"-dev")," flag you can use ",Object(s.b)("inlineCode",{parentName:"p"},"DOCKER_HOST"),",\n",Object(s.b)("inlineCode",{parentName:"p"},"DOCKER_TLS_VERIFY"),", and ",Object(s.b)("inlineCode",{parentName:"p"},"DOCKER_CERT_PATH")," to customize Nomad's behavior. If\n",Object(s.b)("inlineCode",{parentName:"p"},"docker.endpoint")," is set Nomad will ",Object(s.b)("strong",{parentName:"p"},"only")," read client configuration from the\nconfig file."),Object(s.b)("p",null,"An example is given below:"),Object(s.b)("pre",{className:"language-hcl"},Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"client")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"options")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),'"docker.cleanup.image"')," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"false"'),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(s.b)("h2",{className:"g-type-display-3"},Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#client-attributes","aria-label":"client attributes permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"client-attributes","aria-hidden":""})),"Client Attributes"),Object(s.b)("p",null,"The ",Object(s.b)("inlineCode",{parentName:"p"},"docker")," driver will set the following client attributes:"),Object(s.b)("ul",null,Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"driver-docker",className:"__target-lic","aria-hidden":""})),Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"#driver-docker","aria-label":"driver docker permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"driver.docker")),' - This will be set to "1", indicating the driver is\navailable.'),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"driver-docker-bridge_ip",className:"__target-lic","aria-hidden":""})),Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"#driver-docker-bridge_ip","aria-label":"driver docker bridge_ip permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"driver.docker.bridge_ip"))," - The IP of the Docker bridge network if one\nexists."),Object(s.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(s.b)("a",Object(n.a)({parentName:"li"},{id:"driver-docker-version",className:"__target-lic","aria-hidden":""})),Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"#driver-docker-version","aria-label":"driver docker version permalink",className:"__permalink-lic"}),Object(s.b)("inlineCode",{parentName:"a"},"driver.docker.version"))," - This will be set to version of the docker server.")),Object(s.b)("p",null,"Here is an example of using these properties in a job file:"),Object(s.b)("pre",{className:"language-hcl"},Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),"job ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"docs"')," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"# Require docker version higher than 1.2."),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"attribute")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"',Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token interpolation"}),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{"),"driver",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"."),"docker",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"."),"version",Object(s.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"operator"),"  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'">"'),"\n    ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"version"),"   ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"1.2"'),"\n  ",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(s.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(s.b)("h2",{className:"g-type-display-3"},Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#resource-isolation","aria-label":"resource isolation permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"resource-isolation","aria-hidden":""})),"Resource Isolation"),Object(s.b)("h3",{className:"g-type-display-4"},Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__permalink-h",href:"#cpu","aria-label":"cpu permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__target-h",id:"cpu","aria-hidden":""})),"CPU"),Object(s.b)("p",null,"Nomad limits containers' CPU based on CPU shares. CPU shares allow containers\nto burst past their CPU limits. CPU limits will only be imposed when there is\ncontention for resources. When the host is under load your process may be\nthrottled to stabilize QoS depending on how many shares it has. You can see how\nmany CPU shares are available to your process by reading ",Object(s.b)("inlineCode",{parentName:"p"},"NOMAD_CPU_LIMIT"),".\n1000 shares are approximately equal to 1 GHz."),Object(s.b)("p",null,"Please keep the implications of CPU shares in mind when you load test workloads\non Nomad."),Object(s.b)("h3",{className:"g-type-display-4"},Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__permalink-h",href:"#memory","aria-label":"memory permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__target-h",id:"memory","aria-hidden":""})),"Memory"),Object(s.b)("p",null,"Nomad limits containers' memory usage based on total virtual memory. This means\nthat containers scheduled by Nomad cannot use swap. This is to ensure that a\nswappy process does not degrade performance for other workloads on the same\nhost."),Object(s.b)("p",null,"Since memory is not an elastic resource, you will need to make sure your\ncontainer does not exceed the amount of memory allocated to it, or it will be\nterminated or crash when it tries to malloc. A process can inspect its memory\nlimit by reading ",Object(s.b)("inlineCode",{parentName:"p"},"NOMAD_MEMORY_LIMIT"),", but will need to track its own memory\nusage. Memory limit is expressed in megabytes so 1024 = 1 GB."),Object(s.b)("h3",{className:"g-type-display-4"},Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__permalink-h",href:"#io","aria-label":"io permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__target-h",id:"io","aria-hidden":""})),"IO"),Object(s.b)("p",null,"Nomad's Docker integration does not currently provide QoS around network or\nfilesystem IO. These will be added in a later release."),Object(s.b)("h3",{className:"g-type-display-4"},Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__permalink-h",href:"#security","aria-label":"security permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__target-h",id:"security","aria-hidden":""})),"Security"),Object(s.b)("p",null,"Docker provides resource isolation by way of\n",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.docker.com/introduction/understanding-docker/#the-underlying-technology"}),"cgroups and namespaces"),".\nContainers essentially have a virtual file system all to themselves. If you\nneed a higher degree of isolation between processes for security or other\nreasons, it is recommended to use full virtualization like\n",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/drivers/qemu"}),"QEMU"),"."),Object(s.b)("h2",{className:"g-type-display-3"},Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#caveats","aria-label":"caveats permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"caveats","aria-hidden":""})),"Caveats"),Object(s.b)("h3",{className:"g-type-display-4"},Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__permalink-h",href:"#dangling-containers","aria-label":"dangling containers permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__target-h",id:"dangling-containers","aria-hidden":""})),"Dangling Containers"),Object(s.b)("p",null,"Nomad 0.10.2 introduces a detector and a reaper for dangling Docker containers,\ncontainers that Nomad starts yet does not manage or track. Though rare, they\nlead to unexpectedly running services, potentially with stale versions."),Object(s.b)("p",null,"When Docker daemon becomes unavailable as Nomad starts a task, it is possible\nfor Docker to successfully start the container but return a 500 error code from\nthe API call. In such cases, Nomad retries and eventually aims to kill such\ncontainers. However, if the Docker Engine remains unhealthy, subsequent retries\nand stop attempts may still fail, and the started container becomes a dangling\ncontainer that Nomad no longer manages."),Object(s.b)("p",null,"The newly added reaper periodically scans for such containers. It only targets\ncontainers with a ",Object(s.b)("inlineCode",{parentName:"p"},"com.hashicorp.nomad.allocation_id")," label, or match Nomad's\nconventions for naming and bind-mounts (i.e. ",Object(s.b)("inlineCode",{parentName:"p"},"/alloc"),", ",Object(s.b)("inlineCode",{parentName:"p"},"/secrets"),", ",Object(s.b)("inlineCode",{parentName:"p"},"local"),").\nContainers that don't match Nomad container patterns are left untouched."),Object(s.b)("p",null,"Operators can run the reaper in a dry-run mode, where it only logs dangling\ncontainer ids without killing them, or disable it by setting the\n",Object(s.b)("inlineCode",{parentName:"p"},"gc.dangling_containers")," config stanza."),Object(s.b)("h3",{className:"g-type-display-4"},Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__permalink-h",href:"#docker-for-windows","aria-label":"docker for windows permalink"}),"\xbb"),Object(s.b)("a",Object(n.a)({parentName:"h3"},{className:"__target-h",id:"docker-for-windows","aria-hidden":""})),"Docker for Windows"),Object(s.b)("p",null,"Docker for Windows only supports running Windows containers. Because Docker for\nWindows is relatively new and rapidly evolving you may want to consult the\n",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/hashicorp/nomad/issues?q=is%3Aopen+is%3Aissue+label%3Adriver%2Fdocker+label%3Aplatform-windows"}),"list of relevant issues on GitHub"),"."))}l.isMDXComponent=!0}}]);