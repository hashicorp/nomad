(window.webpackJsonp=window.webpackJsonp||[]).push([[189],{"8+ZL":function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/drivers/external/rkt",function(){return t("tQRz")}])},tQRz:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return l}));var n=t("wx14"),c=t("Ff2n"),b=t("q1tI"),s=t.n(b),r=t("7ljp"),p=t("j1un"),o=(s.a.createElement,{}),i=Object(p.a)({layout:"docs",page_title:"Drivers: Rkt",sidebar_title:"Rkt <sup>Deprecated</sup> ",description:"The rkt task driver is used to run application containers using rkt.",__resourcePath:"docs/drivers/external/rkt.mdx",__scans:{}});function l(e){var a=e.components,t=Object(c.a)(e,["components"]);return Object(r.b)(i,Object(n.a)({},o,t,{components:a,mdxType:"MDXLayout"}),Object(r.b)("div",{className:"alert alert-warning g-type-body",role:"alert"},Object(r.b)("p",{parentName:"div"},"",Object(r.b)("strong",{parentName:"p"},"Deprecation Warning!"),"\nNomad introduced the rkt driver in version 0.2.0. The rkt project had some\nearly adoption; in recent times user adoption has trended away from rkt towards\nother projects. Project activity has declined and there are unpatched CVEs.\nThe project has been ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/rkt/rkt/issues/4004#issuecomment-507358362"}),"archived by the CNCF"))),Object(r.b)("p",null,"Nomad 0.11 converted the rkt driver to an external driver. We will not prioritize features\nor pull requests that affect the rkt driver. The external driver is available as an ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/hashicorp/nomad-driver-rkt"}),"open source\nrepository")," for community ownership."),Object(r.b)("h1",{className:"g-type-display-2"},Object(r.b)("a",Object(n.a)({parentName:"h1"},{className:"__permalink-h",href:"#rkt-driver","aria-label":"rkt driver permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h1"},{className:"__target-h",id:"rkt-driver","aria-hidden":""})),"Rkt Driver"),Object(r.b)("p",null,"Name: ",Object(r.b)("inlineCode",{parentName:"p"},"rkt")),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"rkt")," driver provides an interface for using rkt for running\napplication containers."),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#task-configuration","aria-label":"task configuration permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"task-configuration","aria-hidden":""})),"Task Configuration"),Object(r.b)("pre",{className:"language-hcl"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),"task ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"webservice"')," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"driver")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"rkt"'),"\n\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"image")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"redis:3.2"'),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"rkt")," driver supports the following configuration in the job spec:"),Object(r.b)("ul",null,Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"image",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#image","aria-label":"image permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"image"))," - The image to run. May be specified by name, hash, ACI address\nor docker registry."),Object(r.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"image")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"https://hub.docker.internal/redis:3.2"'),"\n",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"command",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#command","aria-label":"command permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"command"))," - (Optional) A command to execute on the ACI."),Object(r.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"command")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"my-command"'),"\n",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"args",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#args","aria-label":"args permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"args"))," - (Optional) A list of arguments to the optional ",Object(r.b)("inlineCode",{parentName:"p"},"command"),". References\nto environment variables or any ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/runtime/interpolation"}),"interpretable Nomad\nvariables")," will be interpreted before\nlaunching the task."),Object(r.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"args")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"-bind"'),", ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"',Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token interpolation"}),Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{"),"NOMAD_PORT_http",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),",\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"',Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token interpolation"}),Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{"),"nomad",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"."),"datacenter",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),",\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"',Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token interpolation"}),Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{"),"MY_ENV",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),",\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"',Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token interpolation"}),Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{"),"meta",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"."),"foo",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),",\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"trust_prefix",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#trust_prefix","aria-label":"trust_prefix permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"trust_prefix"))," - (Optional) The trust prefix to be passed to rkt. Must be\nreachable from the box running the nomad agent. If not specified, the image is\nrun with ",Object(r.b)("inlineCode",{parentName:"p"},"--insecure-options=all"),".")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"insecure_options",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#insecure_options","aria-label":"insecure_options permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"insecure_options"))," - (Optional) List of insecure options for rkt. Consult ",Object(r.b)("inlineCode",{parentName:"p"},"rkt --help"),"\nfor list of supported values. This list overrides the ",Object(r.b)("inlineCode",{parentName:"p"},"--insecure-options=all")," default when\nno ",Object(r.b)("inlineCode",{parentName:"p"},"trust_prefix")," is provided in the job config, which can be effectively used to enforce\nsecure runs, using ",Object(r.b)("inlineCode",{parentName:"p"},'insecure_options = ["none"]')," option."),Object(r.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"image")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"example.com/image:1.0"'),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"insecure_options")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"image"'),", ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"tls"'),", ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"ondisk"'),Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"dns_servers",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#dns_servers","aria-label":"dns_servers permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"dns_servers"))," - (Optional) A list of DNS servers to be used in the container.\nAlternatively a list containing just ",Object(r.b)("inlineCode",{parentName:"p"},"host")," or ",Object(r.b)("inlineCode",{parentName:"p"},"none"),". ",Object(r.b)("inlineCode",{parentName:"p"},"host")," uses the host's\n",Object(r.b)("inlineCode",{parentName:"p"},"resolv.conf")," while ",Object(r.b)("inlineCode",{parentName:"p"},"none")," forces use of the image's name resolution configuration.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"dns_search_domains",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#dns_search_domains","aria-label":"dns_search_domains permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"dns_search_domains"))," - (Optional) A list of DNS search domains to be used in\nthe containers.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"net",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#net","aria-label":"net permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"net"))," - (Optional) A list of networks to be used by the containers")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"port_map",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#port_map","aria-label":"port_map permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"port_map"))," - (Optional) A key/value map of ports used by the container. The\nvalue is the port name specified in the image manifest file. When running\nDocker images with rkt the port names will be of the form ",Object(r.b)("inlineCode",{parentName:"p"},"${PORT}-tcp"),". See\n",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#networking"}),"networking")," below for more details."),Object(r.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"port_map")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"# If running a Docker image that exposes port 8080"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"app")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"8080-tcp"'),"\n",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")))),Object(r.b)("ul",null,Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"debug",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#debug","aria-label":"debug permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"debug"))," - (Optional) Enable rkt command debug option.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"no_overlay",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#no_overlay","aria-label":"no_overlay permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"no_overlay"))," - (Optional) When enabled, will use ",Object(r.b)("inlineCode",{parentName:"p"},"--no-overlay=true")," flag for 'rkt run'.\nUseful when running jobs on older systems affected by ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/rkt/rkt/issues/1922"}),"https://github.com/rkt/rkt/issues/1922"))),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"volumes",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#volumes","aria-label":"volumes permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"volumes"))," - (Optional) A list of ",Object(r.b)("inlineCode",{parentName:"p"},"host_path:container_path[:readOnly]")," strings to bind\nhost paths to container paths.\nMount is done read-write by default; an optional third parameter ",Object(r.b)("inlineCode",{parentName:"p"},"readOnly")," can be provided\nto make it read-only."),Object(r.b)("pre",Object(n.a)({parentName:"li"},{className:"language-hcl"}),Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"volumes")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/path/on/host:/path/in/container"'),", ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/readonly/path/on/host:/path/in/container:readOnly"'),Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n"))),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"group",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#group","aria-label":"group permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"group"))," - (Optional) Specifies the group that will run the task. Sets the\n",Object(r.b)("inlineCode",{parentName:"p"},"--group")," flag and overrides the group specified by the image. The\n",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/job-specification/task#user"}),Object(r.b)("inlineCode",{parentName:"a"},"user"))," may be specified at the task level."))),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#networking","aria-label":"networking permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"networking","aria-hidden":""})),"Networking"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"rkt")," can specify ",Object(r.b)("inlineCode",{parentName:"p"},"--net")," and ",Object(r.b)("inlineCode",{parentName:"p"},"--port")," for the rkt client. Hence, there are two ways to use host ports by\nusing ",Object(r.b)("inlineCode",{parentName:"p"},"--net=host")," or ",Object(r.b)("inlineCode",{parentName:"p"},"--port=PORT")," with your network."),Object(r.b)("p",null,"Example:"),Object(r.b)("pre",{className:"language-hcl"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),"task ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"redis"')," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"# Use rkt to run the task."),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"driver")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"rkt"'),"\n\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"# Use docker image with port defined"),"\n        ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"image")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"docker://redis:latest"'),"\n        ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"port_map")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n            ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"app")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"6379-tcp"'),"\n        ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"service")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"port")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"app"'),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"resources")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"network")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n            ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"mbits")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"10"),"\n            port ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"app"')," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n              ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"static")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token number"}),"12345"),"\n            ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n        ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(r.b)("h3",{className:"g-type-display-4"},Object(r.b)("a",Object(n.a)({parentName:"h3"},{className:"__permalink-h",href:"#allocating-ports","aria-label":"allocating ports permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h3"},{className:"__target-h",id:"allocating-ports","aria-hidden":""})),"Allocating Ports"),Object(r.b)("p",null,"You can allocate ports to your task using the port syntax described on the\n",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/job-specification/network"}),"networking page"),"."),Object(r.b)("p",null,"When you use port allocation, the image manifest needs to declare public ports and host has configured network.\nFor more information, please refer to ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://coreos.com/rkt/docs/latest/networking/overview"}),"rkt Networking"),"."),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#client-requirements","aria-label":"client requirements permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"client-requirements","aria-hidden":""})),"Client Requirements"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"rkt")," driver requires the following:"),Object(r.b)("ul",null,Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),"The Nomad client agent to be running as the root user."),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),"rkt to be installed and in your system's ",Object(r.b)("inlineCode",{parentName:"li"},"$PATH"),"."),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),"The ",Object(r.b)("inlineCode",{parentName:"li"},"trust_prefix")," must be accessible by the node running Nomad. This can be an\ninternal source, private to your cluster, but it must be reachable by the client\nover HTTP.")),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#plugin-options","aria-label":"plugin options permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"plugin-options","aria-hidden":""})),"Plugin Options"),Object(r.b)("ul",null,Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"volumes_enabled",className:"__target-lic","aria-hidden":""})),Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#volumes_enabled","aria-label":"volumes_enabled permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"volumes_enabled"))," - Defaults to ",Object(r.b)("inlineCode",{parentName:"li"},"true"),". Allows tasks to bind host paths\n(",Object(r.b)("inlineCode",{parentName:"li"},"volumes"),") inside their container. Binding relative paths is always allowed\nand will be resolved relative to the allocation's directory.")),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#client-configuration","aria-label":"client configuration permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"client-configuration","aria-hidden":""})),"Client Configuration"),Object(r.b)("div",{className:"alert alert-warning g-type-body",role:"alert"},Object(r.b)("p",{parentName:"div"},"Note: client configuration options will soon be deprecated. Please use ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#plugin-options"}),"plugin options")," instead. See the ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/configuration/plugin"}),"plugin stanza")," documentation for more information.")),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"rkt")," driver has the following ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/configuration/client#options"}),"client configuration\noptions"),":"),Object(r.b)("ul",null,Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"rkt-volumes-enabled",className:"__target-lic","aria-hidden":""})),Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#rkt-volumes-enabled","aria-label":"rkt volumes enabled permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"rkt.volumes.enabled"))," - Defaults to ",Object(r.b)("inlineCode",{parentName:"li"},"true"),". Allows tasks to bind host paths\n(",Object(r.b)("inlineCode",{parentName:"li"},"volumes"),") inside their container. Binding relative paths is always allowed\nand will be resolved relative to the allocation's directory.")),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#client-attributes","aria-label":"client attributes permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"client-attributes","aria-hidden":""})),"Client Attributes"),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"rkt")," driver will set the following client attributes:"),Object(r.b)("ul",null,Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"driver-rkt",className:"__target-lic","aria-hidden":""})),Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#driver-rkt","aria-label":"driver rkt permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"driver.rkt"))," - Set to ",Object(r.b)("inlineCode",{parentName:"li"},"1")," if rkt is found on the host node. Nomad determines\nthis by executing ",Object(r.b)("inlineCode",{parentName:"li"},"rkt version")," on the host and parsing the output"),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"driver-rkt-version",className:"__target-lic","aria-hidden":""})),Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#driver-rkt-version","aria-label":"driver rkt version permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"driver.rkt.version"))," - Version of ",Object(r.b)("inlineCode",{parentName:"li"},"rkt")," e.g.: ",Object(r.b)("inlineCode",{parentName:"li"},"1.27.0"),". Note that the minimum required\nversion is ",Object(r.b)("inlineCode",{parentName:"li"},"1.27.0")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"driver-rkt-appc-version",className:"__target-lic","aria-hidden":""})),Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"#driver-rkt-appc-version","aria-label":"driver rkt appc version permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"driver.rkt.appc.version"))," - Version of ",Object(r.b)("inlineCode",{parentName:"li"},"appc")," that ",Object(r.b)("inlineCode",{parentName:"li"},"rkt")," is using e.g.: ",Object(r.b)("inlineCode",{parentName:"li"},"1.1.0"))),Object(r.b)("p",null,"Here is an example of using these properties in a job file:"),Object(r.b)("pre",{className:"language-hcl"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),"job ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"docs"')," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token comment"}),"# Only run this job where the rkt version is higher than 0.8."),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"constraint")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"attribute")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"',Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token interpolation"}),Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"$"),Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"{"),"driver",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"."),"rkt",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"."),"version",Object(r.b)("span",Object(n.a)({parentName:"span"},{className:"token punctuation"}),"}")),'"'),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"operator"),"  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'">"'),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"value"),"     ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"1.2"'),"\n  ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#resource-isolation","aria-label":"resource isolation permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"resource-isolation","aria-hidden":""})),"Resource Isolation"),Object(r.b)("p",null,"This driver supports CPU and memory isolation by delegating to ",Object(r.b)("inlineCode",{parentName:"p"},"rkt"),". Network\nisolation is not supported as of now."))}l.isMDXComponent=!0}},[["8+ZL",0,1,2,4,3,5,6]]]);