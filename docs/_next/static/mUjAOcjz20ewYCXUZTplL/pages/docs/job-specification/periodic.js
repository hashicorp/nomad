(window.webpackJsonp=window.webpackJsonp||[]).push([[244],{KIhA:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/job-specification/periodic",function(){return t("Onjw")}])},Onjw:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return d}));var n,i=t("wx14"),c=t("Ff2n"),b=t("q1tI"),o=t.n(b),r=t("7ljp"),p=t("j1un"),s=(o.a.createElement,n="Placement",function(e){return console.warn("Component "+n+" was not imported, exported, or provided by MDXProvider as global scope"),Object(r.b)("div",e)}),l={},m=Object(p.a)({layout:"docs",page_title:"periodic Stanza - Job Specification",sidebar_title:"periodic",description:'The "periodic" stanza allows a job to run at fixed times, dates, or intervals.\nThe easiest way to think about the periodic scheduler is "Nomad cron" or\n"distributed cron".',__resourcePath:"docs/job-specification/periodic.mdx",__scans:{}});function d(e){var a=e.components,t=Object(c.a)(e,["components"]);return Object(r.b)(m,Object(i.a)({},l,t,{components:a,mdxType:"MDXLayout"}),Object(r.b)("h1",{className:"g-type-display-2"},Object(r.b)("a",Object(i.a)({parentName:"h1"},{className:"__permalink-h",href:"#periodic-stanza","aria-label":"periodic stanza permalink"}),"\xbb"),Object(r.b)("a",Object(i.a)({parentName:"h1"},{className:"__target-h",id:"periodic-stanza","aria-hidden":""})),Object(r.b)("inlineCode",{parentName:"h1"},"periodic")," Stanza"),Object(r.b)(s,{groups:["job","periodic"],mdxType:"Placement"}),Object(r.b)("p",null,"The ",Object(r.b)("inlineCode",{parentName:"p"},"periodic"),' stanza allows a job to run at fixed times, dates, or intervals.\nThe easiest way to think about the periodic scheduler is "Nomad cron" or\n"distributed cron".'),Object(r.b)("pre",{className:"language-hcl"},Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-hcl"}),"job ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token string"}),'"docs"')," ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token keyword"}),"periodic")," ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token property"}),"cron"),"             ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token string"}),'"*/15 * * * * *"'),"\n    ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token property"}),"prohibit_overlap")," ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token boolean"}),"true"),"\n  ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(r.b)("p",null,"The periodic expression by default evaluates in the ",Object(r.b)("strong",{parentName:"p"},"UTC timezone")," to ensure\nconsistent evaluation when Nomad spans multiple time zones."),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(i.a)({parentName:"h2"},{className:"__permalink-h",href:"#periodic-requirements","aria-label":"periodic requirements permalink"}),"\xbb"),Object(r.b)("a",Object(i.a)({parentName:"h2"},{className:"__target-h",id:"periodic-requirements","aria-hidden":""})),Object(r.b)("inlineCode",{parentName:"h2"},"periodic")," Requirements"),Object(r.b)("ul",null,Object(r.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),"The job's ",Object(r.b)("a",Object(i.a)({parentName:"li"},{href:"/docs/job-specification/job#type",title:"Batch scheduler type"}),"scheduler type")," must be ",Object(r.b)("inlineCode",{parentName:"li"},"batch"),"."),Object(r.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),"A job can not be updated to be periodically. Thus, to transition an existing job to be periodic, you must first run ",Object(r.b)("inlineCode",{parentName:"li"},"nomad stop -purge \xabjob name\xbb"),". This is expected behavior and is to ensure that this change has been intentionally made by an operator.")),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(i.a)({parentName:"h2"},{className:"__permalink-h",href:"#periodic-parameters","aria-label":"periodic parameters permalink"}),"\xbb"),Object(r.b)("a",Object(i.a)({parentName:"h2"},{className:"__target-h",id:"periodic-parameters","aria-hidden":""})),Object(r.b)("inlineCode",{parentName:"h2"},"periodic")," Parameters"),Object(r.b)("ul",null,Object(r.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(i.a)({parentName:"li"},{id:"cron",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(i.a)({parentName:"p"},{href:"#cron","aria-label":"cron permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"cron"))," ",Object(r.b)("inlineCode",{parentName:"p"},"(string: <required>)")," - Specifies a cron expression configuring the\ninterval to launch the job. In addition to ",Object(r.b)("a",Object(i.a)({parentName:"p"},{href:"https://github.com/hashicorp/cronexpr#implementation",title:"List of cron expressions"}),"cron-specific formats"),", this\noption also includes predefined expressions such as ",Object(r.b)("inlineCode",{parentName:"p"},"@daily")," or ",Object(r.b)("inlineCode",{parentName:"p"},"@weekly"),".")),Object(r.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(i.a)({parentName:"li"},{id:"prohibit_overlap",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(i.a)({parentName:"p"},{href:"#prohibit_overlap","aria-label":"prohibit_overlap permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"prohibit_overlap"))," ",Object(r.b)("inlineCode",{parentName:"p"},"(bool: false)")," - Specifies if this job should wait until\nprevious instances of this job have completed. This only applies to this job;\nit does not prevent other periodic jobs from running at the same time.")),Object(r.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(i.a)({parentName:"li"},{id:"time_zone",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(i.a)({parentName:"p"},{href:"#time_zone","aria-label":"time_zone permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"time_zone"))," ",Object(r.b)("inlineCode",{parentName:"p"},'(string: "UTC")')," - Specifies the time zone to evaluate the next\nlaunch interval against. ",Object(r.b)("a",Object(i.a)({parentName:"p"},{href:"#daylight-saving-time"}),"Daylight Saving Time")," affects scheduling, so\nplease ensure the ",Object(r.b)("a",Object(i.a)({parentName:"p"},{href:"#daylight-saving-time"}),"behavior below")," meets your needs. The time zone must\nbe parsable by Golang's\n",Object(r.b)("a",Object(i.a)({parentName:"p"},{href:"https://golang.org/pkg/time/#LoadLocation"}),"LoadLocation"),"."))),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(i.a)({parentName:"h2"},{className:"__permalink-h",href:"#periodic-examples","aria-label":"periodic examples permalink"}),"\xbb"),Object(r.b)("a",Object(i.a)({parentName:"h2"},{className:"__target-h",id:"periodic-examples","aria-hidden":""})),Object(r.b)("inlineCode",{parentName:"h2"},"periodic")," Examples"),Object(r.b)("p",null,"The following examples only show the ",Object(r.b)("inlineCode",{parentName:"p"},"periodic")," stanzas. Remember that the\n",Object(r.b)("inlineCode",{parentName:"p"},"periodic")," stanza is only valid in the placements listed above."),Object(r.b)("h3",{className:"g-type-display-4"},Object(r.b)("a",Object(i.a)({parentName:"h3"},{className:"__permalink-h",href:"#run-daily","aria-label":"run daily permalink"}),"\xbb"),Object(r.b)("a",Object(i.a)({parentName:"h3"},{className:"__target-h",id:"run-daily","aria-hidden":""})),"Run Daily"),Object(r.b)("p",null,"This example shows running a periodic job daily:"),Object(r.b)("pre",{className:"language-hcl"},Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-hcl"}),Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token keyword"}),"periodic")," ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token property"}),"cron")," ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token string"}),'"@daily"'),"\n",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(r.b)("h3",{className:"g-type-display-4"},Object(r.b)("a",Object(i.a)({parentName:"h3"},{className:"__permalink-h",href:"#set-time-zone","aria-label":"set time zone permalink"}),"\xbb"),Object(r.b)("a",Object(i.a)({parentName:"h3"},{className:"__target-h",id:"set-time-zone","aria-hidden":""})),"Set Time Zone"),Object(r.b)("p",null,"This example shows setting a time zone for the periodic job to evaluate in:"),Object(r.b)("pre",{className:"language-hcl"},Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-hcl"}),Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token keyword"}),"periodic")," ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token property"}),"cron"),"      ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token string"}),'"*/15 * * * * *"'),"\n  ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token property"}),"time_zone")," ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token string"}),'"America/New_York"'),"\n",Object(r.b)("span",Object(i.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(i.a)({parentName:"h2"},{className:"__permalink-h",href:"#daylight-saving-time","aria-label":"daylight saving time permalink"}),"\xbb"),Object(r.b)("a",Object(i.a)({parentName:"h2"},{className:"__target-h",id:"daylight-saving-time","aria-hidden":""})),"Daylight Saving Time"),Object(r.b)("p",null,"Though Nomad supports configuring ",Object(r.b)("inlineCode",{parentName:"p"},"time_zone"),", we strongly recommend that periodic\njobs are specified with respect to UTC ",Object(r.b)("inlineCode",{parentName:"p"},"time_zone"),". Only customize ",Object(r.b)("inlineCode",{parentName:"p"},"time_zone"),"\nwhen the following daylight saving time behavior is ",Object(r.b)("em",{parentName:"p"},"desired:")),Object(r.b)("ul",null,Object(r.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("p",{parentName:"li"},"When leaping forward, periodic jobs scheduled for the skipped hour (eg 2:30am\nin ",Object(r.b)("inlineCode",{parentName:"p"},"America/New_York"),") will be ",Object(r.b)("em",{parentName:"p"},"skipped")," for that day (eg March 10th).")),Object(r.b)("li",Object(i.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("p",{parentName:"li"},"When falling back, periodic jobs scheduled for the duplicated hour (eg 1:30am\nin ",Object(r.b)("inlineCode",{parentName:"p"},"America/New_York"),") will be ",Object(r.b)("em",{parentName:"p"},"run twice")," for that day (eg November 3rd)."))))}d.isMDXComponent=!0}},[["KIhA",0,1,2,4,3,5,6]]]);