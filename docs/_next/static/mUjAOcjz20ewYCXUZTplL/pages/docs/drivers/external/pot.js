(window.webpackJsonp=window.webpackJsonp||[]).push([[188],{BxUl:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return l}));var n=t("wx14"),c=t("Ff2n"),b=t("q1tI"),o=t.n(b),r=t("7ljp"),p=t("j1un"),s=(o.a.createElement,{}),i=Object(p.a)({layout:"docs",page_title:"Drivers: pot",sidebar_title:"Pot",description:"The Pot task driver is used to run pot (https://github.com/pizzamig/pot) containers using FreeBSD jails.",__resourcePath:"docs/drivers/external/pot.mdx",__scans:{}});function l(e){var a=e.components,t=Object(c.a)(e,["components"]);return Object(r.b)(i,Object(n.a)({},s,t,{components:a,mdxType:"MDXLayout"}),Object(r.b)("h1",{className:"g-type-display-2"},Object(r.b)("a",Object(n.a)({parentName:"h1"},{className:"__permalink-h",href:"#pot-task-driver","aria-label":"pot task driver permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h1"},{className:"__target-h",id:"pot-task-driver","aria-hidden":""})),"Pot Task Driver"),Object(r.b)("p",null,"Name: ",Object(r.b)("inlineCode",{parentName:"p"},"pot")),Object(r.b)("p",null,"The Pot task driver provides an interface for using ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/pizzamig/pot"}),"pot")," for dynamically running applications inside a FreeBSD Jail.\nYou can download the external nomad-pot-driver ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/trivago/nomad-pot-driver"}),"here"),"."),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#task-configuration","aria-label":"task configuration permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"task-configuration","aria-hidden":""})),"Task Configuration"),Object(r.b)("pre",{className:"language-hcl"},Object(r.b)("code",Object(n.a)({parentName:"pre"},{className:"language-hcl"}),"task ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"nginx-pot"')," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"driver")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"pot"'),"\n\n    ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token keyword"}),"config")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"image")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"https://pot-registry.zapto.org/registry/"'),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"pot")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"FBSD120-nginx"'),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"tag")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"1.0"'),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"command")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"nginx"'),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"args")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n        ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),"\"-g 'daemon off;'\""),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"network_mode")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"public-bridge"'),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"port_map")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"{"),"\n        ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"http")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"80"'),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"copy")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n        ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/root/index.html:/usr/local/www/nginx-dist/index.html"'),",\n        ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/root/nginx.conf:/usr/local/etc/nginx/nginx.conf"'),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"mount")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n        ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/tmp/test:/root/test"'),",\n      ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"mount_read_only")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n        ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"/tmp/test2:/root/test2"'),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token property"}),"extra_hosts")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"=")," ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"["),"\n        ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"artifactory.yourdomain.com:192.168.0.1"'),",\n        ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token string"}),'"mail.yourdomain.com:192.168.0.2"'),"\n      ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"]"),"\n   ",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n",Object(r.b)("span",Object(n.a)({parentName:"code"},{className:"token punctuation"}),"}"),"\n")),Object(r.b)("p",null,"The pot task driver supports the following parameters:"),Object(r.b)("ul",null,Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"image",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#image","aria-label":"image permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"image"))," - The url for the http registry from where to get the image.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"pot",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#pot","aria-label":"pot permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"pot"))," - Name of the image in the registry.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"tag",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#tag","aria-label":"tag permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"tag"))," - Version of the image.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"command",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#command","aria-label":"command permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"command"))," - Command that is going to be executed once the jail is started.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"args",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#args","aria-label":"args permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"args"))," - (Optional) List of options for the command executed on the command argument.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"network_mode",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#network_mode","aria-label":"network_mode permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"network_mode"))," - (Optional) Defines the network mode of the pot. Default: ",Object(r.b)("strong",{parentName:"p"},'"public-bridge"')),Object(r.b)("p",{parentName:"li"},"Possible values are:"),Object(r.b)("p",{parentName:"li"},Object(r.b)("strong",{parentName:"p"},'"public-bridge"')," pot creates an internal virtual network with a NAT table where all traffic is going to be sent."),Object(r.b)("p",{parentName:"li"},Object(r.b)("strong",{parentName:"p"},'"host"')," pot bounds the jail directly to a host port.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"port_map",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#port_map","aria-label":"port_map permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"port_map"))," - (Optional) Sets the port on which the application is listening inside of the jail. If not set, the application will inherit the port configuration from the image.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"copy",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#copy","aria-label":"copy permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"copy"))," - (Optional) Copies a file from the host machine to the pot jail in the given directory.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"mount",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#mount","aria-label":"mount permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"mount"))," - (Optional) Mounts a read/write folder from the host machine to the pot jail.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"mount_read_only",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#mount_read_only","aria-label":"mount_read_only permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"mount_read_only"))," - (Optional) Mounts a read only directory inside the pot jail.")),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(r.b)("a",Object(n.a)({parentName:"li"},{id:"extra_hosts",className:"__target-lic","aria-hidden":""})),Object(r.b)("p",{parentName:"li"},Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"#extra_hosts","aria-label":"extra_hosts permalink",className:"__permalink-lic"}),Object(r.b)("inlineCode",{parentName:"a"},"extra_hosts"))," - (Optional) A list of hosts, given as host:IP, to be added to /etc/hosts"))),Object(r.b)("h2",{className:"g-type-display-3"},Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#client-requirements","aria-label":"client requirements permalink"}),"\xbb"),Object(r.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"client-requirements","aria-hidden":""})),"Client Requirements"),Object(r.b)("p",null,Object(r.b)("inlineCode",{parentName:"p"},"pot Task Driver")," requires the following:"),Object(r.b)("ul",null,Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),"64-bit FreeBSD 12.0-RELEASE host ."),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),"The FreeBSD's Nomad binary (available as a package)."),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),"The pot-task-driver binary placed in the ",Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"/docs/configuration#plugin_dir"}),"plugin_dir")," directory."),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),"Installing ",Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/pizzamig/pot"}),"pot")," and following the install ",Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://github.com/pizzamig/pot/blob/master/share/doc/pot/Installation.md"}),"guide"),"."),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),"Webserver from where to serve the images. (simple file server)"),Object(r.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),"Following lines need to be included in your rc.conf")),Object(r.b)("pre",null,Object(r.b)("code",Object(n.a)({parentName:"pre"},{}),'nomad_user="root"\nnomad_env="PATH=/usr/local/bin:/usr/local/sbin:/usr/bin:/usr/sbin:/sbin:/bin"\n')))}l.isMDXComponent=!0},iozs:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/drivers/external/pot",function(){return t("BxUl")}])}},[["iozs",0,1,2,4,3,5,6]]]);