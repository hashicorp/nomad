(window.webpackJsonp=window.webpackJsonp||[]).push([[100],{Ncrr:function(e,a,t){"use strict";t.r(a),t.d(a,"default",(function(){return p}));var n=t("wx14"),r=t("Ff2n"),i=t("q1tI"),c=t.n(i),b=t("7ljp"),l=t("j1un"),s=(c.a.createElement,{}),o=Object(l.a)({layout:"docs",page_title:"Commands: job revert",sidebar_title:"revert",description:"The revert command is used to revert to a prior version of the job.\n",__resourcePath:"docs/commands/job/revert.mdx",__scans:{}});function p(e){var{components:a}=e,t=Object(r.a)(e,["components"]);return Object(b.b)(o,Object(n.a)({},s,t,{components:a,mdxType:"MDXLayout"}),Object(b.b)("h1",{className:"g-type-display-2"},Object(b.b)("a",Object(n.a)({parentName:"h1"},{className:"__permalink-h",href:"#command-job-revert","aria-label":"command job revert permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h1"},{className:"__target-h",id:"command-job-revert","aria-hidden":""})),"Command: job revert"),Object(b.b)("p",null,"The ",Object(b.b)("inlineCode",{parentName:"p"},"job revert")," command is used to revert a job to a prior version of the\njob. The available versions to revert to can be found using ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/commands/job/history"}),Object(b.b)("inlineCode",{parentName:"a"},"job history")),"\ncommand."),Object(b.b)("p",null,"The revert command will use a Consul token with the following preference:\nfirst the ",Object(b.b)("inlineCode",{parentName:"p"},"-consul-token")," flag, then the ",Object(b.b)("inlineCode",{parentName:"p"},"$CONSUL_HTTP_TOKEN")," environment variable.\nBecause the consul token used to ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/commands/job/run"}),"run")," the targeted job version was not\npersisted, it must be provided to revert if the targeted job version includes\nConsul Connect enabled services and the Nomad servers were configured to require\n",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/configuration/consul#allow_unauthenticated"}),"consul service identity")," authentication."),Object(b.b)("p",null,"The revert command will use a Vault token with the following preference:\nfirst the ",Object(b.b)("inlineCode",{parentName:"p"},"-vault-token")," flag, then the ",Object(b.b)("inlineCode",{parentName:"p"},"$VAULT_TOKEN")," environment variable.\nBecause the vault token used to ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/commands/job/run"}),"run")," the targeted job version was not\npersisted, it must be provided to revert if the targeted job version includes\nVault policies and the Nomad servers were configured to require ",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/configuration/vault#allow_unauthenticated"}),"vault policy"),"\nauthentication."),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#usage","aria-label":"usage permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"usage","aria-hidden":""})),"Usage"),Object(b.b)("pre",{className:"language-plaintext"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-plaintext"}),"nomad job revert [options] <job> <version>\n")),Object(b.b)("p",null,"The ",Object(b.b)("inlineCode",{parentName:"p"},"job revert")," command requires two inputs, the job ID and the version of that\njob to revert to."),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#general-options","aria-label":"general options permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"general-options","aria-hidden":""})),"General Options"),Object(b.b)("ul",null,Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"address",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#address","aria-label":"address permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-address=<addr>")),": The address of the Nomad server. Overrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_ADDR"),"\nenvironment variable if set. Defaults to ",Object(b.b)("inlineCode",{parentName:"p"},"http://127.0.0.1:4646"),".")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"region",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#region","aria-label":"region permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-region=<region>")),": The region of the Nomad server to forward commands to.\nOverrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_REGION")," environment variable if set. Defaults to the\nAgent's local region.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"namespace",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#namespace","aria-label":"namespace permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-namespace=<namespace>")),": The target namespace for queries and actions bound\nto a namespace. Overrides the NOMAD_NAMESPACE environment variable if set.\nIf set to '*', job and alloc subcommands query all namespacecs authorized to\nuser. Defaults to the \"default\" namespace.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"no-color",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#no-color","aria-label":"no color permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-no-color")),": Disables colored command output. Alternatively,\n",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_CLI_NO_COLOR")," may be set.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"ca-cert",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#ca-cert","aria-label":"ca cert permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-ca-cert=<path>")),": Path to a PEM encoded CA cert file to use to verify the\nNomad server SSL certificate. Overrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_CACERT")," environment\nvariable if set.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"ca-path",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#ca-path","aria-label":"ca path permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-ca-path=<path>")),": Path to a directory of PEM encoded CA cert files to verify\nthe Nomad server SSL certificate. If both ",Object(b.b)("inlineCode",{parentName:"p"},"-ca-cert")," and ",Object(b.b)("inlineCode",{parentName:"p"},"-ca-path")," are\nspecified, ",Object(b.b)("inlineCode",{parentName:"p"},"-ca-cert")," is used. Overrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_CAPATH")," environment\nvariable if set.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"client-cert",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#client-cert","aria-label":"client cert permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-client-cert=<path>")),": Path to a PEM encoded client certificate for TLS\nauthentication to the Nomad server. Must also specify ",Object(b.b)("inlineCode",{parentName:"p"},"-client-key"),". Overrides\nthe ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_CLIENT_CERT")," environment variable if set.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"client-key",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#client-key","aria-label":"client key permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-client-key=<path>")),": Path to an unencrypted PEM encoded private key matching\nthe client certificate from ",Object(b.b)("inlineCode",{parentName:"p"},"-client-cert"),". Overrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_CLIENT_KEY"),"\nenvironment variable if set.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"tls-server-name",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#tls-server-name","aria-label":"tls server name permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-tls-server-name=<value>")),": The server name to use as the SNI host when connecting\nvia TLS. Overrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_TLS_SERVER_NAME")," environment variable if set.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"tls-skip-verify",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#tls-skip-verify","aria-label":"tls skip verify permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-tls-skip-verify")),": Do not verify TLS certificate. This is highly not\nrecommended. Verification will also be skipped if ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_SKIP_VERIFY")," is set.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"token",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#token","aria-label":"token permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-token")),": The SecretID of an ACL token to use to authenticate API requests with.\nOverrides the ",Object(b.b)("inlineCode",{parentName:"p"},"NOMAD_TOKEN")," environment variable if set."))),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#revert-options","aria-label":"revert options permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"revert-options","aria-hidden":""})),"Revert Options"),Object(b.b)("ul",null,Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"detach",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#detach","aria-label":"detach permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-detach")),": Return immediately instead of monitoring. A new evaluation ID\nwill be output, which can be used to examine the evaluation using the\n",Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"/docs/commands/eval-status"}),"eval status")," command.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"consul-token",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#consul-token","aria-label":"consul token permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-consul-token")),": If set, the passed Consul token is sent along with the revert\nrequest to the Nomad servers. This overrides the token found in the\n\\$CONSUL_HTTP_TOKEN environment variable.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"vault-token",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#vault-token","aria-label":"vault token permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-vault-token")),": If set, the passed Vault token is sent along with the revert\nrequest to the Nomad servers. This overrides the token found in the\n\\$VAULT_TOKEN environment variable.")),Object(b.b)("li",Object(n.a)({parentName:"ul"},{className:"g-type-long-body"}),Object(b.b)("a",Object(n.a)({parentName:"li"},{id:"verbose",className:"__target-lic","aria-hidden":""})),Object(b.b)("p",{parentName:"li"},Object(b.b)("a",Object(n.a)({parentName:"p"},{href:"#verbose","aria-label":"verbose permalink",className:"__permalink-lic"}),Object(b.b)("inlineCode",{parentName:"a"},"-verbose")),": Show full information."))),Object(b.b)("h2",{className:"g-type-display-3"},Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__permalink-h",href:"#examples","aria-label":"examples permalink"}),"\xbb"),Object(b.b)("a",Object(n.a)({parentName:"h2"},{className:"__target-h",id:"examples","aria-hidden":""})),"Examples"),Object(b.b)("p",null,"Revert to an older version of a job:"),Object(b.b)("pre",{className:"language-shell-session"},Object(b.b)("code",Object(n.a)({parentName:"pre"},{className:"language-shell-session"}),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token command"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token sh important"}),"$")," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token bash language-bash"}),"nomad job ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token function"}),"history")," -p example")),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token output"}),'Version     = 1\nStable      = false\nSubmit Date = 07/25/17 21:27:30 UTC\nDiff        =\n+/- Job: "example"\n+/- Task Group: "cache"\n  +/- Task: "redis"\n    +/- Config {\n      +/- image:           "redis:3.2" => "redis:4.0"\n          port_map[0][db]: "6379"\n        }\n\nVersion     = 0\nStable      = false\nSubmit Date = 07/25/17 21:27:18 UTC\n\n'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token command"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token sh important"}),"$")," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token bash language-bash"}),"nomad job revert example ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token number"}),"0"))),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token output"}),'==> Monitoring evaluation "faff5c30"\n    Evaluation triggered by job "example"\n    Evaluation within deployment: "e17c8592"\n    Allocation "4ed0ca3b" modified: node "e8a2243d", group "cache"\n    Evaluation status changed: "pending" -> "complete"\n==> Evaluation "faff5c30" finished with status "complete"\n\n'),Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token command"}),Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token sh important"}),"$")," ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token bash language-bash"}),"nomad job ",Object(b.b)("span",Object(n.a)({parentName:"span"},{className:"token function"}),"history")," -p example")),"\n",Object(b.b)("span",Object(n.a)({parentName:"code"},{className:"token output"}),'Version     = 2\nStable      = true\nSubmit Date = 07/25/17 21:27:43 UTC\nDiff        =\n+/- Job: "example"\n+/- Task Group: "cache"\n  +/- Task: "redis"\n    +/- Config {\n      +/- image:           "redis:4.0" => "redis:3.2"\n          port_map[0][db]: "6379"\n        }\n\nVersion     = 1\nStable      = false\nSubmit Date = 07/25/17 21:27:30 UTC\nDiff        =\n+/- Job: "example"\n+/- Task Group: "cache"\n  +/- Task: "redis"\n    +/- Config {\n      +/- image:           "redis:3.2" => "redis:4.0"\n          port_map[0][db]: "6379"\n        }\n\nVersion     = 0\nStable      = false\nSubmit Date = 07/25/17 21:27:18 UTC\n'))))}p.isMDXComponent=!0},ZB5t:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/commands/job/revert",function(){return t("Ncrr")}])}},[["ZB5t",0,1,2,4,3,5,6]]]);